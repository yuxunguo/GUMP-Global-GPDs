<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Evolution &mdash; GUMP GPD Analysis 0.5.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=1dd76d02"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GUMP GPD Analysis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../QuickStart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ParametersIntro.html">Parameters Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ObservablesIntro.html">Observables Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EvolutionIntro.html">Evolution Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MinimizerIntro.html">Minimizer Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DVCSIntro.html">DVCS Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DVMPIntro.html">DVMP Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">List of all modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GUMP GPD Analysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">Evolution</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for Evolution</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">NLO QCD evolution of moment space GPD. Many credits to K. Kumericki at https://github.com/kkumer/gepard.</span>

<span class="sd">Note:</span>
<span class="sd">    Functions in this module have as first argument Mellin moment</span>
<span class="sd">    n = j + 1, where j is conformal moment used everywhere else.</span>
<span class="sd">    Thus, they should always be called as f(j+1, ...).</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># from cmath import exp</span>
<span class="c1"># from scipy.special import loggamma as clngamma</span>
<span class="c1">#from this import d</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">Parameters</span> <span class="kn">import</span> <span class="n">Moment_Sum</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">psi</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">orthogonal</span><span class="p">,</span> <span class="n">loggamma</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">factorial</span><span class="p">,</span> <span class="n">log</span>
<span class="kn">from</span> <span class="nn">mpmath</span> <span class="kn">import</span> <span class="n">mp</span><span class="p">,</span> <span class="n">hyp2f1</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">vectorize</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">functools</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">***********************QCD constants***************************************</span>
<span class="sd">Refer to the constants.py at https://github.com/kkumer/gepard.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">M_jpsi</span> <span class="o">=</span> <span class="mf">3.097</span>
<span class="n">NC</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">CF</span> <span class="o">=</span> <span class="p">(</span><span class="n">NC</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">NC</span><span class="p">)</span>
<span class="n">CA</span> <span class="o">=</span> <span class="n">NC</span>
<span class="n">CG</span> <span class="o">=</span> <span class="n">CF</span> <span class="o">-</span> <span class="n">CA</span><span class="o">/</span><span class="mi">2</span>
<span class="n">TF</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">Alpha_Mz</span> <span class="o">=</span> <span class="mf">0.1181</span>
<span class="c1"># All unit in GeV for dimensional quantities.</span>
<span class="n">Mz</span> <span class="o">=</span> <span class="mf">91.1876</span>
<span class="c1"># One loop accuracy for running strong coupling constant. </span>
<span class="n">nloop_alphaS</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># Initial scale of distribution functions at 2 GeV.</span>
<span class="n">Init_Scale_Q</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Transform the original flavor basis to the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g)</span>
<span class="c1"># The same basis for PDF evolution are used, check references.</span>

<span class="n">flav_trans</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">inv_flav_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">flav_trans</span><span class="p">)</span>

<span class="n">f_rho_u</span> <span class="o">=</span> <span class="mf">0.209</span> <span class="c1"># Change to 0.222</span>
<span class="n">f_rho_d</span> <span class="o">=</span> <span class="mf">0.209</span> <span class="c1"># Change to 0.210</span>
<span class="n">f_rho_g</span> <span class="o">=</span> <span class="mf">0.209</span> <span class="c1"># Change to 0.216</span>
<span class="n">f_phi</span> <span class="o">=</span> <span class="mf">0.221</span> <span class="c1"># Change to 0.233</span>
<span class="n">f_jpsi</span> <span class="o">=</span> <span class="mf">0.406</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">TFF_rho_trans = np.array([f_rho_u * 2 / 3 / np.sqrt(2), f_rho_u * 4 / 3 / np.sqrt(2), f_rho_d * 1 / 3 / np.sqrt(2), f_rho_d * 2 / 3 / np.sqrt(2), f_rho_g * 3 / 4 / np.sqrt(2)])#np.array([f_rho_u * 2 / 3 / np.sqrt(2), f_rho_u * 4 / 3 / np.sqrt(2), f_rho_d / 3 / np.sqrt(2), f_rho_d * 2 / 3 / np.sqrt(2), f_rho_g * 3 / 4 / np.sqrt(2)])</span>
<span class="sd">TFF_phi_trans = np.array([0, 0, 0, 0, -1/3]) # strange contribution should be included but doesn&#39;t exist in current 2 quark framework</span>
<span class="sd">TFF_jpsi_trans = np.array([0, 0, 0, 0, 2/3])</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">***********************pQCD running coupling constant***********************</span>
<span class="sd">Here rundec is used instead.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">B00</span> <span class="o">=</span> <span class="mf">11.</span><span class="o">/</span><span class="mf">3.</span> <span class="o">*</span> <span class="n">CA</span>
<span class="n">B01</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.</span><span class="o">/</span><span class="mf">3.</span> <span class="o">*</span> <span class="n">TF</span>
<span class="n">B10</span> <span class="o">=</span> <span class="mf">34.</span><span class="o">/</span><span class="mf">3.</span> <span class="o">*</span> <span class="n">CA</span><span class="o">**</span><span class="mi">2</span>
<span class="n">B11</span> <span class="o">=</span> <span class="o">-</span><span class="mf">20.</span><span class="o">/</span><span class="mf">3.</span> <span class="o">*</span> <span class="n">CA</span><span class="o">*</span><span class="n">TF</span> <span class="o">-</span> <span class="mf">4.</span> <span class="o">*</span> <span class="n">CF</span><span class="o">*</span><span class="n">TF</span>

<div class="viewcode-block" id="beta0">
<a class="viewcode-back" href="../Evolution.html#Evolution.beta0">[docs]</a>
<span class="nd">@njit</span><span class="p">([</span><span class="s2">&quot;float64(int32)&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; LO beta function of pQCD, will be used for LO GPD evolution. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span> <span class="n">B00</span> <span class="o">-</span> <span class="n">B01</span> <span class="o">*</span> <span class="n">nf</span></div>


<div class="viewcode-block" id="beta1">
<a class="viewcode-back" href="../Evolution.html#Evolution.beta1">[docs]</a>
<span class="nd">@njit</span><span class="p">([</span><span class="s2">&quot;float64(int32)&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">beta1</span><span class="p">(</span><span class="n">nf</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; NLO beta function of pQCD &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span> <span class="n">B10</span> <span class="o">-</span> <span class="n">B11</span> <span class="o">*</span> <span class="n">nf</span></div>


<span class="nd">@njit</span><span class="p">([</span><span class="s2">&quot;float64[:](float64[:], int32)&quot;</span><span class="p">,</span> <span class="s2">&quot;float64(float64, int32)&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">_fbeta1</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">beta1</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span>

<div class="viewcode-block" id="AlphaS0">
<a class="viewcode-back" href="../Evolution.html#Evolution.AlphaS0">[docs]</a>
<span class="nd">@njit</span><span class="p">([</span><span class="s2">&quot;float64[:](int32, float64[:])&quot;</span><span class="p">,</span> <span class="s2">&quot;float64(int32, float64)&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">AlphaS0</span><span class="p">(</span><span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Alpha_Mz</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Alpha_Mz</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Q</span><span class="o">/</span><span class="n">Mz</span><span class="p">))</span></div>


<div class="viewcode-block" id="AlphaS1">
<a class="viewcode-back" href="../Evolution.html#Evolution.AlphaS1">[docs]</a>
<span class="nd">@njit</span><span class="p">([</span><span class="s2">&quot;float64[:](int32, float64[:])&quot;</span><span class="p">,</span> <span class="s2">&quot;float64(int32, float64)&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">AlphaS1</span><span class="p">(</span><span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="n">NASTPS</span> <span class="o">=</span> <span class="mi">20</span>
    
    <span class="c1"># a below is as defined in 1/4pi expansion</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span> <span class="o">*</span> <span class="n">Alpha_Mz</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">lrrat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Q</span><span class="o">/</span><span class="n">Mz</span><span class="p">)</span>
    <span class="n">dlr</span> <span class="o">=</span> <span class="n">lrrat</span> <span class="o">/</span> <span class="n">NASTPS</span>

   
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NASTPS</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">xk0</span> <span class="o">=</span> <span class="n">dlr</span> <span class="o">*</span> <span class="n">_fbeta1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">xk1</span> <span class="o">=</span> <span class="n">dlr</span> <span class="o">*</span> <span class="n">_fbeta1</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">xk0</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">xk2</span> <span class="o">=</span> <span class="n">dlr</span> <span class="o">*</span> <span class="n">_fbeta1</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">xk1</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">xk3</span> <span class="o">=</span> <span class="n">dlr</span> <span class="o">*</span> <span class="n">_fbeta1</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">xk2</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="p">(</span><span class="n">xk0</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">xk1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">xk2</span> <span class="o">+</span> <span class="n">xk3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span>


    <span class="c1"># Return to .../(2pi)  expansion</span>
    <span class="n">a</span> <span class="o">*=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">return</span> <span class="n">a</span></div>


<div class="viewcode-block" id="AlphaS">
<a class="viewcode-back" href="../Evolution.html#Evolution.AlphaS">[docs]</a>
<span class="nd">@njit</span><span class="p">([</span><span class="s2">&quot;float64[:](int32, int32, float64[:])&quot;</span><span class="p">,</span> <span class="s2">&quot;float64(int32, int32, float64)&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">AlphaS</span><span class="p">(</span><span class="n">nloop</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">nloop</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">AlphaS0</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nloop</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">AlphaS1</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only LO and NLO implemented!&#39;</span><span class="p">)</span></div>



<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">***********************Anomalous dimensions of GPD in the moment space*****</span>
<span class="sd">Refer to the adim.py at https://github.com/kkumer/gepard.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Fixed quad function that allow more general function. The func here take input of shape (N,) and output (N,......) which doesn&#39;t have to be (N,)</span>
<div class="viewcode-block" id="fixed_quadvec">
<a class="viewcode-back" href="../Evolution.html#Evolution.fixed_quadvec">[docs]</a>
<span class="k">def</span> <span class="nf">fixed_quadvec</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">()):</span>
    <span class="n">rootsNLO</span><span class="p">,</span> <span class="n">weightsNLO</span> <span class="o">=</span> <span class="n">orthogonal</span><span class="o">.</span><span class="n">p_roots</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">rootsNLO</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">a</span>
    <span class="n">yfunc</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,j...-&gt;...&#39;</span><span class="p">,</span><span class="n">weightsNLO</span><span class="p">,</span><span class="n">yfunc</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="pochhammer">
<a class="viewcode-back" href="../Evolution.html#Evolution.pochhammer">[docs]</a>
<span class="k">def</span> <span class="nf">pochhammer</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pochhammer symbol.</span>

<span class="sd">    Args:</span>
<span class="sd">        z: complex argument</span>
<span class="sd">        m: integer index</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex: pochhammer(z,m)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">z</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span></div>


<span class="n">poch</span> <span class="o">=</span> <span class="n">pochhammer</span>  <span class="c1"># just an abbreviation</span>

<div class="viewcode-block" id="dpsi_one">
<a class="viewcode-back" href="../Evolution.html#Evolution.dpsi_one">[docs]</a>
<span class="k">def</span> <span class="nf">dpsi_one</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">complex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Polygamma - m&#39;th derivative of Euler gamma at z.&quot;&quot;&quot;</span>
    <span class="c1"># Algorithm from Vogt, cf. julia&#39;s implementation</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="mi">0</span><span class="n">j</span>

    <span class="k">if</span> <span class="n">z</span><span class="o">.</span><span class="n">imag</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">subm</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">sub</span> <span class="o">+=</span> <span class="n">subm</span>
            <span class="n">z</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">subm</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="n">a1</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">2.</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">6.</span>
    <span class="n">a4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">30.</span>
    <span class="n">a5</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">42.</span>
    <span class="n">a6</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">30.</span>
    <span class="n">a7</span> <span class="o">=</span> <span class="mf">5.</span><span class="o">/</span><span class="mf">66.</span>

    <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="p">(</span><span class="n">k2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">k2</span>
            <span class="n">a3</span> <span class="o">=</span> <span class="n">a3</span> <span class="o">*</span> <span class="p">(</span><span class="n">k2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">a4</span> <span class="o">=</span> <span class="n">a4</span> <span class="o">*</span> <span class="p">(</span><span class="n">k2</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">a5</span> <span class="o">=</span> <span class="n">a5</span> <span class="o">*</span> <span class="p">(</span><span class="n">k2</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
            <span class="n">a6</span> <span class="o">=</span> <span class="n">a6</span> <span class="o">*</span> <span class="p">(</span><span class="n">k2</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span>
            <span class="n">a7</span> <span class="o">=</span> <span class="n">a7</span> <span class="o">*</span> <span class="p">(</span><span class="n">k2</span><span class="o">+</span><span class="mi">9</span><span class="p">)</span>

    <span class="n">rz</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">z</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">rz</span> <span class="o">*</span> <span class="n">rz</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">sub</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rz</span><span class="o">**</span><span class="n">m</span> <span class="o">*</span>
           <span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">rz</span> <span class="o">*</span> <span class="p">(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">rz</span> <span class="o">*</span> <span class="p">(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">a4</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="p">(</span><span class="n">a5</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="p">(</span><span class="n">a6</span> <span class="o">+</span> <span class="n">a7</span> <span class="o">*</span> <span class="n">dz</span><span class="p">)))))))</span>
    <span class="k">return</span> <span class="n">res</span></div>


<span class="n">dpsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">dpsi_one</span><span class="p">)</span>

<div class="viewcode-block" id="S1">
<a class="viewcode-back" href="../Evolution.html#Evolution.S1">[docs]</a>
<span class="k">def</span> <span class="nf">S1</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Harmonic sum S_1.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">euler_gamma</span> <span class="o">+</span> <span class="n">psi</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="S2">
<a class="viewcode-back" href="../Evolution.html#Evolution.S2">[docs]</a>
<span class="k">def</span> <span class="nf">S2</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Harmonic sum S_2.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">dpsi</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="S3">
<a class="viewcode-back" href="../Evolution.html#Evolution.S3">[docs]</a>
<span class="k">def</span> <span class="nf">S3</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Harmonic sum S_3.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">dpsi</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span></div>


<div class="viewcode-block" id="S4">
<a class="viewcode-back" href="../Evolution.html#Evolution.S4">[docs]</a>
<span class="k">def</span> <span class="nf">S4</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Harmonic sum S_4.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">zeta</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">dpsi</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span></div>


<div class="viewcode-block" id="S2_prime">
<a class="viewcode-back" href="../Evolution.html#Evolution.S2_prime">[docs]</a>
<span class="k">def</span> <span class="nf">S2_prime</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Curci et al Eq. (5.25).&quot;&quot;&quot;</span>
    <span class="c1"># note this is related to delS2</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">prty</span><span class="p">)</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">prty</span><span class="p">)</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span></div>


<div class="viewcode-block" id="S3_prime">
<a class="viewcode-back" href="../Evolution.html#Evolution.S3_prime">[docs]</a>
<span class="k">def</span> <span class="nf">S3_prime</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Curci et al Eq. (5.25).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">prty</span><span class="p">)</span><span class="o">*</span><span class="n">S3</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">prty</span><span class="p">)</span><span class="o">*</span><span class="n">S3</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span></div>


<div class="viewcode-block" id="delS2">
<a class="viewcode-back" href="../Evolution.html#Evolution.delS2">[docs]</a>
<span class="k">def</span> <span class="nf">delS2</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return Harmonic sum S_2 difference.</span>

<span class="sd">    Args:</span>
<span class="sd">        z: complex argument</span>

<span class="sd">    Returns:</span>
<span class="sd">        delS2((z+1)/2) From Eq. (4.13) of 1310.5394.</span>
<span class="sd">        Note halving of the argument.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">S2</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">S2</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="deldelS2">
<a class="viewcode-back" href="../Evolution.html#Evolution.deldelS2">[docs]</a>
<span class="k">def</span> <span class="nf">deldelS2</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return diference of harmonic sum S_2 differences.</span>

<span class="sd">    Args:</span>
<span class="sd">        j: complex argument</span>
<span class="sd">        k: integer index</span>

<span class="sd">    Returns:</span>
<span class="sd">        Equal to delS2((j+1)/2, (k+1)/2) From Eq. (4.38) of 1310.5394.</span>
<span class="sd">        Note halving of the argument.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">delS2</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="n">delS2</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span></div>


<div class="viewcode-block" id="Sm1">
<a class="viewcode-back" href="../Evolution.html#Evolution.Sm1">[docs]</a>
<span class="k">def</span> <span class="nf">Sm1</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Aux fun. FIXME: not tested.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">k</span> <span class="o">%</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">psi</span><span class="p">((</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">psi</span><span class="p">((</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span></div>


<div class="viewcode-block" id="MellinF2">
<a class="viewcode-back" href="../Evolution.html#Evolution.MellinF2">[docs]</a>
<span class="k">def</span> <span class="nf">MellinF2</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return Mellin transform  i.e. x^(N-1) moment of Li2(x)/(1+x).</span>

<span class="sd">    Args:</span>
<span class="sd">        n: complex argument</span>

<span class="sd">    Returns:</span>
<span class="sd">        According to Eq. (33) in Bluemlein and Kurth, hep-ph/9708388</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">abk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.9999964239</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4998741238</span><span class="p">,</span>
                    <span class="mf">0.3317990258</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2407338084</span><span class="p">,</span> <span class="mf">0.1676540711</span><span class="p">,</span>
                   <span class="o">-</span><span class="mf">0.0953293897</span><span class="p">,</span> <span class="mf">0.0360884937</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0064535442</span><span class="p">])</span>
    <span class="n">psitmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">mf2</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
        <span class="n">psitmp</span> <span class="o">=</span> <span class="n">psitmp</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">mf2</span> <span class="o">+=</span> <span class="p">(</span><span class="n">abk</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span>
                <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span>
                 <span class="p">(</span><span class="n">psitmp</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">euler_gamma</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                 <span class="p">(</span><span class="n">psitmp</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">euler_gamma</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">mf2</span></div>


<div class="viewcode-block" id="SB3">
<a class="viewcode-back" href="../Evolution.html#Evolution.SB3">[docs]</a>
<span class="k">def</span> <span class="nf">SB3</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Eq. (4.44e) of arXiv:1310.5394.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="mf">0.125</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">S3</span><span class="p">(</span>
             <span class="o">-</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">S3</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">j</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.8224670334241131</span> <span class="o">*</span> <span class="p">(</span>
                 <span class="o">-</span><span class="n">S1</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">))</span> <span class="o">+</span> <span class="n">S1</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">j</span><span class="p">))</span> <span class="o">-</span> <span class="n">MellinF2</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">))</span></div>


<div class="viewcode-block" id="S2_tilde">
<a class="viewcode-back" href="../Evolution.html#Evolution.S2_tilde">[docs]</a>
<span class="k">def</span> <span class="nf">S2_tilde</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Eq. (30) of  Bluemlein and Kurth, hep-ph/9708388.&quot;&quot;&quot;</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">psi</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">psi</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">prty</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span> <span class="o">+</span> <span class="n">MellinF2</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>


<div class="viewcode-block" id="lsum">
<a class="viewcode-back" href="../Evolution.html#Evolution.lsum">[docs]</a>
<span class="k">def</span> <span class="nf">lsum</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">n</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span><span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">l</span> <span class="o">*</span> <span class="n">deldelS2</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span></div>


<div class="viewcode-block" id="lsumrev">
<a class="viewcode-back" href="../Evolution.html#Evolution.lsumrev">[docs]</a>
<span class="k">def</span> <span class="nf">lsumrev</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">n</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span><span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    
    <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">deldelS2</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span></div>


<div class="viewcode-block" id="non_singlet_LO">
<a class="viewcode-back" href="../Evolution.html#Evolution.non_singlet_LO">[docs]</a>
<span class="k">def</span> <span class="nf">non_singlet_LO</span><span class="p">(</span><span class="n">n</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non-singlet LO anomalous dimension.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (complex): which moment (= Mellin moment for integer n)</span>
<span class="sd">        nf (int): number of active quark flavors</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et)</span>
<span class="sd">        prty (int): 1 for NS^{+}, -1 for NS^{-}, irrelevant at LO</span>

<span class="sd">    Returns:</span>
<span class="sd">        Non-singlet LO anomalous dimension.</span>
<span class="sd">        </span>
<span class="sd">    It&#39;s an algebric equation, any shape of n should be fine.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">CF</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="o">-</span><span class="mf">2.0</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">))</span><span class="o">+</span><span class="mf">4.0</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>


<div class="viewcode-block" id="singlet_LO">
<a class="viewcode-back" href="../Evolution.html#Evolution.singlet_LO">[docs]</a>
<span class="k">def</span> <span class="nf">singlet_LO</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Singlet LO anomalous dimensions.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (complex): which moment (= Mellin moment for integer n)</span>
<span class="sd">        nf (int): number of active quark flavors</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et)</span>
<span class="sd">        prty (int): C parity, irrelevant at LO</span>

<span class="sd">    Returns:</span>
<span class="sd">        2x2 complex matrix ((QQ, QG),</span>
<span class="sd">                            (GQ, GG))</span>

<span class="sd">    This will work as long as n, nf, and p can be broadcasted together.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    if(p == 1):</span>
<span class="sd">        qq0 = CF*(-3.0-2.0/(n*(1.0+n))+4.0*S1(n))</span>
<span class="sd">        qg0 = (-4.0*nf*TF*(2.0+n+n*n))/(n*(1.0+n)*(2.0+n))</span>
<span class="sd">        gq0 = (-2.0*CF*(2.0+n+n*n))/((-1.0+n)*n*(1.0+n))</span>
<span class="sd">        gg0 = -4.0*CA*(1/((-1.0+n)*n)+1/((1.0+n)*(2.0+n))-S1(n)) -11*CA/3. + 4*nf*TF/3.</span>

<span class="sd">        return np.array([[qq0, qg0],</span>
<span class="sd">                        [gq0, gg0]])</span>
<span class="sd">    </span>
<span class="sd">    if(p == -1):</span>
<span class="sd">        qq0 = CF*(-3.0-2.0/(n*(1.0+n))+4.0*S1(n))</span>
<span class="sd">        qg0 = (-4.0*nf*TF*(-1.0+n))/(n*(1.0+n))</span>
<span class="sd">        gq0 = (-2.0*CF*(2.0+n))/(n*(1.0+n))</span>
<span class="sd">        gg0 = -4.0*CA*(2/(n*(1.0+n))-S1(n)) -11*CA/3. + 4*nf*TF/3.</span>

<span class="sd">        return np.array([[qq0, qg0],</span>
<span class="sd">                        [gq0, gg0]])</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.00001</span> <span class="o">*</span> <span class="p">(</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Here, I am making the assumption that a is either 1 or -1</span>
    <span class="n">qq0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span>  <span class="n">CF</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="o">-</span><span class="mf">2.0</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">))</span><span class="o">+</span><span class="mf">4.0</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span>           <span class="n">CF</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="o">-</span><span class="mf">2.0</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">))</span><span class="o">+</span><span class="mf">4.0</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
    <span class="n">qg0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span>  <span class="p">(</span><span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="n">TF</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">+</span><span class="n">n</span><span class="p">)),</span>  <span class="p">(</span><span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="n">TF</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">))</span> <span class="p">)</span>
    <span class="n">gq0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span>  <span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">CF</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">)),</span>    <span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">CF</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">+</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">)))</span>
    <span class="n">gg0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">CA</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">+</span><span class="n">n</span><span class="p">))</span><span class="o">-</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">-</span><span class="mi">11</span><span class="o">*</span><span class="n">CA</span><span class="o">/</span><span class="mf">3.</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="n">TF</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span> \
        <span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">CA</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">n</span><span class="p">))</span><span class="o">-</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">-</span><span class="mi">11</span><span class="o">*</span><span class="n">CA</span><span class="o">/</span><span class="mf">3.</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="n">TF</span><span class="o">/</span><span class="mf">3.</span> <span class="p">)</span>

    <span class="c1"># all of the four above have shape (N)</span>
    <span class="c1"># more generally, if p is a multi dimensional array, like (N1, N1, N2)... Then this could also work</span>

    <span class="n">qq0_qg0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">qq0</span><span class="p">,</span> <span class="n">qg0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">gq0_gg0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">gq0</span><span class="p">,</span> <span class="n">gg0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">qq0_qg0</span><span class="p">,</span> <span class="n">gq0_gg0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span><span class="c1"># (N, 2, 2)</span></div>


<div class="viewcode-block" id="non_singlet_NLO">
<a class="viewcode-back" href="../Evolution.html#Evolution.non_singlet_NLO">[docs]</a>
<span class="k">def</span> <span class="nf">non_singlet_NLO</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">complex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non-singlet anomalous dimension.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (complex): which moment (= Mellin moment for integer n)</span>
<span class="sd">        nf (int): number of active quark flavors</span>
<span class="sd">        prty (int): 1 for NS^{+}, -1 for NS^{-}</span>

<span class="sd">    Returns:</span>
<span class="sd">        Non-singlet NLO anomalous dimension.</span>
<span class="sd">        </span>
<span class="sd">    This will work as long as n, nf, and prty can be broadcasted together.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># From Curci et al.</span>
    <span class="n">nlo</span> <span class="o">=</span> <span class="p">(</span><span class="n">CF</span> <span class="o">*</span> <span class="n">CG</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mi">16</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">poch</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="mi">16</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">poch</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">S2_prime</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">prty</span><span class="p">))</span> <span class="o">+</span>
            <span class="mi">64</span> <span class="o">*</span> <span class="n">S2_tilde</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">prty</span><span class="p">)</span> <span class="o">+</span> <span class="mi">24</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">S3_prime</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">prty</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">poch</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span>
            <span class="mi">16</span><span class="o">*</span><span class="n">prty</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">poch</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
           <span class="n">CF</span> <span class="o">*</span> <span class="n">CA</span> <span class="o">*</span> <span class="p">(</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">536</span><span class="o">/</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">poch</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span>
                      <span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">52</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">8</span><span class="o">/</span><span class="n">poch</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="mi">43</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span>
                      <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">151</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">263</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">97</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="n">poch</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>
           <span class="n">CF</span> <span class="o">*</span> <span class="n">nf</span> <span class="o">*</span> <span class="n">TF</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">160</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">32</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span>
                           <span class="mi">16</span><span class="o">*</span><span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="n">poch</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">4</span>

    <span class="k">return</span> <span class="n">nlo</span></div>

    

<div class="viewcode-block" id="singlet_NLO">
<a class="viewcode-back" href="../Evolution.html#Evolution.singlet_NLO">[docs]</a>
<span class="k">def</span> <span class="nf">singlet_NLO</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Singlet NLO anomalous dimensions matrix.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        n (complex): which moment (= Mellin moment for integer n)</span>
<span class="sd">        nf (int): number of active quark flavors</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et)</span>
<span class="sd">        prty (int): C parity</span>
<span class="sd">            </span>
<span class="sd">    Returns:</span>
<span class="sd">        Matrix (LO, NLO) where each is in turn</span>
<span class="sd">        2x2 complex matrix</span>
<span class="sd">        ((QQ, QG),</span>
<span class="sd">        (GQ, GG))</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
   <span class="c1"># qq1 = non_singlet_NLO(n, nf, 1) + np.ones_like(p) * (-4*CF*TF*nf*((2 + n*(n + 5))*(4 + n*(4 + n*(7 + 5*n)))/(n-1)/n**3/(n+1)**3/(n+2)**2))</span>
    
   <span class="c1"># qg1 = np.ones_like(p) * 2*nf*TF*(S1(n)*(2*S1(n)*(-CF*(n-1)*(n+2)**2*(2+n+n**2)*n**2*(n+1)**2 + CA*n**2*(n+1)**2*(n+2)**2*(n**3 + n - 2)) - CF*(n-1)*(n+2)**2*(-4*n*(n+1)**3*(n+2)) - 2*CA*(4*(n-1)*n**3*(n+1)*(n+2)*(2*n + 3))) + S2_prime(n)*(2*CA*n**2*(n+1)**2*(n+2)**2*(n**3 + n - 2)) - CF*(n-1)*(n+1)**2*(64 + 160*(n-1) + 159*(n-1)**2 + 70*(n-1)**3 + 11*(n-1)**4 + n**2*(n+1)**2*5*(2 + n + n**2)) - 2*CA*(16 + 64*n + 104*n**2 + 128*n**3 + 85*n**4 + 36*n**5 + 25*n**6 + 15*n**7 + 6*n**8 + n**9))/(n-1)/n**3/(n+1)**3/(n+2)**3</span>
    
  <span class="c1">#  gq1 = np.ones_like(p) * (-CF)*(S1(n)*(S1(n)*(18*CA*n**2*(n+1)**2*(n+2)**2*(n**3 + n - 2) - 18*CF*(n-1)*n**2*(n+2)**2*(2 + 5*n + 5*n**2 + 3*n**3 + n**4)) + 18*CF*(n-1)*n**2*(n+2)**2*(10 + 27*n + 25*n**2 + 13*n**3 + 5*n**4) - 6*CA*n*(n+1)**2*(n+2)**2*(-12 + n*(-22 + 41*n + 17*n**3)) + 24*(n-1)*n**2*(n+1)**2*(n+2)**2*(n**2 + n + 2)*TF*nf) + S2(n)*(18*CA*n**2*(n+1)**2*(n+2)**2*(n**3 + n - 2) - 18*CF*(n-1)*n**2*(n+2)**2*(2 + 5*n + 5*n**2 + 3*n**3 + n**4)) + 9*CF*(n-1)*(n+2)**2*(-4 + n*(-12 + n*(-1 + 28*n + 43*n + 43*n**2 + 30*n**3 + 12*n**4))) + 2*CA*(2592 + 21384*(n-1) + 72582*(n-1)**2 + 128024*(n-1)**3 + 133818*(n-1)**4 + 88673*(n-1)**5 + 38822*(n-1)**6 + 10292*(n-1)**7 + 1662*(n-1)**8 + 109*(n-1)**9 - 9*n**2*(n+1)**2*(n+2)**2*(n**3 + n - 2)*S2_prime(n)) - 8*(n-1)*n**2*(n+1)**2*(n+2)**2*(16 + 27*n + 13*n**2 + 8*n**3)*TF*nf)/9/n**3/(n+1)**3/(n**2 + n - 2)**2</span>
    
  <span class="c1">#  gg1 = np.ones_like(p) * (S1(n)*(CA**2*(134/9 + 16*(2*n + 1)*(-2 + n*(n+1)*(n**2 + n + 2))/(n-1)**2*n**2*(n+1)**2*(n+2)**2 - 4*S2_prime(n)) - 40*CA*TF*nf/9) + CA**2*(-16/3 - (576 + n*(1488 + n*(560 + n*(-1632 + n*(-2344 + n*(1567 + n*(6098 + n*(6040 + 457*n*(6 + n)))))))))/9/(n-1)**2/n**3/(n+1)**3/(n+2)**3 + 8*(n*82 + n + 1)*S2_prime(n)/(n-1)*n*(n+1)*(n+2) - S3_prime(n) + 8*S2_tilde(n)) + 8*CF*TF*nf*(3 + (6+ n*(n+1)*(28 + 19*n*(n+1)))/n**2/(n+1)**2/(n**2 + n - 2))/9 + 2*CF*TF*nf*(-8 + n*(-8 + n*(-10 + n*(-22 + n*(-3 + n*(6 + n*(8 + n*(4 + n)))))))))</span>
    
  <span class="c1">#  qq1_qg1 = np.stack((qq1, qg1), axis=-1)</span>
  <span class="c1">#  gq1_gg1 = np.stack((gq1, gg1), axis=-1)</span>

   <span class="c1"># return np.stack((qq1_qg1, gq1_gg1), axis=-2)# (N, 2, 2)</span>
    
    
   <span class="c1"># qq1 = np.where(p&gt;0, non_singlet_NLO(n, nf, 1) - 4*CF*TF*nf*(5*n**5+32*n**4+49*n**3+38*n**2 + 28*n+8)/((n-1)*n**3*(n+1)**3*(n+2)**2), non_singlet_NLO(n, nf, 1) - 4*CF*TF*nf*(5*n**5+32*n**4+49*n**3+38*n**2 + 28*n+8)/((n-1)*n**3*(n+1)**3*(n+2)**2))</span>

   <span class="c1"># qg1 = np.where(p&gt;0,(-8*CF*nf*TF*((-4*S1(n))/n**2+(4+8*n + 26*n**3 + 11*n**4 + 15*(n*n))/(n**3*(1+n)**3*(2+n)) + ((2+n+n*n)*(5-2*S2(n) + 2*(S1(n)*S1(n))))/(n*(1+n)*(2+n))) - 8*CA*nf*TF*((8*(3+2*n)*S1(n))/((1+n)**2*(2+n)**2) + (2*(16+64*n+128*n**3+85*n**4+36*n**5+25*n**6 + 15*n**7+6*n**8+n**9+104*(n*n)))/( (-1+n)*n**3*(1+n)**3*(2+n)**3)+( (2+n+n*n)*(2*S2(n)-2*(S1(n)*S1(n))-2*S2(n/2)))/(n*(1+n)*(2+n))))/4, (-8*CF*nf*TF*((-4*S1(n))/n**2+(4+8*n + 26*n**3 + 11*n**4 + 15*(n*n))/(n**3*(1+n)**3*(2+n)) + ((2+n+n*n)*(5-2*S2(n) + 2*(S1(n)*S1(n))))/(n*(1+n)*(2+n))) - 8*CA*nf*TF*((8*(3+2*n)*S1(n))/((1+n)**2*(2+n)**2) + (2*(16+64*n+128*n**3+85*n**4+36*n**5+25*n**6 + 15*n**7+6*n**8+n**9+104*(n*n)))/( (-1+n)*n**3*(1+n)**3*(2+n)**3)+( (2+n+n*n)*(2*S2(n)-2*(S1(n)*S1(n))-2*S2(n/2)))/(n*(1+n)*(2+n))))/4)</span>

   <span class="c1"># gq1 = np.where(p&gt;0, (-(32/3)*CF*nf*TF*((1+n)**(-2) + ((-(8/3)+S1(n))*(2+n+n*n))/((-1+n)*n*(1+n))) - 4*(CF*CF)*((-4*S1(n))/(1+n)**2-( -4-12*n+28*n**3+43*n**4 + 30*n**5+12*n**6-n*n)/((-1+n)*n**3*(1+n)**3) + ((2+n+n*n)*(10*S1(n)-2*S2(n)-2*(S1(n)*S1(n))))/((-1+n)*n*(1+n))) - 8*CF*CA*(((1/9)*(144+432*n-1304*n**3-1031*n**4 + 695*n**5+1678*n**6+1400*n**7+621*n**8+109*n**9 - 152*(n*n)))/((-1+n)**2*n**3*(1+n)**3*(2+n)**2) - ((1/3)*S1(n)*(-12-22*n+17*n**4 + 41*(n*n)))/((-1+n)**2*n**2*(1+n))+( (2+n+n*n)*(S2(n) + S1(n)*S1(n)-S2(n/2)))/((-1+n)*n*(1+n))))/4, (-(32/3)*CF*nf*TF*((1+n)**(-2) + ((-(8/3)+S1(n))*(2+n+n*n))/((-1+n)*n*(1+n))) - 4*(CF*CF)*((-4*S1(n))/(1+n)**2-( -4-12*n+28*n**3+43*n**4 + 30*n**5+12*n**6-n*n)/((-1+n)*n**3*(1+n)**3) + ((2+n+n*n)*(10*S1(n)-2*S2(n)-2*(S1(n)*S1(n))))/((-1+n)*n*(1+n))) - 8*CF*CA*(((1/9)*(144+432*n-1304*n**3-1031*n**4 + 695*n**5+1678*n**6+1400*n**7+621*n**8+109*n**9 - 152*(n*n)))/((-1+n)**2*n**3*(1+n)**3*(2+n)**2) - ((1/3)*S1(n)*(-12-22*n+17*n**4 + 41*(n*n)))/((-1+n)**2*n**2*(1+n))+( (2+n+n*n)*(S2(n) + S1(n)*S1(n)-S2(n/2)))/((-1+n)*n*(1+n))))/4)</span>

   <span class="c1"># gg1 = np.where(p&gt;0, (CF*nf*TF*(8+(16*(-4-4*n-10*n**3+n**4+4*n**5+2*n**6 - 5*(n*n)))/((-1+n)*n**3*(1+n)**3*(2+n))) + CA*nf*TF*(32/3 - (160/9)*S1(n)+( (16/9)*(12+56*n+76*n**3+38*n**4+94*(n*n)))/((-1+n)*n**2*(1+n)**2*(2+n))) + CA*CA*(-64/3+(536/9)*S1(n)+(64*S1(n)*( -2-2*n+8*n**3+5*n**4+2*n**5+7*(n*n)))/((-1+n)**2*n**2*(1+n)**2*(2+n)**2) - ((4/9)*(576+1488*n-1632*n**3-2344*n**4+1567*n**5 + 6098*n**6+6040*n**7+2742*n**8+457*n**9+560*(n*n)))/( (-1+n)**2*n**3*(1+n)**3*(2+n)**3) - 16*S1(n)*S2(n/2)+(32*(1+n+n*n)*S2(n/2))/( (-1+n)*n*(1+n)*(2+n))-4*S3(n/2) + 32*(S1(n)/n**2-(5/8)*zeta(3)+MellinF2(n) - zeta(2)*(-psi(n/2)+psi((1+n)/2))/2)))/4, (CF*nf*TF*(8+(16*(-4-4*n-10*n**3+n**4+4*n**5+2*n**6 - 5*(n*n)))/((-1+n)*n**3*(1+n)**3*(2+n))) + CA*nf*TF*(32/3 - (160/9)*S1(n)+( (16/9)*(12+56*n+76*n**3+38*n**4+94*(n*n)))/((-1+n)*n**2*(1+n)**2*(2+n))) + CA*CA*(-64/3+(536/9)*S1(n)+(64*S1(n)*( -2-2*n+8*n**3+5*n**4+2*n**5+7*(n*n)))/((-1+n)**2*n**2*(1+n)**2*(2+n)**2) - ((4/9)*(576+1488*n-1632*n**3-2344*n**4+1567*n**5 + 6098*n**6+6040*n**7+2742*n**8+457*n**9+560*(n*n)))/( (-1+n)**2*n**3*(1+n)**3*(2+n)**3) - 16*S1(n)*S2(n/2)+(32*(1+n+n*n)*S2(n/2))/( (-1+n)*n*(1+n)*(2+n))-4*S3(n/2) + 32*(S1(n)/n**2-(5/8)*zeta(3)+MellinF2(n) - zeta(2)*(-psi(n/2)+psi((1+n)/2))/2)))/4)</span>


    <span class="n">qq1</span> <span class="o">=</span> <span class="n">non_singlet_NLO</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">CF</span><span class="o">*</span><span class="n">TF</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">5</span><span class="o">+</span><span class="mi">32</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">49</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">38</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">28</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="n">qg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">CF</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="n">TF</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">8</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">26</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="p">((</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))))</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">CA</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="n">TF</span><span class="o">*</span><span class="p">((</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="mi">64</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">128</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">85</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">36</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">5</span><span class="o">+</span><span class="mi">25</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">7</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">8</span><span class="o">+</span><span class="n">n</span><span class="o">**</span><span class="mi">9</span><span class="o">+</span><span class="mi">104</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">))))</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
    
    <span class="n">gq1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="mi">32</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CF</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="n">TF</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">CF</span><span class="o">*</span><span class="n">CF</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span> <span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">28</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">43</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">30</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">5</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">6</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">))))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">CF</span><span class="o">*</span><span class="n">CA</span><span class="o">*</span><span class="p">(((</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">144</span><span class="o">+</span><span class="mi">432</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1304</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mi">1031</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">695</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">5</span><span class="o">+</span><span class="mi">1678</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">6</span><span class="o">+</span><span class="mi">1400</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">7</span><span class="o">+</span><span class="mi">621</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">8</span><span class="o">+</span><span class="mi">109</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">152</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">22</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">17</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">41</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">))</span><span class="o">+</span><span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">))))</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
    
    <span class="n">gg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">CF</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="n">TF</span><span class="o">*</span><span class="p">(</span><span class="mi">8</span><span class="o">+</span><span class="p">(</span><span class="mi">16</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">5</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)))</span> <span class="o">+</span> <span class="n">CA</span><span class="o">*</span><span class="n">nf</span><span class="o">*</span><span class="n">TF</span><span class="o">*</span><span class="p">(</span><span class="mi">32</span><span class="o">/</span><span class="mi">3</span> <span class="o">-</span> <span class="p">(</span><span class="mi">160</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="p">(</span> <span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="mi">56</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">76</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">38</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">94</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)))</span> <span class="o">+</span> <span class="n">CA</span><span class="o">*</span><span class="n">CA</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">64</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="mi">536</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">64</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">8</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">5</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="mi">4</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">576</span><span class="o">+</span><span class="mi">1488</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1632</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mi">2344</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">1567</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">6098</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">6</span><span class="o">+</span><span class="mi">6040</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">7</span><span class="o">+</span><span class="mi">2742</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">8</span><span class="o">+</span><span class="mi">457</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">9</span><span class="o">+</span><span class="mi">560</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">16</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">32</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">S2</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">))</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">S3</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">MellinF2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">psi</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">psi</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
                          
    <span class="c1">#qq1_qg1 = np.stack((qq1, qg1), axis=0)</span>
    <span class="c1">#gq1_gg1 = np.stack((gq1, gg1), axis=0)</span>
    
    <span class="n">n_tester</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="n">n_tester</span><span class="p">):</span>
        <span class="n">qq1_qg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">qq1</span><span class="p">,</span> <span class="n">qg1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">gq1_gg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">gq1</span><span class="p">,</span> <span class="n">gg1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">qq1_qg1</span><span class="p">,</span><span class="n">gq1_gg1</span><span class="p">),</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">qq1</span><span class="p">,</span> <span class="n">qg1</span><span class="p">],</span> <span class="p">[</span><span class="n">gq1</span><span class="p">,</span> <span class="n">gg1</span><span class="p">]]),(</span><span class="n">length</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">result</span><span class="c1"># (N, 2, 2)    </span></div>


    <span class="c1">#return np.array([[qq1, qg1],</span>
    <span class="c1">#                 [gq1, gg1]])[np.newaxis,...]*np.ones_like(p)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">***********************Evolution operator of GPD in the moment space*******</span>
<span class="sd">Refer to the evolution.py at https://github.com/kkumer/gepard. Modifications are made.</span>
<span class="sd">&quot;&quot;&quot;</span>

<div class="viewcode-block" id="lambdaf">
<a class="viewcode-back" href="../Evolution.html#Evolution.lambdaf">[docs]</a>
<span class="k">def</span> <span class="nf">lambdaf</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Eigenvalues of the LO singlet anomalous dimensions matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (complex): which moment (= Mellin moment for integer n)</span>
<span class="sd">        nf (int): number of active quark flavors</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et)</span>
<span class="sd">        prty (int): 1 for NS^{+}, -1 for NS^{-}, irrelevant at LO</span>

<span class="sd">    Returns:</span>
<span class="sd">        lam[a, k]</span>
<span class="sd">        a in [+, -] and k is MB contour point index</span>

<span class="sd">    Normally, n and nf should be scalars. p should be (N)</span>
<span class="sd">    More generally, as long as they can be broadcasted, any shape is OK.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># To avoid crossing of the square root cut on the</span>
    <span class="c1"># negative real axis we use trick by Dieter Mueller</span>
    <span class="n">gam0</span> <span class="o">=</span> <span class="n">singlet_LO</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prty</span><span class="p">)</span> <span class="c1"># (N, 2, 2)</span>
    <span class="n">aux</span> <span class="o">=</span> <span class="p">((</span><span class="n">gam0</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">gam0</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span>
           <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">gam0</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">gam0</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span>
                   <span class="p">(</span><span class="n">gam0</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">gam0</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># (N)</span>
    <span class="n">lam1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">gam0</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">gam0</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">aux</span><span class="p">)</span> <span class="c1"># (N)</span>
    <span class="n">lam2</span> <span class="o">=</span> <span class="n">lam1</span> <span class="o">+</span> <span class="n">aux</span>  <span class="c1"># (N)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">lam1</span><span class="p">,</span> <span class="n">lam2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># shape (N, 2)</span></div>


<div class="viewcode-block" id="projectors">
<a class="viewcode-back" href="../Evolution.html#Evolution.projectors">[docs]</a>
<span class="k">def</span> <span class="nf">projectors</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Projectors on evolution quark-gluon singlet eigenaxes.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (complex): which moment (= Mellin moment for integer n)</span>
<span class="sd">        nf (int): number of active quark flavors</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et)</span>
<span class="sd">        prty (int): 1 for NS^{+}, -1 for NS^{-}, irrelevant at LO</span>

<span class="sd">    Returns:</span>
<span class="sd">         lam: eigenvalues of LO an. dimm matrix lam[a, k]  # Eq. (123)</span>
<span class="sd">          pr: Projector pr[k, a, i, j]  # Eq. (122)</span>
<span class="sd">               k is MB contour point index</span>
<span class="sd">               a in [+, -]</span>
<span class="sd">               i,j in {Q, G}</span>

<span class="sd">    n and nf will be scalars</span>
<span class="sd">    p will be shape (N)</span>
<span class="sd">    prty should be scalar (but maybe I can make it work with shape N)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gam0</span> <span class="o">=</span> <span class="n">singlet_LO</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prty</span><span class="p">)</span>    <span class="c1"># (N, 2, 2)</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="n">lambdaf</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prty</span><span class="p">)</span>        <span class="c1"># (N, 2)</span>
    <span class="n">den</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">lam</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">lam</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1">#(N)</span>
    <span class="c1"># P+ and P-</span>
    <span class="n">ssm</span> <span class="o">=</span> <span class="n">gam0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...,ij-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">lam</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1">#(N, 2, 2)</span>
    <span class="n">ssp</span> <span class="o">=</span> <span class="n">gam0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...,ij-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">lam</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1">#(N, 2, 2)</span>
    <span class="n">prp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...,...ij-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">den</span><span class="p">,</span> <span class="n">ssm</span><span class="p">)</span> <span class="c1"># (N, 2, 2)</span>
    <span class="n">prm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...,...ij-&gt;...ij&#39;</span><span class="p">,</span> <span class="o">-</span><span class="n">den</span><span class="p">,</span> <span class="n">ssp</span><span class="p">)</span> <span class="c1"># (N, 2, 2)</span>
    <span class="c1"># We insert a-axis before i,j-axes, i.e. on -3rd place</span>
    <span class="n">pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">prp</span><span class="p">,</span> <span class="n">prm</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># (N, 2, 2, 2)</span>
    <span class="k">return</span> <span class="n">lam</span><span class="p">,</span> <span class="n">pr</span> <span class="c1"># (N, 2) and (N, 2, 2, 2)</span></div>


 
<div class="viewcode-block" id="outer_subtract">
<a class="viewcode-back" href="../Evolution.html#Evolution.outer_subtract">[docs]</a>
<span class="k">def</span> <span class="nf">outer_subtract</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span><span class="n">arr2</span><span class="p">):</span>   
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform the outer product of two array at the last dimension, each has shape (N,..., m)</span>
<span class="sd">    </span>
<span class="sd">    | Generate shape (N,m,m), Here m = 2 for S/G </span>
<span class="sd">    | result(i,j)=arr1(i)-arr2(j)</span>

<span class="sd">    Args:</span>
<span class="sd">        arr1 (np.array): 1st array in the outer subtract has shape (N,m)</span>
<span class="sd">        arr2 (np.array): 2nd array in the outer subtract has shape (N,m)</span>

<span class="sd">    Returns:</span>
<span class="sd">        result (np.ndarray): shape(N,m,m) given by result(i,j)=arr1(i)-arr2(j)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">repeated_arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">arr1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">repeated_arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">arr2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">transposed_axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">repeated_arr1</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
    <span class="n">transposed_axes</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">transposed_axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">transposed_axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">transposed_axes</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>    
    <span class="k">return</span> <span class="n">repeated_arr1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">repeated_arr2</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">transposed_axes</span><span class="p">)</span></div>


<div class="viewcode-block" id="rmudep">
<a class="viewcode-back" href="../Evolution.html#Evolution.rmudep">[docs]</a>
<span class="k">def</span> <span class="nf">rmudep</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">lamj</span><span class="p">,</span> <span class="n">lamk</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale dependent part of NLO evolution matrix </span>
<span class="sd">    </span>
<span class="sd">    | Ref to the eq. (126) in hep-ph/0703179 </span>
<span class="sd">    | Here the expression is exactly the same as the ref, UNLIKE the Gepard with has an extra beta_0 to be canceled with amuindep</span>

<span class="sd">    Args:</span>
<span class="sd">        nf (int): number of effective fermions</span>
<span class="sd">        lamj (np.array): shape (N,2,2), each row is 2-by-2 matrix of anomalous dimension in the (S, G) basis</span>
<span class="sd">        lamk (np.array): shape (N,2,2), second row anomalous dimension for k</span>
<span class="sd">        mu (float): final scale to be evolved from inital scale Init_Scale_Q</span>

<span class="sd">    Returns:</span>
<span class="sd">        R_ij^ab(Q}|n=1) according to eq. (126) in hep-ph/0703179 </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lamdif</span><span class="o">=</span><span class="n">outer_subtract</span><span class="p">(</span><span class="n">lamj</span><span class="p">,</span><span class="n">lamk</span><span class="p">)</span>
        
    <span class="n">b0</span> <span class="o">=</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span> <span class="c1"># scalar</span>
    <span class="n">b11</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">lamdif</span><span class="p">)</span> <span class="o">+</span> <span class="n">lamdif</span> <span class="c1"># shape (N,2,2)</span>
    <span class="c1">#print(b11)</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="c1"># shape N</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
    <span class="c1">#print(R)</span>
    <span class="n">Rpow</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">R</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="n">b11</span><span class="o">/</span><span class="n">b0</span><span class="p">)</span> <span class="c1"># shape (N,2,2)</span>
    <span class="c1">#print((np.ones_like(Rpow) - Rpow) / b11)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Rpow</span><span class="p">)</span> <span class="o">-</span> <span class="n">Rpow</span><span class="p">)</span> <span class="o">/</span> <span class="n">b11</span> <span class="c1"># shape (N,2,2)</span></div>


<div class="viewcode-block" id="amuindep">
<a class="viewcode-back" href="../Evolution.html#Evolution.amuindep">[docs]</a>
<span class="k">def</span> <span class="nf">amuindep</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Result the P [gamma] P part of the diagonal evolution operator A.</span>
<span class="sd">    </span>
<span class="sd">    | Ref to eq. (124) in hep-ph/0703179 (the A operator are the same in both CSbar and MSbar scheme)</span>
<span class="sd">    | Here the expression is exactly the same as the ref, UNLIKE the Gepard with has an extra 1/beta_0 to be canceled with rmudep</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        j (complex): _description_</span>
<span class="sd">        nf (int): _description_</span>
<span class="sd">        p (int): _description_</span>
<span class="sd">        prty (int, optional): _description_. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the P [gamma] P part of the diagonal evolution operator A.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lam</span><span class="p">,</span> <span class="n">pr</span> <span class="o">=</span> <span class="n">projectors</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prty</span><span class="p">)</span>
    
    <span class="n">gam0</span> <span class="o">=</span> <span class="n">singlet_LO</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nf</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
    <span class="n">gam1</span> <span class="o">=</span> <span class="n">singlet_NLO</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nf</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="o">-</span> <span class="n">gam1</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">beta1</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span> <span class="o">*</span> <span class="n">gam0</span> <span class="o">/</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...aic,...cd,...bdj-&gt;...abij&#39;</span><span class="p">,</span> <span class="n">pr</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">pr</span><span class="p">)</span>
   
    <span class="k">return</span> <span class="n">A</span></div>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">def amuindepNS(j: complex, nf: int, p: int, prty: int = 1):</span>
<span class="sd">    </span>
<span class="sd">    gam0NS = non_singlet_LO(j+1,nf,p)</span>
<span class="sd">    gam1NS = non_singlet_NLO(j+1,nf,p)</span>
<span class="sd">    a1 = - gam1NS + 0.5 * beta1(nf) * gam0NS / beta0(nf) </span>
<span class="sd">    return a1</span>
<span class="sd">#print(amuindepNS(np.array([0.1,0.2]),2,1,1))</span>
<span class="sd">&#39;&#39;&#39;</span>

<div class="viewcode-block" id="bmudep">
<a class="viewcode-back" href="../Evolution.html#Evolution.bmudep">[docs]</a>
<span class="k">def</span> <span class="nf">bmudep</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">zn</span><span class="p">,</span> <span class="n">zk</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">NS</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">prty</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the off-diagonal part of the evolution operator B^{jk} combined with (alpha(Q)/alpha(mu_0)) ^ (-b/beta0)</span>
<span class="sd">    </span>
<span class="sd">    Check eq. (140) in hep-ph/0703179 for the expression of B^{jk}, and eq. (137) for the following factor</span>

<span class="sd">    Args:</span>
<span class="sd">        mu (float): scale evolved to from the initial scale Init_Scale_Q</span>
<span class="sd">        zn (np.array): shape (N,) moment j</span>
<span class="sd">        zk (np.array): shape (N,) moment k that differs from j for off-diagonal term</span>
<span class="sd">        nf (int): number of effective fermions</span>
<span class="sd">        p (int): parity of the GPDs </span>
<span class="sd">        NS (bool, optional): True for non-singlet. NOT used here so set to default False.</span>
<span class="sd">        prty (int, optional): The party of the parton distributions +1 for S/G. Not used for NS so set to default 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">       B^{jk}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="c1"># shape N</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
    <span class="n">b0</span> <span class="o">=</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span>
    
    <span class="n">AAA</span> <span class="o">=</span> <span class="p">(</span><span class="n">S1</span><span class="p">((</span><span class="n">zn</span><span class="o">+</span><span class="n">zk</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>
           <span class="n">S1</span><span class="p">((</span><span class="n">zn</span><span class="o">-</span><span class="n">zk</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
           <span class="mi">2</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">zn</span><span class="o">-</span><span class="n">zk</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span>
           <span class="n">S1</span><span class="p">(</span><span class="n">zn</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1"># GOD = &quot;G Over D&quot; = g_jk / d_jk</span>
    <span class="n">GOD_11</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">CF</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mi">2</span><span class="o">*</span><span class="n">AAA</span> <span class="o">+</span> <span class="p">(</span><span class="n">AAA</span> <span class="o">-</span> <span class="n">S1</span><span class="p">(</span><span class="n">zn</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">zn</span><span class="o">-</span><span class="n">zk</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>
                <span class="n">zn</span><span class="o">+</span><span class="n">zk</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">zk</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">zk</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">nzero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">GOD_11</span><span class="p">)</span>
    <span class="n">GOD_12</span> <span class="o">=</span> <span class="n">nzero</span>
    <span class="n">GOD_21</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">CF</span><span class="o">*</span><span class="p">(</span><span class="n">zn</span><span class="o">-</span><span class="n">zk</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zn</span><span class="o">+</span><span class="n">zk</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">zn</span><span class="o">/</span><span class="p">(</span><span class="n">zk</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">zk</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">GOD_22</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">CA</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">AAA</span> <span class="o">+</span> <span class="p">(</span><span class="n">AAA</span> <span class="o">-</span> <span class="n">S1</span><span class="p">(</span>
        <span class="n">zn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">poch</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="n">poch</span><span class="p">(</span><span class="n">zk</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span>
                    <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">zn</span><span class="o">-</span><span class="n">zk</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">zn</span><span class="o">+</span><span class="n">zk</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="n">poch</span><span class="p">(</span><span class="n">zk</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="o">*</span> <span class="n">zk</span> <span class="o">/</span> <span class="n">zn</span>
    <span class="n">god</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">GOD_11</span><span class="p">,</span> <span class="n">GOD_12</span><span class="p">],</span> <span class="p">[</span><span class="n">GOD_21</span><span class="p">,</span> <span class="n">GOD_22</span><span class="p">]])</span>
    <span class="n">dm_22</span> <span class="o">=</span> <span class="n">zk</span><span class="o">/</span><span class="n">zn</span>
    <span class="n">dm_11</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">dm_22</span><span class="p">)</span>
    <span class="n">dm_12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">dm_22</span><span class="p">)</span>
    <span class="n">dm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">dm_11</span><span class="p">,</span> <span class="n">dm_12</span><span class="p">],</span> <span class="p">[</span><span class="n">dm_12</span><span class="p">,</span> <span class="n">dm_22</span><span class="p">]])</span>
    
    <span class="n">fac</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">zk</span><span class="o">-</span><span class="n">zn</span><span class="p">)</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">zn</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="n">zn</span><span class="o">+</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="n">zk</span><span class="o">+</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">zk</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">zk</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">zn</span><span class="o">-</span><span class="n">zk</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">zn</span><span class="o">+</span><span class="n">zk</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> 

    <span class="c1">#fac = (zk+1)*(zk+2)*(2*zn+3)/(zn+1)/(zn+2)/(zn-zk)/(zn+zk+3)</span>
    
    <span class="n">lamn</span><span class="p">,</span> <span class="n">pn</span> <span class="o">=</span> <span class="n">projectors</span><span class="p">(</span><span class="n">zn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prty</span><span class="p">)</span>
    <span class="n">lamk</span><span class="p">,</span> <span class="n">pk</span> <span class="o">=</span> <span class="n">projectors</span><span class="p">(</span><span class="n">zk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prty</span><span class="p">)</span>

    <span class="n">proj_DM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...naif,fg...n,...nbgj-&gt;...nabij&#39;</span><span class="p">,</span> <span class="n">pn</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">pk</span><span class="p">)</span>
    <span class="c1">#print(proj_DM)</span>
    <span class="n">proj_GOD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...naif,fg...n,...nbgj-&gt;...nabij&#39;</span><span class="p">,</span> <span class="n">pn</span><span class="p">,</span> <span class="n">god</span><span class="p">,</span> <span class="n">pk</span><span class="p">)</span>
    <span class="c1">#print(proj_GOD)</span>
     
    <span class="n">er1</span> <span class="o">=</span> <span class="n">rmudep</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">lamn</span><span class="p">,</span> <span class="n">lamk</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
    
    <span class="n">bet_proj_DM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...nb,...nabij-&gt;...nabij&#39;</span><span class="p">,</span> <span class="n">b0</span><span class="o">-</span><span class="n">lamk</span><span class="p">,</span> <span class="n">proj_DM</span><span class="p">)</span>      
    
    <span class="n">lamdif</span><span class="o">=</span><span class="n">outer_subtract</span><span class="p">(</span><span class="n">lamn</span><span class="p">,</span><span class="n">lamk</span><span class="p">)</span>   

    <span class="n">Bjk</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...n,...nab,...nabij,...nb-&gt;...nij&#39;</span><span class="p">,</span> <span class="n">fac</span><span class="p">,</span>
                    <span class="n">er1</span><span class="o">*</span><span class="n">lamdif</span><span class="p">,</span>
                    <span class="n">bet_proj_DM</span> <span class="o">+</span> <span class="n">proj_GOD</span><span class="p">,</span>
                    <span class="n">R</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">lamk</span><span class="o">/</span><span class="n">b0</span><span class="p">))</span> 
    <span class="k">return</span> <span class="n">Bjk</span></div>


<div class="viewcode-block" id="evolop">
<a class="viewcode-back" href="../Evolution.html#Evolution.evolop">[docs]</a>
<span class="k">def</span> <span class="nf">evolop</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Leading order GPD evolution operator E(j, nf, mu)[a,b].</span>

<span class="sd">    Args:</span>
<span class="sd">         j: MB contour points (Note: n = j + 1 !!)</span>
<span class="sd">         nf: number of effective fermion</span>
<span class="sd">         p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et)</span>
<span class="sd">         mu: final scale of evolution </span>

<span class="sd">    Returns:</span>
<span class="sd">         Evolution operator E(j, nf, mu)[a,b] at given j nf and mu as 3-by-3 matrix</span>
<span class="sd">         - a and b are in the flavor space (non-singlet, singlet, gluon)</span>

<span class="sd">    In original evolop function, j, nf, p, and mu are all scalars.</span>
<span class="sd">    Here, j and nf will be scalars.</span>
<span class="sd">    p and mu will have shape (N)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#Alpha-strong ratio.</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="c1"># shape N</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>

    <span class="c1">#LO singlet anomalous dimensions and projectors</span>
    <span class="n">lam</span><span class="p">,</span> <span class="n">pr</span> <span class="o">=</span> <span class="n">projectors</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>    <span class="c1"># (N, 2) (N, 2, 2, 2)</span>

    <span class="c1">#LO pQCD beta function of GPD evolution</span>
    <span class="n">b0</span> <span class="o">=</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span> <span class="c1"># scalar</span>

    <span class="c1">#Singlet LO evolution factor (alpha(mu)/alpha(mu0))^(-gamma/beta0) in (+,-) space</span>
    <span class="n">Rfact</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">lam</span><span class="o">/</span><span class="n">b0</span><span class="p">)</span> <span class="c1"># (N, 2)     </span>

    <span class="c1">#Singlet LO evolution matrix in (u+d, g) space</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    # The Gepard code by K. Kumericki reads:</span>
<span class="sd">    evola0ab = np.einsum(&#39;kaij,ab-&gt;kabij&#39;, pr,  np.identity(2))</span>
<span class="sd">    evola0 = np.einsum(&#39;kabij,bk-&gt;kij&#39;, evola0ab, Rfact)</span>
<span class="sd">    # We use instead</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">evola0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...aij,...a-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">pr</span><span class="p">,</span> <span class="n">Rfact</span><span class="p">)</span> <span class="c1"># (N, 2, 2)</span>
    
    <span class="c1">#Non-singlet LO anomalous dimension</span>
    <span class="n">gam0NS</span> <span class="o">=</span> <span class="n">non_singlet_LO</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="c1">#this function is already numpy compatible</span>
    <span class="c1"># shape (N)</span>

    <span class="c1">#Non-singlet evolution factor </span>
    <span class="n">evola0NS</span> <span class="o">=</span> <span class="n">R</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">gam0NS</span><span class="o">/</span><span class="n">b0</span><span class="p">)</span> <span class="c1">#(N)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">evola0NS</span><span class="p">,</span> <span class="n">evola0</span><span class="p">]</span> <span class="c1"># (N) and (N, 2, 2)</span></div>


<span class="c1"># Need Wilson coefficients for evolution. Allows numerical pre-calculation of non-diagonal piece using Mellin-Barnes integral</span>

<div class="viewcode-block" id="WilsonCoef">
<a class="viewcode-back" href="../Evolution.html#Evolution.WilsonCoef">[docs]</a>
<span class="k">def</span> <span class="nf">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="nb">complex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">complex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Leading-order Wilson coefficient, elements used in both DVCS and DVMP</span>

<span class="sd">    Args:</span>
<span class="sd">        j (complex array): shape(N,) conformal spin j</span>

<span class="sd">    Returns:</span>
<span class="sd">        Leading-order Wilson coefficient (complex, could be an array)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">j</span><span class="p">))</span></div>


<div class="viewcode-block" id="WilsonCoef_DVCS_LO">
<a class="viewcode-back" href="../Evolution.html#Evolution.WilsonCoef_DVCS_LO">[docs]</a>
<span class="k">def</span> <span class="nf">WilsonCoef_DVCS_LO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="nb">complex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">complex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;LO Wilson coefficient of DVCS in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g)</span>
<span class="sd">        </span>
<span class="sd">    Args:</span>
<span class="sd">        j (complex array): shape(N,) conformal spin j</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        Wilson coefficient of shape (N,5) in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g)</span>
<span class="sd">        </span>
<span class="sd">    | Charge factor are calculated such that the sum in the evolution basis are identical to the sum in the flavor basis</span>
<span class="sd">    | Gluon charge factor is the same as the singlet one, but the LO Wilson coefficient is zero in DVCS.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">charge_fact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="mi">18</span><span class="p">])</span>
    <span class="n">CWT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> \
                    <span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> \
                    <span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> \
                    <span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">),</span>\
                    <span class="mi">0</span> <span class="o">*</span> <span class="n">j</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j, j...-&gt;j...&#39;</span><span class="p">,</span> <span class="n">charge_fact</span><span class="p">,</span> <span class="n">CWT</span><span class="p">)</span></div>


<div class="viewcode-block" id="WilsonCoef_DVMP_LO">
<a class="viewcode-back" href="../Evolution.html#Evolution.WilsonCoef_DVMP_LO">[docs]</a>
<span class="k">def</span> <span class="nf">WilsonCoef_DVMP_LO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">meson</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">complex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;LO Wilson coefficient of DVMP in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g)</span>

<span class="sd">    Args:</span>
<span class="sd">        j (complex array): shape(N,) conformal spin j</span>
<span class="sd">        nf (int): number of effective fermions</span>
<span class="sd">        meson (int): 1 for rho, 2 for phi, and 3 for Jpsi</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        Wilson coefficient of shape (N,5) in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g)</span>
<span class="sd">        </span>
<span class="sd">    | Charge factor are calculated such that the sum in the evolution basis are identical to the sum in the flavor basis</span>
<span class="sd">    | Gluon charge factor is the same as the singlet one.</span>
<span class="sd">    | The meson decay constant, CF/NC, and eq are included in the prefactor of Wilson coefficient. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># A factor of 3 coming from the asymptotic DA. The factors for S/G can be found in eq. (22b) of 2310.13837</span>
    <span class="n">CWT</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> \
                       <span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> \
                       <span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> \
                       <span class="mi">1</span><span class="o">/</span> <span class="n">nf</span> <span class="o">*</span> <span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">),</span>\
                       <span class="mi">2</span> <span class="o">/</span><span class="n">CF</span><span class="o">/</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">)])</span>
                             
    <span class="k">if</span><span class="p">(</span><span class="n">meson</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j, j...-&gt;j...&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="n">CWT</span><span class="p">)</span> <span class="o">*</span> <span class="n">f_jpsi</span> <span class="o">*</span> <span class="n">CF</span><span class="o">/</span><span class="n">NC</span></div>


<div class="viewcode-block" id="WilsonCoef_DVMP_NLO">
<a class="viewcode-back" href="../Evolution.html#Evolution.WilsonCoef_DVMP_NLO">[docs]</a>
<span class="k">def</span> <span class="nf">WilsonCoef_DVMP_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">muf</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">meson</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;NLO Wilson coefficient of DVMP in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g)</span>
<span class="sd">    </span>
<span class="sd">    | currently setting factorization scale and renormalization scale to the same as muf</span>
<span class="sd">    | Only singlet at this point.</span>

<span class="sd">    Args:</span>
<span class="sd">        j (complex array): shape(N,) conformal spin j of the GPD moment</span>
<span class="sd">        k (complex array): shape(N,) conformal spin k of the meson DA</span>
<span class="sd">        nf (int): number of effective fermions</span>
<span class="sd">        Q (float): the photon virtuality </span>
<span class="sd">        mufact (float): the factorization scale mu_fact</span>
<span class="sd">        meson (int): 1 for rho, 2 for phi, and 3 for Jpsi</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        Wilson coefficient of shape (N,5) in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g)</span>
<span class="sd">    </span>
<span class="sd">    | Charge factor are calculated such that the sum in the evolution basis are identical to the sum in the flavor basis</span>
<span class="sd">    | Gluon charge factor is the same as the singlet one.</span>
<span class="sd">    | The meson decay constant, CF/NC, and eq are included in the prefactor of Wilson coefficient. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">mufact2</span> <span class="o">=</span> <span class="n">muf</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">mures2</span> <span class="o">=</span>  <span class="n">muf</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">muphi2</span> <span class="o">=</span>  <span class="n">muf</span> <span class="o">**</span> <span class="mi">2</span>

   <span class="c1"># CQCF = (-np.log(Q**2/mufact) + S1(j+1) + S1(k + 1) - 1 - 1/2/(j+1)/(j+2) - 1/2/(k+1)/(k+2))*(4*S1(j+1) - 3 - 2/(j+1)/(j+2))/2 + (-np.log(Q**2/muphi) + S1(k+1) + S1(j + 1) - 1 - 1/2/(k+1)/(k+2) - 1/2/(j+1)/(j+2))*(4*S1(k+1) - 3 - 2/(k+1)/(k+2))/2 - 23/3 + (3*(j+1)*(j+2)+1)/2/(j+1)**2/(j+2)**2 + (3*(k+1)*(k+2)+1)/2/(k+1)**2/(k+2)**2</span>
    
   <span class="c1"># CQCG = (2*S1(j+2) - 1/(j+1)/(j+2))*(1 + (-1)**k - (-1)**k * (k+1)*(k+2)*Delta_S2((k+1)/2)/2) + (2*S1(k+2) - 1/(k+1)/(k+2))*(1 + (-1) - (-1) * (j+1)*(j+2)*Delta_S2((j+1)/2)/2) + np.pi**2 / 3 - 7/3 + ((-1)**k * Script_S3(k+1) + (-1)**k * Delta_S2((k+1)/2) / 2 / (k+1) / (k+2) - S3(k+1) + zeta(3) - ((k+1)*(k+2)-1)/2/(k+1)**2/(k+2)**2)*2*(k+1)*(k+2) + ((-1) * Script_S3(j+1) + (-1) * Delta_S2((j+1)/2) / 2 / (j+1) / (j+2) - S3(j+1) + zeta(3) - ((j+1)*(j+2)-1)/2/(j+1)**2/(j+2)**2)*2*(j+1)*(j+2) - 2*(1+(-1)**k)*((k+1)*(k+2)+1)/(k+1)**2/(k+2)**2 - 2*(1+(-1))*((j+1)*(j+2)+1)/(j+1)**2/(j+2)**2 - 2*(-1)**(1+k)/(j+1)/(j+2)/(k+1)/(k+2) + 2*(j-k)*(j+k+3)*(S3(j+1) - zeta(3) + (-1)**k *(k+1)*DDelta_S2((j+1)/2,(k+1)/2)/2 - lsum(j,k)) + 2*(k-j)*(j+k+3)*(-1) * (Script_S3(j+1) - S1(k+1)*Delta_S2((j+1)/2)/2 - lsumrev(j,k)) + ((-1)**k *(k+1)*(k+2)/2)*sum((-1)**b * (2*k + 3*b) * (4 + 3*b*(3-b) + 2*k*b + 2*(k+1)**2)*DDelta_S2((j+1)/2,(k+b)/2)/(3 + (-1)**b)/(2*k + 3) for b in range(3)) - ((-1) * (k+1)*(k+2) / 2)*sum((2*k + 3*b) * (4 + 3*b*(3-b) + 2*k*b + 2*(k+1)**2)*DDelta_S2((j+1)/2,(k+b)/2)/(3 + (-1)**b)/(2*k + 3) for b in range(3)) + ((-1)**k *((j+1)*(j+2) - 1)*((k+1)*(k+2)*Delta_S2((k+1)/2) - 2)/2/(j+1)/(j+2)) - 2*(-1)**k / (j+1) / (j+2) / (k+1) / (k+2) - ((k+1)**2 + 2 +(j+1)*(j+2)/(k+1)/(k+2))*((-1) * Delta_S2((j+1)/2)/2) - ((-1) * (k+1) * Delta_S2((k+1)/2) / 2) + ((-1))/(k+1)/(k+2)</span>
    
   <span class="c1"># CQBeta = np.log(Q**2/mures)/4 - S1(j+1) - S1(k+1) -5/6 + 1/2/(j+1)/(j+2) + 1/2/(k+1)/(k+2)</span>
   
    <span class="n">ptyk</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">sgntr</span> <span class="o">=</span> <span class="mi">1</span>
        
    <span class="n">MCQ1CF</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">mufact2</span><span class="p">)</span><span class="o">-</span><span class="mi">23</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">3.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span>
             <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">3.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
             <span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="mf">4.</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="o">-</span>
             <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>
             <span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">-</span><span class="mf">0.</span><span class="o">+</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="mf">0.5</span> <span class="o">*</span> \
             <span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span>
             <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">-</span><span class="mf">0.</span><span class="o">+</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span>
             <span class="mf">3.</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="mf">4.</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span>

    <span class="n">MCQ1BET0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">mures2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">6</span><span class="o">+</span><span class="mf">0.5</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="mf">0.5</span><span class="o">/</span><span class="p">((</span>
               <span class="mi">1</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="mf">0.</span><span class="o">-</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span>

    <span class="n">SUMA</span> <span class="o">=</span> <span class="mi">0</span><span class="n">j</span>
    <span class="n">SUMB</span> <span class="o">=</span> <span class="mi">0</span><span class="n">j</span>

    <span class="k">for</span> <span class="n">LI</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">SUMANDB</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.125</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">LI</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span>
           <span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">LI</span><span class="p">)</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">LI</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">LI</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">LI</span><span class="p">))</span>
        <span class="n">SUMB</span> <span class="o">+=</span> <span class="n">SUMANDB</span>
        <span class="n">SUMA</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">LI</span> <span class="o">*</span> <span class="n">SUMANDB</span>

    <span class="n">DELc1aGJK</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">ptyk</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="mf">0.5</span>
       <span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span> <span class="o">-</span>
       <span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))))</span><span class="o">*</span><span class="n">ptyk</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span>
       <span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="mf">0.25</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span>
       <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span>
       <span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">4.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span>
       <span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">-</span><span class="p">(</span><span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span>
       <span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))))</span><span class="o">/</span><span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
       <span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span> <span class="o">-</span>
       <span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span>
       <span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">-</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">4.</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">4.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span>
       <span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))))</span><span class="o">*</span><span class="n">ptyk</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">SUMA</span><span class="o">-</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">S3</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span>
       <span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mf">0.125</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span>
       <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">ptyk</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span>
       <span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">-</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span>

    <span class="n">DELc1bGKJ</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">-</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span>
       <span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span>
       <span class="n">j</span><span class="p">)))</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">-</span><span class="p">(</span><span class="mf">0.125</span>
       <span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">4.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span> <span class="o">-</span>
       <span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))))</span> \
       <span class="o">/</span> <span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">-</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>
          <span class="p">(</span><span class="mf">0.25</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span>
       <span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span> <span class="o">+</span>
       <span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span>
       <span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))))</span><span class="o">/</span><span class="p">((</span><span class="mf">0.5</span>
       <span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">-</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">4.</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">))))</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span>
       <span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">SUMB</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span>
       <span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)))</span><span class="o">+</span><span class="n">SB3</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">))</span>

    <span class="n">MCQ1CG</span> <span class="o">=</span> <span class="mf">0.9565348003631189</span><span class="o">+</span><span class="n">DELc1aGJK</span><span class="o">-</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
       <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">sgntr</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">DELc1bGKJ</span><span class="o">*</span><span class="n">sgntr</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span>
       <span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">sgntr</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span>
       <span class="p">)</span><span class="o">*</span><span class="n">sgntr</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))))</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">sgntr</span><span class="o">*</span><span class="n">ptyk</span><span class="p">)</span><span class="o">/</span><span class="p">(</span>
               <span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">-</span><span class="p">(</span>
               <span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span>
       <span class="n">ptyk</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)))</span> <span class="o">+</span>
       <span class="mi">2</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ptyk</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">ptyk</span><span class="p">)</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>
       <span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sgntr</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span>
       <span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">))))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">S3</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="n">sgntr</span><span class="o">*</span><span class="n">SB3</span><span class="p">(</span>
       <span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">))</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span> <span class="o">+</span>
       <span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">S3</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span>
           <span class="n">S2</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">ptyk</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">+</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="n">ptyk</span><span class="o">*</span><span class="n">SB3</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">))</span>

    <span class="n">CQNS</span> <span class="o">=</span> <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">CF</span> <span class="o">*</span> <span class="n">MCQ1CF</span> <span class="o">+</span> <span class="p">(</span><span class="n">CF</span> <span class="o">-</span> <span class="n">NC</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">MCQ1CG</span> <span class="o">+</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span> <span class="o">*</span> <span class="n">MCQ1BET0</span><span class="p">)</span>
    
    <span class="n">CQPS</span> <span class="o">=</span> <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">mufact2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">j</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">j</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">deldelS2</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">deldelS2</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
    
    <span class="n">CGNC</span> <span class="o">=</span>  <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">mufact2</span><span class="p">)</span> <span class="o">+</span> <span class="n">S1</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">12</span><span class="o">/</span><span class="n">j</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">S1</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span> <span class="o">/</span> <span class="n">j</span> <span class="o">/</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">delS2</span><span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">8</span> <span class="o">-</span> <span class="n">delS2</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">delS2</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">deldelS2</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">deldelS2</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="n">CGCF</span> <span class="o">=</span> <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">muphi2</span><span class="p">)</span> <span class="o">+</span> <span class="n">S1</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">S1</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">mufact2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="p">(</span><span class="mi">35</span> <span class="o">-</span> <span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">delS2</span><span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span> <span class="o">+</span> <span class="p">(((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">S1</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">delS2</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">deldelS2</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">deldelS2</span><span class="p">((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="c1"># Without sea quarks</span>
    <span class="c1">#return np.array([0*j, 0*j, 0*j, 0*j, 3 * 2 * 2 ** (1+j) * gamma(5/2+j) / (j + 3) / (gamma(3/2) * gamma(3+j)) * (NC*CGNC + CF*CGCF)],dtype=complex) #+ beta0(nf)*np.log(mufacf/mures)</span>
    
    <span class="c1"># With sea quarks A factor of 3 coming from the asymptotic DA. The factors for S/G can be found in eq. (22b) of 2310.13837</span>
    <span class="n">CWT</span><span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> \
                       <span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">CQNS</span><span class="o">/</span><span class="n">nf</span> <span class="o">+</span> <span class="n">CQPS</span><span class="p">)</span> <span class="o">*</span> <span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> \
                       <span class="mi">2</span> <span class="o">/</span> <span class="n">CF</span> <span class="o">/</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span>  <span class="n">WilsonCoef</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">NC</span><span class="o">*</span><span class="n">CGNC</span> <span class="o">+</span> <span class="n">CF</span><span class="o">*</span><span class="n">CGCF</span> <span class="o">+</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mufact2</span><span class="o">/</span><span class="n">mures2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="c1">#+ beta0(nf)*np.log(mufact/mures)</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    if(meson == 1):</span>
<span class="sd">        return np.einsum(&#39;j, j...-&gt;j...&#39;, TFF_rho_trans, CWT)                </span>
<span class="sd">    if(meson== 2):</span>
<span class="sd">        return np.einsum(&#39;j, j...-&gt;j...&#39;, TFF_phi_trans, CWT)                </span>
<span class="sd">    if(meson == 3):</span>
<span class="sd">        return np.einsum(&#39;j, j...-&gt;j...&#39;, TFF_jpsi_trans, CWT)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Only sea quark implemented, not apply to rho production.</span>
    <span class="k">if</span><span class="p">(</span><span class="n">meson</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">CWT</span> <span class="o">*</span> <span class="n">f_jpsi</span>  <span class="o">*</span> <span class="n">CF</span><span class="o">/</span><span class="n">NC</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span></div>


<div class="viewcode-block" id="np_cache">
<a class="viewcode-back" href="../Evolution.html#Evolution.np_cache">[docs]</a>
<span class="k">def</span> <span class="nf">np_cache</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
    <span class="nd">@functools</span><span class="o">.</span><span class="n">cache</span>
    <span class="k">def</span> <span class="nf">cached_wrapper</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">):</span>
        <span class="p">[</span><span class="n">arr</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">meson</span><span class="p">,</span> <span class="n">muset</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">meson</span><span class="p">,</span> <span class="n">muset</span><span class="p">)</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">meson</span><span class="p">,</span> <span class="n">muset</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cached_wrapper</span><span class="p">(</span><span class="nb">tuple</span><span class="p">((</span><span class="nb">tuple</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">meson</span><span class="p">,</span> <span class="n">muset</span><span class="p">)))</span>

    <span class="c1"># copy lru_cache attributes over too</span>
    <span class="n">wrapper</span><span class="o">.</span><span class="n">cache_info</span> <span class="o">=</span> <span class="n">cached_wrapper</span><span class="o">.</span><span class="n">cache_info</span>
    <span class="n">wrapper</span><span class="o">.</span><span class="n">cache_clear</span> <span class="o">=</span> <span class="n">cached_wrapper</span><span class="o">.</span><span class="n">cache_clear</span>

    <span class="k">return</span> <span class="n">wrapper</span></div>


<div class="viewcode-block" id="np_cache_moment">
<a class="viewcode-back" href="../Evolution.html#Evolution.np_cache_moment">[docs]</a>
<span class="k">def</span> <span class="nf">np_cache_moment</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">totuple</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">totuple</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
    
    <span class="nd">@functools</span><span class="o">.</span><span class="n">cache</span>
    <span class="k">def</span> <span class="nf">cached_wrapper</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">):</span>
        <span class="p">[</span><span class="n">arr</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">momshift</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">tupled_arr</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span><span class="n">Para</span><span class="p">,</span> <span class="n">momshift</span><span class="p">)</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span><span class="n">Para</span><span class="p">,</span> <span class="n">momshift</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cached_wrapper</span><span class="p">(</span><span class="nb">tuple</span><span class="p">((</span><span class="nb">tuple</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="n">totuple</span><span class="p">(</span><span class="n">Para</span><span class="p">),</span> <span class="n">momshift</span><span class="p">)))</span>

    <span class="c1"># copy lru_cache attributes over too</span>
    <span class="n">wrapper</span><span class="o">.</span><span class="n">cache_info</span> <span class="o">=</span> <span class="n">cached_wrapper</span><span class="o">.</span><span class="n">cache_info</span>
    <span class="n">wrapper</span><span class="o">.</span><span class="n">cache_clear</span> <span class="o">=</span> <span class="n">cached_wrapper</span><span class="o">.</span><span class="n">cache_clear</span>

    <span class="k">return</span> <span class="n">wrapper</span></div>

    
<div class="viewcode-block" id="Moment_Evo_LO">
<a class="viewcode-back" href="../Evolution.html#Evolution.Moment_Evo_LO">[docs]</a>
<span class="k">def</span> <span class="nf">Moment_Evo_LO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Leading order evolution of moments in the flavor space </span>

<span class="sd">    Args:</span>
<span class="sd">        j: conformal spin j (conformal spin is actually j+2 but anyway): shape (N,)</span>
<span class="sd">        nf: number of effective fermions, scalar</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et), scalars</span>
<span class="sd">        mu: final evolution scale: array(N,), scalar</span>
<span class="sd">        ConfFlav: uneolved conformal moments in flavor space ConfFlav = [ConfMoment_uV, ConfMoment_ubar, ConfMoment_dV, ConfMoment_dbar, ConfMoment_g] shape (N,5)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Evolved conformal moments in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g)</span>
<span class="sd">        return shape (N, 5)</span>
<span class="sd">        </span>
<span class="sd">    | The j here accept array input and preferrably just 1D for the contour integral in j. </span>
<span class="sd">    | Therefore, j has shape (N,) where N is the interpolating order of the fixed quad.</span>
<span class="sd">    | Other quantities must be broadcastable with j and thus they should be preferrably scalar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">j</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Check dimension of j, must be 1D array&quot;</span> <span class="c1"># shape (N,)</span>
    
    <span class="c1"># flavor_trans (5, 5) ConfFlav (N, 5)</span>

    <span class="c1"># Transform the unevolved moments to evolution basis</span>
    <span class="c1"># ConfEvoBasis = np.einsum(&#39;...j,j&#39;, flav_trans, ConfFlav) # originally, output will be (5), I want it to be (N, 5)</span>
    <span class="n">ConfEvoBasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij, ...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">flav_trans</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">)</span> <span class="c1"># shape (N, 5)</span>

    <span class="c1"># Taking the non-singlet and singlet parts of the conformal moments</span>
    <span class="n">ConfNS</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># (N, 3)</span>
    <span class="n">ConfS</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># (N, 2)</span>

    <span class="c1"># Calling evolution mulitiplier</span>
    <span class="p">[</span><span class="n">evons</span><span class="p">,</span> <span class="n">evoa</span><span class="p">]</span> <span class="o">=</span> <span class="n">evolop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span> <span class="c1"># (N) and (N, 2, 2)</span>

    <span class="c1"># non-singlet part evolves multiplicatively</span>
    <span class="n">EvoConfNS</span> <span class="o">=</span> <span class="n">evons</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">ConfNS</span> <span class="c1"># (N, 3)</span>
    <span class="c1"># singlet part mixes with the gluon</span>
    <span class="n">EvoConfS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij, ...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">evoa</span><span class="p">,</span> <span class="n">ConfS</span><span class="p">)</span> <span class="c1"># (N, 2)</span>

    <span class="c1"># Recombing the non-singlet and singlet parts</span>
    <span class="n">EvoConf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">EvoConfNS</span><span class="p">,</span> <span class="n">EvoConfS</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (N, 5)</span>
        
    <span class="k">return</span> <span class="n">EvoConf</span></div>


<div class="viewcode-block" id="CFF_Evo_LO">
<a class="viewcode-back" href="../Evolution.html#Evolution.CFF_Evo_LO">[docs]</a>
<span class="k">def</span> <span class="nf">CFF_Evo_LO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Leading order evolution of the combination of DVCS Wilson coefficient and conformal moments</span>

<span class="sd">    Args:</span>
<span class="sd">        j: conformal spin j (conformal spin is actually j+2 but anyway): array (N,)</span>
<span class="sd">        nf: number of effective fermions; scalar</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et); scalars</span>
<span class="sd">        mu: final evolution scale; scalar</span>
<span class="sd">        ConfFlav: uneolved conformal moments in flavor space ConfFlav = [ConfMoment_uV, ConfMoment_ubar, ConfMoment_dV, ConfMoment_dbar, ConfMoment_g]; shape (N,5)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Evolved conformal moments times the DVCS Wilson coefficients in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g);</span>
<span class="sd">        ingredients for the Mellin-Barnes integral for CFF </span>
<span class="sd">        return shape (N, 5)</span>
<span class="sd">        </span>
<span class="sd">    | The j here accept array input and preferrably just 1D for the contour integral in j. </span>
<span class="sd">    | Therefore, j has shape (N,) where N is the interpolating order of the fixed quad.</span>
<span class="sd">    | Other quantities must be broadcastable with j and thus they should be preferrably scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">j</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Check dimension of j, must be 1D array&quot;</span> <span class="c1"># shape (N,)</span>
    <span class="c1"># flavor_trans (5, 5) ConfFlav (N, 5)</span>

    <span class="c1"># Transform the unevolved moments to evolution basis</span>
    <span class="c1"># ConfEvoBasis = np.einsum(&#39;...j,j&#39;, flav_trans, ConfFlav) # originally, output will be (5), I want it to be (N, 5)</span>
    <span class="n">ConfEvoBasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij, ...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">flav_trans</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">)</span> <span class="c1"># shape (N, 5)</span>

    <span class="c1"># Taking the non-singlet and singlet parts of the conformal moments</span>
    <span class="n">ConfNS</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># (N, 3)</span>
    <span class="n">ConfS</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># (N, 2)</span>
    
    <span class="c1"># Calling evolution mulitiplier</span>
    <span class="p">[</span><span class="n">evons</span><span class="p">,</span> <span class="n">evoa</span><span class="p">]</span> <span class="o">=</span> <span class="n">evolop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span> <span class="c1"># (N) and (N, 2, 2)</span>
    
    <span class="c1"># Combine with the corresponding wilson coefficient in the evolution basis</span>
    <span class="n">EvoWCNS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i...,...-&gt;...i&#39;</span><span class="p">,</span> <span class="n">WilsonCoef_DVCS_LO</span><span class="p">(</span><span class="n">j</span><span class="p">)[:</span><span class="mi">3</span><span class="p">,</span><span class="o">...</span><span class="p">],</span> <span class="n">evons</span><span class="p">)</span> <span class="c1"># shape (3,N), (N) -&gt; (N,3)</span>
    <span class="n">EvoWCS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ik,kij-&gt;kij&#39;</span><span class="p">,</span> <span class="n">WilsonCoef_DVCS_LO</span><span class="p">(</span><span class="n">j</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:,</span><span class="o">...</span><span class="p">],</span> <span class="n">evoa</span><span class="p">)</span> <span class="c1"># Shape (2, N), (N,2,2) -&gt;(N,2,2)</span>
  
    <span class="c1"># Non-singlet part evolves multiplicatively</span>
    <span class="n">EvoConfNS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...j,...j-&gt;...j&#39;</span><span class="p">,</span><span class="n">EvoWCNS</span><span class="p">,</span> <span class="n">ConfNS</span><span class="p">)</span>
    <span class="c1"># Singlet part mixes with the gluon</span>
    <span class="n">EvoConfS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kij,kj-&gt;ki&#39;</span><span class="p">,</span> <span class="n">EvoWCS</span><span class="p">,</span> <span class="n">ConfS</span><span class="p">)</span>
    
    <span class="c1"># Recombing the non-singlet and singlet parts</span>
    <span class="n">EvoConf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">EvoConfNS</span><span class="p">,</span><span class="n">EvoConfS</span><span class="p">),</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">EvoConf</span></div>


<div class="viewcode-block" id="TFF_Evo_LO">
<a class="viewcode-back" href="../Evolution.html#Evolution.TFF_Evo_LO">[docs]</a>
<span class="k">def</span> <span class="nf">TFF_Evo_LO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">meson</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Leading order evolution of the combination of DVMP Wilson coefficient and conformal moments</span>

<span class="sd">    Args:</span>
<span class="sd">        j: conformal spin j (conformal spin is actually j+2 but anyway): array (N,)</span>
<span class="sd">        nf: number of effective fermions; scalar</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et); scalar</span>
<span class="sd">        mu: final evolution scale; scalar</span>
<span class="sd">        ConfFlav: uneolved conformal moments in flavor space ConfFlav = [ConfMoment_uV, ConfMoment_ubar, ConfMoment_dV, ConfMoment_dbar, ConfMoment_g]; shape (N,5)</span>
<span class="sd">        meson (int): 1 for rho, 2 for phi, 3 for Jpsi</span>

<span class="sd">    Returns:</span>
<span class="sd">        Evolved conformal moments times the DVMP Wilson coefficients in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g);</span>
<span class="sd">        Ingredients for the Mellin-Barnes integral for TFF </span>
<span class="sd">        return shape (N, 5)</span>
<span class="sd">        </span>
<span class="sd">    | The j here accept array input and preferrably just 1D for the contour integral in j. </span>
<span class="sd">    | Therefore, j has shape (N,) where N is the interpolating order of the fixed quad.</span>
<span class="sd">    | Other quantities must be broadcastable with j and thus they should be preferrably scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">assert</span> <span class="n">j</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Check dimension of j, must be 1D array&quot;</span> <span class="c1"># shape (N,)</span>
    
    <span class="c1"># flavor_trans (5, 5) ConfFlav (N, 5)</span>
    <span class="c1"># Transform the unevolved moments to evolution basis</span>
    <span class="n">ConfEvoBasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij, ...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">flav_trans</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">)</span> <span class="c1"># shape (N, 5)</span>

    <span class="c1"># Taking the non-singlet and singlet parts of the conformal moments</span>
    <span class="n">ConfNS</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># (N, 3)</span>
    <span class="n">ConfS</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># (N, 2)</span>

    <span class="c1"># Calling evolution mulitiplier</span>
    <span class="p">[</span><span class="n">evons</span><span class="p">,</span> <span class="n">evoa</span><span class="p">]</span> <span class="o">=</span> <span class="n">evolop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span> <span class="c1"># (N) and (N, 2, 2)</span>
    
    <span class="c1"># Combine with the corresponding wilson coefficient in the evolution basis</span>
    <span class="n">EvoWCNS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i...,...-&gt;...i&#39;</span><span class="p">,</span><span class="n">WilsonCoef_DVMP_LO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">nf</span><span class="p">,</span> <span class="n">meson</span><span class="p">)[:</span><span class="mi">3</span><span class="p">,</span><span class="o">...</span><span class="p">],</span><span class="n">evons</span><span class="p">)</span>
    <span class="n">EvoWCS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ik,kij-&gt;kij&#39;</span><span class="p">,</span> <span class="n">WilsonCoef_DVMP_LO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">nf</span><span class="p">,</span> <span class="n">meson</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:,</span><span class="o">...</span><span class="p">],</span> <span class="n">evoa</span><span class="p">)</span>

    <span class="c1"># Non-singlet part evolves multiplicatively</span>
    <span class="n">EvoConfNS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...j,...j-&gt;...j&#39;</span><span class="p">,</span><span class="n">EvoWCNS</span><span class="p">,</span> <span class="n">ConfNS</span><span class="p">)</span>
    <span class="c1"># Singlet part mixes with the gluon</span>
    <span class="n">EvoConfS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kij,kj-&gt;ki&#39;</span><span class="p">,</span> <span class="n">EvoWCS</span><span class="p">,</span> <span class="n">ConfS</span><span class="p">)</span>
    
    <span class="c1"># Recombing the non-singlet and singlet parts</span>
    <span class="n">EvoConf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">EvoConfNS</span><span class="p">,</span><span class="n">EvoConfS</span><span class="p">),</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">EvoConf</span></div>


<div class="viewcode-block" id="WCoef_Evo_NLO">
<a class="viewcode-back" href="../Evolution.html#Evolution.WCoef_Evo_NLO">[docs]</a>
<span class="nd">@np_cache</span>
<span class="k">def</span> <span class="nf">WCoef_Evo_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">meson</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">muf</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Next-to-leading order evolution of the DVMP Wilson coefficient (Evolved Wilson coefficient method)</span>

<span class="sd">    Args:</span>
<span class="sd">        j: conformal spin j (conformal spin is actually j+2 but anyway): array (N,)</span>
<span class="sd">        nf: number of effective fermions; scalars</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et); scalars</span>
<span class="sd">        Q (float): photon virtuality. At NLO the scale Q enters the amplitudes through logs.</span>
<span class="sd">        ConfFlav: uneolved conformal moments in flavor space ConfFlav = [ConfMoment_uV, ConfMoment_ubar, ConfMoment_dV, ConfMoment_dbar, ConfMoment_g]; shape (N,5)</span>
<span class="sd">        meson (int): 1 for rho, 2 for phi, 3 for Jpsi</span>
<span class="sd">        muf: factorization evolution scale; scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Evolved DVMP Wilson coefficients in the evolution basis;</span>
<span class="sd">        CWilsonT_ev_NS_tot: Non-singlet evolved Wilson coefficient with shape (N,3)</span>
<span class="sd">        CWilsonT_ev_SG_tot Singlet/Gluon evolved Wilson coefficient with shape (N,2)</span>

<span class="sd">    | The j here accept array input and preferrably just 1D for the contour integral in j. </span>
<span class="sd">    | Therefore, j has shape (N,) where N is the interpolating order of the fixed quad.</span>
<span class="sd">    | Other quantities must be broadcastable with j and thus they should be preferrably scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">assert</span> <span class="n">j</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Check dimension of j, must be 1D array&quot;</span> <span class="c1"># shape (N,)</span>
    
    <span class="c1"># Separate out NS and S/G Wilson coefficients</span>
    <span class="n">CWNS</span> <span class="o">=</span> <span class="n">WilsonCoef_DVMP_LO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">meson</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">CWSG</span> <span class="o">=</span> <span class="n">WilsonCoef_DVMP_LO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">meson</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
     
    <span class="c1">#Set up evolution operator for WCs</span>
    <span class="n">Alphafact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">muf</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">muf</span><span class="p">)</span><span class="o">/</span><span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="c1"># shape N</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>

    <span class="n">b0</span> <span class="o">=</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span>
    <span class="n">lam</span><span class="p">,</span> <span class="n">pr</span> <span class="o">=</span> <span class="n">projectors</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">pproj</span> <span class="o">=</span> <span class="n">amuindep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
     
    <span class="n">rmu1</span> <span class="o">=</span> <span class="n">rmudep</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">muf</span><span class="p">)</span>
    <span class="n">Rfact</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">lam</span><span class="o">/</span><span class="n">b0</span><span class="p">)</span>  <span class="c1"># LO evolution (alpha(mu)/alpha(mu0))^(-gamma/beta0)</span>

    <span class="c1"># S/G LO evolution operator</span>
    <span class="n">evola0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...aij,...a-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">pr</span><span class="p">,</span> <span class="n">Rfact</span><span class="p">)</span>
    <span class="c1"># NS LO evolution operator</span>
    <span class="n">gam0NS</span> <span class="o">=</span> <span class="n">non_singlet_LO</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">evola0NS</span> <span class="o">=</span> <span class="n">R</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">gam0NS</span><span class="o">/</span><span class="n">b0</span><span class="p">)</span>
    
    <span class="c1"># LO evolved singlet and non-singlet WCs</span>
    <span class="n">CWNS_ev0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...,i...-&gt;...i&#39;</span><span class="p">,</span><span class="n">evola0NS</span><span class="p">,</span><span class="n">CWNS</span><span class="p">)</span>
    <span class="n">CWSG_ev0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,i...-&gt;...ij&#39;</span><span class="p">,</span><span class="n">evola0</span><span class="p">,</span><span class="n">CWSG</span><span class="p">)</span>
    
    <span class="c1"># S/G diagonal NLO evolution operator     </span>
    <span class="n">evola1_diag_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kab,kabij-&gt;kabij&#39;</span><span class="p">,</span> <span class="n">rmu1</span><span class="p">,</span> <span class="n">pproj</span><span class="p">)</span>
    <span class="n">evola1_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...abij,...b,...-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">evola1_diag_ab</span><span class="p">,</span> <span class="n">Rfact</span><span class="p">,</span><span class="n">Alphafact</span><span class="p">)</span>

    <span class="c1"># NLO NS evolutioon set to zero</span>
    <span class="n">CWNS_ev1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">CWNS_ev0</span><span class="p">)</span>
    <span class="c1"># S/G diagonal NLO evolution operator</span>
    <span class="n">CWSG_ev1_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,i...-&gt;...ij&#39;</span><span class="p">,</span><span class="n">evola1_diag</span><span class="p">,</span><span class="n">CWSG</span><span class="p">)</span>
        
    <span class="c1"># Following are the second integral resumming the off diagonal pieces, note that (j,k) meshgrid is used for vectorized j and k input. Check the paper for expression</span>
    <span class="n">reK</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.8</span>
    <span class="n">Max_imK</span> <span class="o">=</span> <span class="mi">150</span>
     
    <span class="k">def</span> <span class="nf">non_diag_integrand_mesh</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        
        <span class="n">jmesh</span><span class="p">,</span> <span class="n">kmesh</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>        
        <span class="n">meshshape</span><span class="o">=</span><span class="n">jmesh</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">jmesh</span><span class="o">=</span><span class="n">jmesh</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">kmesh</span><span class="o">=</span><span class="n">kmesh</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">CWk</span> <span class="o">=</span> <span class="n">WilsonCoef_DVMP_LO</span><span class="p">(</span><span class="n">jmesh</span><span class="o">+</span><span class="n">kmesh</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">meson</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>        
        <span class="n">Bjk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bmudep</span><span class="p">(</span><span class="n">muf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">jmesh</span><span class="o">+</span><span class="n">kmesh</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">jmesh</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">),</span> <span class="n">nf</span><span class="p">,</span><span class="n">p</span><span class="p">))</span><span class="o">*</span><span class="n">Alphafact</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,...-&gt;...ij&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,i...-&gt;...ij&#39;</span><span class="p">,</span><span class="n">Bjk</span><span class="p">,</span><span class="n">CWk</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kmesh</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>  

        <span class="n">outorishape</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">meshshape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">meshshape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">*</span><span class="n">outorishape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="k">return</span> <span class="n">out</span>
    
    <span class="n">intd_non_diag_ev1_vec</span><span class="o">=</span><span class="n">fixed_quadvec</span><span class="p">(</span><span class="k">lambda</span> <span class="n">imK</span><span class="p">:</span><span class="n">non_diag_integrand_mesh</span><span class="p">(</span><span class="n">reK</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">imK</span><span class="p">)</span><span class="o">+</span><span class="n">non_diag_integrand_mesh</span><span class="p">(</span><span class="n">reK</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">imK</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">Max_imK</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
    
    <span class="c1"># Off-diagonal piece for the NS evolution</span>
    <span class="n">CWSG_ev1_non_diag</span> <span class="o">=</span> <span class="n">intd_non_diag_ev1_vec</span>     
    <span class="c1"># Combine the diagonal and off-diagonal pieces</span>
    <span class="n">CWSG_ev1</span> <span class="o">=</span> <span class="n">CWSG_ev1_diag</span> <span class="o">+</span> <span class="n">CWSG_ev1_non_diag</span>
     
    <span class="c1"># NLO Wilson coefficient combined with leading-order evolved conformal moment</span>
    <span class="n">CWilsonT_1_SG</span> <span class="o">=</span> <span class="n">WilsonCoef_DVMP_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">nf</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span> <span class="n">muf</span><span class="p">,</span> <span class="n">meson</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>     
    <span class="n">CWilsonT_1_SG_ev0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i...,...ij-&gt;...ij&#39;</span><span class="p">,</span><span class="n">CWilsonT_1_SG</span><span class="p">,</span><span class="n">evola0</span><span class="p">)</span>
     
    <span class="c1"># LO plus NLO evolution    </span>
    <span class="n">CWilsonT_ev_NS_tot</span> <span class="o">=</span> <span class="n">CWNS_ev0</span> <span class="o">+</span> <span class="n">CWNS_ev1</span>
    <span class="n">CWilsonT_ev_SG_tot</span> <span class="o">=</span> <span class="n">CWSG_ev0</span> <span class="o">+</span> <span class="n">CWSG_ev1</span> <span class="o">+</span> <span class="n">CWilsonT_1_SG_ev0</span>
    
    <span class="k">return</span> <span class="n">CWilsonT_ev_NS_tot</span><span class="p">,</span> <span class="n">CWilsonT_ev_SG_tot</span></div>


<div class="viewcode-block" id="TFF_Evo_NLO_evWC">
<a class="viewcode-back" href="../Evolution.html#Evolution.TFF_Evo_NLO_evWC">[docs]</a>
<span class="k">def</span> <span class="nf">TFF_Evo_NLO_evWC</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">meson</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">muf</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Next-to-leading order evolved DVMP Wilson coefficients in the flavor space combined with the conformal moments (Evolved Wilson coefficient method)</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        j: conformal spin j (conformal spin is actually j+2 but anyway): array (N,)</span>
<span class="sd">        nf: number of effective fermions; scalars</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et); scalars</span>
<span class="sd">        Q (float): photon virtuality. At NLO the scale Q enters the amplitudes through logs.</span>
<span class="sd">        ConfFlav: uneolved conformal moments in flavor space ConfFlav = [ConfMoment_uV, ConfMoment_ubar, ConfMoment_dV, ConfMoment_dbar, ConfMoment_g]; shape (N,5)</span>
<span class="sd">        meson (int): 1 for rho, 2 for phi, 3 for Jpsi</span>
<span class="sd">        muf: factorization evolution scale; scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Evolved conformal moments times the DVMP Wilson coefficients in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g);</span>
<span class="sd">        Ingredients for the Mellin-Barnes integral for TFF </span>
<span class="sd">        return shape (N, 5)</span>
<span class="sd">        </span>
<span class="sd">    | The j here accept array input and preferrably just 1D for the contour integral in j. </span>
<span class="sd">    | Therefore, j has shape (N,) where N is the interpolating order of the fixed quad.</span>
<span class="sd">    | Other quantities must be broadcastable with j and thus they should be preferrably scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">assert</span> <span class="n">j</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Check dimension of j, must be 1D array&quot;</span> <span class="c1"># shape (N,)</span>
    
    <span class="c1"># Retrive the evolved Wilson coefficient from WCoef_Evo_NLO()</span>
    <span class="p">[</span><span class="n">CWilsonT_ev_NS_tot</span><span class="p">,</span> <span class="n">CWilsonT_ev_SG_tot</span><span class="p">]</span> <span class="o">=</span> <span class="n">WCoef_Evo_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">meson</span><span class="p">,</span> <span class="n">muf</span><span class="p">)</span>

    <span class="c1"># Transform the unevolved moments to evolution basis</span>
    <span class="n">ConfEvoBasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij, ...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">flav_trans</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">)</span> <span class="c1"># shape (N, 5)   </span>
    
    <span class="c1"># Taking the non-singlet and singlet parts of the conformal moments</span>
    <span class="n">ConfNS</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># (N, 3)</span>
    <span class="n">ConfSG</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># (N, 2)</span>
    
    <span class="c1"># Combine the evolved Wilson coefficient with conformal moments</span>
    <span class="n">EvoConfNS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...j,...j-&gt;...j&#39;</span><span class="p">,</span> <span class="n">CWilsonT_ev_NS_tot</span><span class="p">,</span> <span class="n">ConfNS</span><span class="p">)</span>
    <span class="n">EvoConfSG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">CWilsonT_ev_SG_tot</span><span class="p">,</span> <span class="n">ConfSG</span><span class="p">)</span>

    <span class="c1"># Recombing the non-singlet and singlet parts</span>
    <span class="n">EvoConf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">EvoConfNS</span><span class="p">,</span> <span class="n">EvoConfSG</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (N, 5)</span>
    
    <span class="k">return</span> <span class="n">EvoConf</span></div>


<span class="c1"># Turn off the cache to reduce hashing time if only one evolved moment is calculated for a set of parameters at a given kinematics. Otherwise cache it.</span>
<div class="viewcode-block" id="Moment_Evo_NLO">
<a class="viewcode-back" href="../Evolution.html#Evolution.Moment_Evo_NLO">[docs]</a>
<span class="nd">@np_cache_moment</span>
<span class="k">def</span> <span class="nf">Moment_Evo_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Para</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">momshift</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Next-to-leading order evolution of the conformal moments (Evolved moment method)</span>

<span class="sd">    Args:</span>
<span class="sd">        j: conformal spin j (conformal spin is actually j+2 but anyway): array (N,)</span>
<span class="sd">        nf: number of effective fermions; scalars</span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et); scalars</span>
<span class="sd">        mu: factorization evolution scale; scalar</span>
<span class="sd">        t: momentum transfer squared</span>
<span class="sd">        xi: skewness</span>
<span class="sd">        Para: parameters of the conformal moments</span>
<span class="sd">        momshift: shift of moments</span>
<span class="sd">        </span>
<span class="sd">        Note: xi,t are need when for the evolution of moments:</span>
<span class="sd">            We need Para for the parameters rather than just the unevolved moment ConFlav;</span>
<span class="sd">            Because the off-diagonal terms requires shift of moments.</span>
<span class="sd">            </span>
<span class="sd">        momshift (CAUTION!):</span>
<span class="sd">            When we shift the moment by j -&gt; j+2 for xi^2 terms, only the evolution kernel E_{jk} should be shifted into E_{j+2,k+2}, whereas terms like xi^{-j-1} should not be shifted</span>
<span class="sd">            therefore, we should write the expression as E_{j,k+momshift} and x^{-j+momshift-1} to compensate/cancel the shift of j when j-&gt;j+2 is performed (momshift=2 in this case)</span>
<span class="sd">            Only relevant in the off-diagonal part</span>

<span class="sd">    Returns:</span>
<span class="sd">        Evolved conformal moment in evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g);</span>
<span class="sd">        To be combined with the corresponding Wilson coefficient (for TFF/CFF) or conformal wave function (for GPD)</span>
<span class="sd">        return shape (N, 5)</span>
<span class="sd">        </span>
<span class="sd">    | The j here accept array input and preferrably just 1D for the contour integral in j. </span>
<span class="sd">    | Therefore, j has shape (N,) where N is the interpolating order of the fixed quad.</span>
<span class="sd">    | Other quantities must be broadcastable with j and thus they should be preferrably scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">assert</span> <span class="n">j</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Check dimension of j, must be 1D array&quot;</span> <span class="c1"># shape (N,)</span>
    
    <span class="n">ConfFlav</span>     <span class="o">=</span> <span class="n">Moment_Sum</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">momshift</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Para</span><span class="p">)</span>
    <span class="c1"># Transform the unevolved moments to evolution basis</span>
    <span class="n">ConfEvoBasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij, ...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">flav_trans</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">)</span> <span class="c1"># shape (N, 5)</span>
    <span class="c1"># Taking the non-singlet and singlet parts of the conformal moments</span>
    <span class="n">ConfNS</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># (N, 3)</span>
    <span class="n">ConfSG</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># (N, 2)</span>
   
    <span class="c1"># Set up evolution operator for WCs</span>
    <span class="n">Alphafact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">mu</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="c1"># shape N</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
  
    <span class="n">b0</span> <span class="o">=</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span>
    <span class="n">lam</span><span class="p">,</span> <span class="n">pr</span> <span class="o">=</span> <span class="n">projectors</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">pproj</span> <span class="o">=</span> <span class="n">amuindep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    
    <span class="n">rmu1</span> <span class="o">=</span> <span class="n">rmudep</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>

    <span class="n">Rfact</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">lam</span><span class="o">/</span><span class="n">b0</span><span class="p">)</span>  <span class="c1"># LO evolution (alpha(mu)/alpha(mu0))^(-gamma/beta0)</span>

    <span class="c1"># S/G LO evolution operator</span>
    <span class="n">evola0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...aij,...a-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">pr</span><span class="p">,</span> <span class="n">Rfact</span><span class="p">)</span>
    
    <span class="c1"># NS LO evolution operator</span>
    <span class="n">gam0NS</span> <span class="o">=</span> <span class="n">non_singlet_LO</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">evola0NS</span> <span class="o">=</span> <span class="n">R</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">gam0NS</span><span class="o">/</span><span class="n">b0</span><span class="p">)</span>
    
    <span class="c1"># LO evolved moments</span>
    <span class="n">confNS_ev0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...,...i-&gt;...i&#39;</span><span class="p">,</span><span class="n">evola0NS</span><span class="p">,</span> <span class="n">ConfNS</span><span class="p">)</span>
    <span class="n">confSG_ev0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,...j-&gt;...i&#39;</span><span class="p">,</span><span class="n">evola0</span><span class="p">,</span><span class="n">ConfSG</span><span class="p">)</span> 
    
    <span class="c1"># S/G diagonal NLO evolution operator    </span>
    <span class="n">evola1_diag_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kab,kabij-&gt;kabij&#39;</span><span class="p">,</span> <span class="n">rmu1</span><span class="p">,</span> <span class="n">pproj</span><span class="p">)</span>
    <span class="n">evola1_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...abij,...b,...-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">evola1_diag_ab</span><span class="p">,</span> <span class="n">Rfact</span><span class="p">,</span><span class="n">Alphafact</span><span class="p">)</span>
    
    <span class="c1"># NLO NS evolutioon set to zero</span>
    <span class="n">confNS_ev1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">confNS_ev0</span><span class="p">)</span>
    <span class="c1"># S/G diagonal NLO evolution operator    </span>
    <span class="n">confSG_ev1_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,...j-&gt;...i&#39;</span><span class="p">,</span><span class="n">evola1_diag</span><span class="p">,</span><span class="n">ConfSG</span><span class="p">)</span>
    
    <span class="c1"># Following are the second integral resumming the off diagonal pieces, note that (j,k) meshgrid is used for vectorized j and k input. Check the paper for expression</span>
    <span class="n">reK</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.6</span>
    <span class="n">Max_imK</span> <span class="o">=</span> <span class="mi">150</span>
        
    <span class="k">def</span> <span class="nf">non_diag_integrand_mesh</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        
        <span class="n">jmesh</span><span class="p">,</span> <span class="n">kmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
        <span class="n">meshshape</span><span class="o">=</span><span class="n">jmesh</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">jmesh</span><span class="o">=</span><span class="n">jmesh</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">kmesh</span><span class="o">=</span><span class="n">kmesh</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">ConfFlavk</span>     <span class="o">=</span> <span class="n">Moment_Sum</span><span class="p">(</span><span class="n">kmesh</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Para</span><span class="p">)</span>
        <span class="n">ConfEvoBasisk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij, ...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">flav_trans</span><span class="p">,</span> <span class="n">ConfFlavk</span><span class="p">)</span>

        <span class="n">ConfSGk</span> <span class="o">=</span> <span class="n">ConfEvoBasisk</span><span class="p">[:,</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">ConfFlav_shift</span> <span class="o">=</span> <span class="n">Moment_Sum</span><span class="p">(</span><span class="n">jmesh</span><span class="o">+</span><span class="n">kmesh</span><span class="o">-</span><span class="n">momshift</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Para</span><span class="p">)</span>
        
        <span class="n">ConfEvoBasis_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij, ...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">flav_trans</span><span class="p">,</span> <span class="n">ConfFlav_shift</span><span class="p">)</span> 
        <span class="n">ConfSG_shift</span> <span class="o">=</span> <span class="n">ConfEvoBasis_shift</span><span class="p">[:,</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
        
        <span class="n">Bjk</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bmudep</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">jmesh</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kmesh</span><span class="o">+</span><span class="n">momshift</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">nf</span><span class="p">,</span><span class="n">p</span><span class="p">))</span><span class="o">*</span><span class="n">Alphafact</span>
        <span class="n">Bjk_shift</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bmudep</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">jmesh</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">jmesh</span><span class="o">+</span><span class="n">kmesh</span><span class="p">),</span> <span class="n">nf</span><span class="p">,</span><span class="n">p</span><span class="p">))</span><span class="o">*</span><span class="n">Alphafact</span>
        
        <span class="n">CBjk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,bij,bj-&gt;bi&#39;</span><span class="p">,</span><span class="n">xi</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">kmesh</span><span class="p">),</span><span class="n">Bjk_shift</span><span class="p">,</span><span class="n">ConfSG_shift</span><span class="p">)</span>
        <span class="n">CBjk_shift</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,bij,bj-&gt;bi&#39;</span><span class="p">,</span><span class="n">xi</span><span class="o">**</span><span class="p">(</span><span class="n">jmesh</span><span class="o">-</span><span class="n">momshift</span><span class="o">-</span><span class="n">kmesh</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Bjk</span><span class="p">,</span><span class="n">ConfSGk</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,i-&gt;ij&#39;</span><span class="p">,</span><span class="n">CBjk</span><span class="o">-</span><span class="n">CBjk_shift</span><span class="p">,</span>  <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kmesh</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,i-&gt;ij&#39;</span><span class="p">,</span><span class="n">CBjk</span><span class="p">,</span>  <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kmesh</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,i-&gt;ij&#39;</span><span class="p">,</span><span class="n">CBjk_shift</span><span class="p">,</span>  <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kmesh</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        
        <span class="n">outorishape</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">meshshape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">meshshape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">*</span><span class="n">outorishape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">out</span>        
        
    <span class="n">intd_non_diag_ev1_vec</span><span class="o">=</span><span class="n">fixed_quadvec</span><span class="p">(</span><span class="k">lambda</span> <span class="n">imK</span><span class="p">:</span><span class="n">non_diag_integrand_mesh</span><span class="p">(</span><span class="n">reK</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">imK</span><span class="p">)</span><span class="o">+</span><span class="n">non_diag_integrand_mesh</span><span class="p">(</span><span class="n">reK</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">imK</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">Max_imK</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="c1"># Off-diagonal piece for the NS evolution</span>
    <span class="n">confSG_ev1_non_diag</span> <span class="o">=</span> <span class="n">intd_non_diag_ev1_vec</span>
    <span class="c1"># Combine the diagonal and off-diagonal pieces</span>
    <span class="n">confSG_ev1</span> <span class="o">=</span> <span class="n">confSG_ev1_diag</span> <span class="o">+</span> <span class="n">confSG_ev1_non_diag</span>     
    
    <span class="c1"># LO plus NLO evolution    </span>
    <span class="n">conf_ev_NS_tot</span> <span class="o">=</span> <span class="n">confNS_ev0</span> <span class="o">+</span> <span class="n">confNS_ev1</span>
    <span class="n">conf_ev_SG_tot</span> <span class="o">=</span> <span class="n">confSG_ev0</span> <span class="o">+</span> <span class="n">confSG_ev1</span>

    <span class="k">return</span> <span class="n">conf_ev_NS_tot</span><span class="p">,</span> <span class="n">conf_ev_SG_tot</span><span class="p">,</span> <span class="n">confSG_ev0</span></div>


<div class="viewcode-block" id="TFF_Evo_NLO_evMOM">
<a class="viewcode-back" href="../Evolution.html#Evolution.TFF_Evo_NLO_evMOM">[docs]</a>
<span class="k">def</span> <span class="nf">TFF_Evo_NLO_evMOM</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Para</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">momshift</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">meson</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">muf</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Next-to-leading order evolved conformal moments combined with the DVMP Wilson coefficients in the evolution space (Evolved moment method)</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        j: conformal spin j (conformal spin is actually j+2 but anyway): array (N,)</span>
<span class="sd">        nf: number of effective fermions; </span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et): scalar</span>
<span class="sd">        Q: final evolution scale: scalar</span>
<span class="sd">        t: momentum transfer squared</span>
<span class="sd">        xi: skewness</span>
<span class="sd">        ConfFlav: unevolved conformal moments</span>
<span class="sd">        Para: parameters of the conformal moments</span>
<span class="sd">        momshift: shift of moments</span>
<span class="sd">        muset: offset in the scale mu to study the scale dependence of the TFF</span>
<span class="sd">        More notes in Moment_Evo_NLO() function above</span>

<span class="sd">    Returns:</span>
<span class="sd">        Next-to-leading order evolved conformal moments combined with the DVMP Wilson coefficients in the evolution basis (qVal, q_du_plus, q_du_minus, qSigma, g);</span>
<span class="sd">        return shape (N, 5)</span>
<span class="sd">    </span>
<span class="sd">    | The j here accept array input and preferrably just 1D for the contour integral in j. </span>
<span class="sd">    | Therefore, j has shape (N,) where N is the interpolating order of the fixed quad.</span>
<span class="sd">    | Other quantities must be broadcastable with j and thus they should be preferrably scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">assert</span> <span class="n">j</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Check dimension of j, must be 1D array&quot;</span> <span class="c1"># shape (N,)</span>
    
    <span class="c1"># Retrive the evolved moment in the evolution basis</span>
    <span class="n">conf_ev_NS_tot</span><span class="p">,</span> <span class="n">conf_ev_SG_tot</span><span class="p">,</span> <span class="n">confSG_ev0</span> <span class="o">=</span> <span class="n">Moment_Evo_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">muf</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">momshift</span><span class="p">)</span>
    
    <span class="c1"># Leading order non-singlet DVMP Wilson coefficient</span>
    <span class="n">NSCoef_0</span> <span class="o">=</span> <span class="n">WilsonCoef_DVMP_LO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">nf</span><span class="p">,</span> <span class="n">meson</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="c1"># Leading order singlet DVMP Wilson coefficient</span>
    <span class="n">SCoef_0</span> <span class="o">=</span> <span class="n">WilsonCoef_DVMP_LO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">nf</span><span class="p">,</span> <span class="n">meson</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
    <span class="c1"># Next-to-leading order singlet DVMP Wilson coefficient</span>
    <span class="n">SCoef_1</span> <span class="o">=</span> <span class="n">WilsonCoef_DVMP_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">nf</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">muf</span><span class="p">,</span> <span class="n">meson</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
    
    <span class="c1"># Combing the LO Wilson coefficients with corresponding evolved moment</span>
    <span class="n">NS_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i...,...i-&gt;...i&#39;</span><span class="p">,</span><span class="n">NSCoef_0</span><span class="p">,</span><span class="n">conf_ev_NS_tot</span><span class="p">)</span>    
    <span class="n">Sev1_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i...,...i-&gt;...i&#39;</span><span class="p">,</span><span class="n">SCoef_0</span><span class="p">,</span><span class="n">conf_ev_SG_tot</span><span class="p">)</span>    
    <span class="c1"># NLO Wilson coefficient with LO evolved moment</span>
    <span class="n">Sev0_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i...,...i-&gt;...i&#39;</span><span class="p">,</span><span class="n">SCoef_1</span><span class="p">,</span><span class="n">confSG_ev0</span><span class="p">)</span>    
    <span class="c1"># Combine two singlet terms</span>
    <span class="n">S_full</span> <span class="o">=</span> <span class="n">Sev1_full</span> <span class="o">+</span> <span class="n">Sev0_full</span>
    
    <span class="c1"># Recombing the non-singlet and singlet parts</span>
    <span class="n">EvoConf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">NS_full</span><span class="p">,</span> <span class="n">S_full</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (N, 5)    </span>

    <span class="k">return</span> <span class="n">EvoConf</span></div>


<span class="sd">&#39;&#39;&#39;***********************************************&#39;&#39;&#39;</span>

<div class="viewcode-block" id="GPD_Moment_Evo_NLO">
<a class="viewcode-back" href="../Evolution.html#Evolution.GPD_Moment_Evo_NLO">[docs]</a>
<span class="k">def</span> <span class="nf">GPD_Moment_Evo_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">xi</span><span class="p">:</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">Para</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">momshift</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Next-to-leading order evolved conformal moments in the evolution basis (Evolved moment method)</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        j: conformal spin j (conformal spin is actually j+2 but anyway): array (N,)</span>
<span class="sd">        nf: number of effective fermions; </span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et): scalar</span>
<span class="sd">        Q: final evolution scale: scalar</span>
<span class="sd">        t: momentum transfer squared</span>
<span class="sd">        xi: skewness</span>
<span class="sd">        ConfFlav: unevolved conformal moments</span>
<span class="sd">        Para: parameters of the conformal moments</span>
<span class="sd">        momshift: shift of moments</span>
<span class="sd">        muset: offset in the scale mu to study the scale dependence of the TFF</span>
<span class="sd">        More notes in Moment_Evo_NLO() function above</span>

<span class="sd">    Returns:</span>
<span class="sd">        Next-to-leading order evolved conformal moments in the evolution basis (to be combined with conformal wave function)</span>
<span class="sd">        return shape (N, 5)</span>
<span class="sd">    </span>
<span class="sd">    | The j here accept array input and preferrably just 1D for the contour integral in j. </span>
<span class="sd">    | Therefore, j has shape (N,) where N is the interpolating order of the fixed quad.</span>
<span class="sd">    | Other quantities must be broadcastable with j and thus they should be preferrably scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">assert</span> <span class="n">j</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Check dimension of j, must be 1D array&quot;</span> <span class="c1"># shape (N,)</span>
    
    <span class="c1"># Retrive the evolved moment in evolution basis (the last term redundant here)</span>
    <span class="n">conf_ev_NS_tot</span><span class="p">,</span> <span class="n">conf_ev_SG_tot</span><span class="p">,</span> <span class="n">confSG_ev0</span> <span class="o">=</span> <span class="n">Moment_Evo_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">momshift</span><span class="p">)</span>
    
    <span class="c1"># Recombing the non-singlet and singlet parts</span>
    <span class="n">EvoConf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">conf_ev_NS_tot</span><span class="p">,</span> <span class="n">conf_ev_SG_tot</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (N, 5)</span>

    <span class="k">return</span> <span class="n">EvoConf</span></div>


<div class="viewcode-block" id="tPDF_Moment_Evo_NLO">
<a class="viewcode-back" href="../Evolution.html#Evolution.tPDF_Moment_Evo_NLO">[docs]</a>
<span class="k">def</span> <span class="nf">tPDF_Moment_Evo_NLO</span><span class="p">(</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;FORWARD Next-to-leading order evolved conformal moments in the evolution basis (Evolved moment method)    </span>
<span class="sd">    </span>
<span class="sd">    This function removes the off-diagonal pieces in Moment_Evo_NLO()</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        j: conformal spin j (conformal spin is actually j+2 but anyway): array (N,)</span>
<span class="sd">        nf: number of effective fermions; </span>
<span class="sd">        p (int): 1 for vector-like GPD (Ht, Et), -1 for axial-vector-like GPDs (Ht, Et): scalar</span>
<span class="sd">        mu: final evolution scale: scalar</span>
<span class="sd">        ConfFlav: unevolved conformal moments</span>

<span class="sd">    Returns:</span>
<span class="sd">        Next-to-leading order evolved conformal moments in the evolution basis in the forward limit (to be combined with inverse Mellin transform wave function)</span>
<span class="sd">        return shape (N, 5)</span>
<span class="sd">        </span>
<span class="sd">    | The j here accept array input and preferrably just 1D for the contour integral in j. </span>
<span class="sd">    | Therefore, j has shape (N,) where N is the interpolating order of the fixed quad.</span>
<span class="sd">    | Other quantities must be broadcastable with j and thus they should be preferrably scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">assert</span> <span class="n">j</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Check dimension of j, must be 1D array&quot;</span> <span class="c1"># shape (N,)</span>
    
    <span class="c1"># Transform the unevolved moments to evolution basis</span>
    <span class="n">ConfEvoBasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij, ...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">flav_trans</span><span class="p">,</span> <span class="n">ConfFlav</span><span class="p">)</span> <span class="c1"># shape (N, 5)</span>
    <span class="c1"># Taking the non-singlet and singlet parts of the conformal moments</span>
    <span class="n">ConfNS</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># (N, 3)</span>
    <span class="n">ConfSG</span> <span class="o">=</span> <span class="n">ConfEvoBasis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># (N, 2)</span>
   
    <span class="c1"># Set up evolution operator for WCs</span>
    <span class="n">Alphafact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">mu</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">AlphaS</span><span class="p">(</span><span class="n">nloop_alphaS</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">Init_Scale_Q</span><span class="p">)</span> <span class="c1"># shape N</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
  
    <span class="n">b0</span> <span class="o">=</span> <span class="n">beta0</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span>
    <span class="n">lam</span><span class="p">,</span> <span class="n">pr</span> <span class="o">=</span> <span class="n">projectors</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">pproj</span> <span class="o">=</span> <span class="n">amuindep</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    
    <span class="n">rmu1</span> <span class="o">=</span> <span class="n">rmudep</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>

    <span class="n">Rfact</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">lam</span><span class="o">/</span><span class="n">b0</span><span class="p">)</span>  <span class="c1"># LO evolution (alpha(mu)/alpha(mu0))^(-gamma/beta0)</span>

    <span class="c1"># S/G LO evolution operator</span>
    <span class="n">evola0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...aij,...a-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">pr</span><span class="p">,</span> <span class="n">Rfact</span><span class="p">)</span>
    
    <span class="c1"># NS LO evolution operator</span>
    <span class="n">gam0NS</span> <span class="o">=</span> <span class="n">non_singlet_LO</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">evola0NS</span> <span class="o">=</span> <span class="n">R</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">gam0NS</span><span class="o">/</span><span class="n">b0</span><span class="p">)</span>
    
    <span class="c1"># LO evolved moments</span>
    <span class="n">confNS_ev0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...,...i-&gt;...i&#39;</span><span class="p">,</span><span class="n">evola0NS</span><span class="p">,</span> <span class="n">ConfNS</span><span class="p">)</span>
    <span class="n">confSG_ev0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,...j-&gt;...i&#39;</span><span class="p">,</span><span class="n">evola0</span><span class="p">,</span><span class="n">ConfSG</span><span class="p">)</span> 
    
    <span class="c1"># S/G diagonal NLO evolution operator    </span>
    <span class="n">evola1_diag_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kab,kabij-&gt;kabij&#39;</span><span class="p">,</span> <span class="n">rmu1</span><span class="p">,</span> <span class="n">pproj</span><span class="p">)</span>
    <span class="n">evola1_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...abij,...b,...-&gt;...ij&#39;</span><span class="p">,</span> <span class="n">evola1_diag_ab</span><span class="p">,</span> <span class="n">Rfact</span><span class="p">,</span><span class="n">Alphafact</span><span class="p">)</span>
    
    <span class="c1"># NLO NS evolutioon set to zero</span>
    <span class="n">confNS_ev1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">confNS_ev0</span><span class="p">)</span>
    <span class="c1"># S/G diagonal NLO evolution operator    </span>
    <span class="n">confSG_ev1_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,...j-&gt;...i&#39;</span><span class="p">,</span><span class="n">evola1_diag</span><span class="p">,</span><span class="n">ConfSG</span><span class="p">)</span>
    
    <span class="c1"># Combine the diagonal and off-diagonal pieces</span>
    <span class="n">confSG_ev1</span> <span class="o">=</span> <span class="n">confSG_ev1_diag</span>
    
    <span class="c1"># LO plus NLO evolution    </span>
    <span class="n">conf_ev_NS_tot</span> <span class="o">=</span> <span class="n">confNS_ev0</span> <span class="o">+</span> <span class="n">confNS_ev1</span>
    <span class="n">conf_ev_SG_tot</span> <span class="o">=</span> <span class="n">confSG_ev0</span> <span class="o">+</span> <span class="n">confSG_ev1</span>

    <span class="c1"># Recombing the non-singlet and singlet parts</span>
    <span class="n">EvoConf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">conf_ev_NS_tot</span><span class="p">,</span> <span class="n">conf_ev_SG_tot</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (N, 5)    </span>

    <span class="k">return</span> <span class="n">EvoConf</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Yuxun Guo. et. al..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>