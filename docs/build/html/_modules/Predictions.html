<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Predictions &mdash; GUMP GPD Analysis 0.5.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=1dd76d02"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GUMP GPD Analysis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../QuickStart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ParametersIntro.html">Parameters Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ObservablesIntro.html">Observables Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EvolutionIntro.html">Evolution Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MinimizerIntro.html">Minimizer Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DVCSIntro.html">DVCS Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DVMPIntro.html">DVMP Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">List of all modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GUMP GPD Analysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">Predictions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for Predictions</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">Parameters</span> <span class="kn">import</span> <span class="n">ParaManager_Unp</span><span class="p">,</span> <span class="n">ParaManager_Pol</span>
<span class="kn">from</span> <span class="nn">Observables</span> <span class="kn">import</span> <span class="n">GPDobserv</span>
<span class="kn">from</span> <span class="nn">DVCS_xsec</span> <span class="kn">import</span> <span class="n">dsigma_TOT</span><span class="p">,</span> <span class="n">dsigma_DVCS_HERA</span><span class="p">,</span> <span class="n">M</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">csv</span> 
<span class="kn">from</span> <span class="nn">Minimizer</span> <span class="kn">import</span> <span class="n">PDF_theo</span><span class="p">,</span> <span class="n">tPDF_theo</span><span class="p">,</span> <span class="n">GFF_theo</span><span class="p">,</span> <span class="n">CFF_theo</span>
<span class="kn">from</span> <span class="nn">Minimizer</span> <span class="kn">import</span> <span class="n">DVCSxsec_theo</span><span class="p">,</span> <span class="n">DVCSxsec_cost_xBtQ</span><span class="p">,</span> <span class="n">DVCSxsec_HERA_theo</span><span class="p">,</span> <span class="n">DVJpsiPH1xsec_group_data</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">DVMP_xsec</span> <span class="kn">import</span> <span class="n">dsigma_Jpsi_dt</span><span class="p">,</span> <span class="n">M_jpsi</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>


<span class="n">Paralst_Unp</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMP_Params/Para_Unp.csv&#39;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Paralst_Pol</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMP_Params/Para_Pol.csv&#39;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">jpsinorm</span> <span class="o">=</span> <span class="n">Paralst_Unp</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="n">Para_Unp</span> <span class="o">=</span> <span class="n">ParaManager_Unp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Paralst_Unp</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">Para_Pol</span> <span class="o">=</span> <span class="n">ParaManager_Pol</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Paralst_Pol</span><span class="p">))</span>
<span class="n">Para_All</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">Para_Unp</span><span class="p">,</span> <span class="n">Para_Pol</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="PDF_theo_s">
<a class="viewcode-back" href="../Predictions.html#Predictions.PDF_theo_s">[docs]</a>
<span class="k">def</span> <span class="nf">PDF_theo_s</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">flv</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">p_order</span><span class="p">):</span>
    <span class="n">_PDF_theo</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_PDF_theo</span><span class="o">.</span><span class="n">tPDF</span><span class="p">(</span><span class="n">flv</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">p_order</span><span class="p">)</span></div>


<span class="n">tPDF_theo_s</span> <span class="o">=</span> <span class="n">PDF_theo_s</span>

<div class="viewcode-block" id="GPD_theo_s">
<a class="viewcode-back" href="../Predictions.html#Predictions.GPD_theo_s">[docs]</a>
<span class="k">def</span> <span class="nf">GPD_theo_s</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">flv</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">p_order</span><span class="p">):</span>
    <span class="n">_GPD_theo</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_GPD_theo</span><span class="o">.</span><span class="n">GPD</span><span class="p">(</span><span class="n">flv</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">p_order</span><span class="p">)</span></div>


<div class="viewcode-block" id="rratio_theo_s">
<a class="viewcode-back" href="../Predictions.html#Predictions.rratio_theo_s">[docs]</a>
<span class="k">def</span> <span class="nf">rratio_theo_s</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">flv</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">p_order</span><span class="p">):</span>
    <span class="n">_GPD_theo</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_GPD_theo</span><span class="o">.</span><span class="n">GPD</span><span class="p">(</span><span class="n">flv</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">p_order</span><span class="p">)</span><span class="o">/</span><span class="n">_GPD_theo</span><span class="o">.</span><span class="n">tPDF</span><span class="p">(</span><span class="n">flv</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">p_order</span><span class="p">)</span></div>


<div class="viewcode-block" id="HTFF_theo_jpsi">
<a class="viewcode-back" href="../Predictions.html#Predictions.HTFF_theo_jpsi">[docs]</a>
<span class="k">def</span> <span class="nf">HTFF_theo_jpsi</span><span class="p">(</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Para_spe</span><span class="p">,</span> <span class="n">p_order</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">muset</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">flv</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">xB</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xB</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">M_jpsi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">xB</span>
    <span class="n">H_E</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">HTFF_jpsi</span> <span class="o">=</span> <span class="n">H_E</span><span class="o">.</span><span class="n">TFF</span><span class="p">(</span><span class="n">Para_Unp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">muset</span> <span class="o">*</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p_order</span><span class="p">,</span> <span class="n">flv</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">HTFF_jpsi</span></div>


<div class="viewcode-block" id="TFF_theo_jpsi">
<a class="viewcode-back" href="../Predictions.html#Predictions.TFF_theo_jpsi">[docs]</a>
<span class="k">def</span> <span class="nf">TFF_theo_jpsi</span><span class="p">(</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Para_spe</span><span class="p">,</span> <span class="n">p_order</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">muset</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">flv</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">xB</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xB</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">M_jpsi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">xB</span>
    <span class="n">H_E</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">HTFF_jpsi</span> <span class="o">=</span> <span class="n">H_E</span><span class="o">.</span><span class="n">TFF</span><span class="p">(</span><span class="n">Para_Unp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">muset</span> <span class="o">*</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p_order</span><span class="p">,</span> <span class="n">flv</span><span class="p">)</span>
    <span class="n">ETFF_jpsi</span> <span class="o">=</span> <span class="n">H_E</span><span class="o">.</span><span class="n">TFF</span><span class="p">(</span><span class="n">Para_Unp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">muset</span> <span class="o">*</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p_order</span><span class="p">,</span> <span class="n">flv</span><span class="p">)</span>
    
    <span class="k">return</span>  <span class="p">[</span> <span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span> <span class="p">]</span></div>


<div class="viewcode-block" id="DVjpsiPxsec_theo">
<a class="viewcode-back" href="../Predictions.html#Predictions.DVjpsiPxsec_theo">[docs]</a>
<span class="k">def</span> <span class="nf">DVjpsiPxsec_theo</span><span class="p">(</span><span class="n">DVjpsiPxsec_input</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">TFF_jpsi_input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_input</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">xB</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_input</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_input</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_input</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>    
    <span class="p">[</span><span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span><span class="p">]</span> <span class="o">=</span> <span class="n">TFF_jpsi_input</span>
    <span class="k">return</span> <span class="n">dsigma_Jpsi_dt</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span><span class="p">)</span></div>


<div class="viewcode-block" id="DVjpsiPxsec_theo_xBtQ">
<a class="viewcode-back" href="../Predictions.html#Predictions.DVjpsiPxsec_theo_xBtQ">[docs]</a>
<span class="k">def</span> <span class="nf">DVjpsiPxsec_theo_xBtQ</span><span class="p">(</span><span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">xsec_norm</span><span class="p">,</span> <span class="n">p_order</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">muset</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">flv</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">):</span>
    <span class="p">[</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> 
    <span class="p">[</span><span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span><span class="p">]</span> <span class="o">=</span> <span class="n">TFF_theo_jpsi</span><span class="p">(</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">p_order</span><span class="p">,</span> <span class="n">muset</span><span class="p">,</span> <span class="n">flv</span><span class="p">)</span>
    <span class="n">DVjpsiP_pred_xBtQ</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_theo</span><span class="p">(</span><span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">,</span> <span class="n">TFF_jpsi_input</span> <span class="o">=</span> <span class="p">[</span><span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span><span class="p">])</span> <span class="o">*</span> <span class="n">xsec_norm</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">DVjpsiP_pred_xBtQ</span></div>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">def DVjpsiPxsec_theo_scalar(y: float, xB: float, t: float, Q: float, Para_Unp, xsec_norm, p_order = 2, muset = 1, flv = &#39;All&#39;):</span>
<span class="sd">    [HTFF_jpsi, ETFF_jpsi] = TFF_theo_jpsi(xB, t, Q, Para_Unp, p_order, muset, flv)</span>
<span class="sd">    return dsigma_Jpsi_dt(y, xB, t, Q, 0, HTFF_jpsi, ETFF_jpsi)* xsec_norm**2</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">def GFF(j, t, Q, flv, spe):</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    Return Generalized Form Factors</span>

<span class="sd">    Args:</span>
<span class="sd">        j: numpy int array</span>
<span class="sd">        t: numpy float array</span>
<span class="sd">        Q: numpy float array</span>
<span class="sd">        flv: an array of string.</span>
<span class="sd">            flv is the flavor. It can be &#39;u&#39;, &#39;d&#39;, &#39;g&#39;, &#39;NS&#39;, or &#39;S&#39;</span>
<span class="sd">        spe: numpy array of integer</span>
<span class="sd">            spe is the &quot;species.&quot;</span>
<span class="sd">            0 means H</span>
<span class="sd">            1 means E</span>
<span class="sd">            2 means Ht</span>
<span class="sd">            3 means Et</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        _gff: generalized form factors. numpy float array</span>
<span class="sd">    &#39;&#39;&#39;</span>

<span class="sd">    j = np.array(j)</span>
<span class="sd">    t = np.array(t)</span>
<span class="sd">    Q = np.array(Q)</span>
<span class="sd">    flv = np.array(flv)</span>
<span class="sd">    spe = np.array(spe)</span>
<span class="sd">    x = 0</span>
<span class="sd">    xi = 0   </span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    if(spe == 0 or spe == 1):</span>
<span class="sd">        p = 1</span>

<span class="sd">    if(spe == 2 or spe == 3):</span>
<span class="sd">        p = -1</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    p = np.where(spe&lt;=1, 1, -1)</span>
<span class="sd">   </span>

<span class="sd">    Para_spe = Para_All[spe] # fancy indexing. Output (N, 3, 5, 1, 5)</span>
<span class="sd">    _GFF_theo = GPDobserv(x, xi, t, Q, p)</span>
<span class="sd">    _gff = _GFF_theo.GFFj0(j, flv, Para_spe) # (N)</span>
<span class="sd">    </span>
<span class="sd">    return _gff</span>

<span class="sd">def CFF(xB, t, Q):</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    CFF</span>

<span class="sd">    Args</span>
<span class="sd">        xB: numpy float array</span>
<span class="sd">        t: numpy float array</span>
<span class="sd">        Q: numpy float array</span>

<span class="sd">    Returns</span>
<span class="sd">        [ HCFF, ECFF, HtCFF, EtCFF ], each of which is a numpy array</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    xB  = np.array(xB)</span>
<span class="sd">    t   = np.array(t)</span>
<span class="sd">    Q   = np.array(Q)</span>
<span class="sd">    return CFF_theo(xB, t, Q, np.expand_dims(Para_Unp, axis=0), np.expand_dims(Para_Pol, axis=0))</span>

<span class="sd">def DVCSxsec(y, xB, t, Q, phi, pol):</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    DVCS cross section</span>

<span class="sd">    Args</span>
<span class="sd">        y: numpy float array</span>
<span class="sd">        xB: numpy float array</span>
<span class="sd">        t: numpy float array</span>
<span class="sd">        Q: numpy float array</span>
<span class="sd">        phi: numpy float array</span>
<span class="sd">        pol: a numpy array of str</span>
<span class="sd">            pol can be &#39;UU&#39;, &#39;LU&#39;, &#39;UL&#39;, &#39;LL&#39;,</span>
<span class="sd">                &#39;UTin&#39;, &#39;LTin&#39;, &#39;UTout&#39;, or &#39;LTout&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">        The DVCS cross section. Float or numpy array</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    y   = np.array(y)</span>
<span class="sd">    xB  = np.array(xB)</span>
<span class="sd">    t   = np.array(t)</span>
<span class="sd">    Q   = np.array(Q)</span>
<span class="sd">    phi = np.array(phi)</span>
<span class="sd">    pol = np.array(pol)</span>

<span class="sd">    [HCFF, ECFF, HtCFF, EtCFF] = CFF(xB, t, Q)</span>
<span class="sd">    return dsigma_TOT(y, xB, t, Q, phi, pol, HCFF, ECFF, HtCFF, EtCFF)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>
    <span class="n">Para_spe</span> <span class="o">=</span> <span class="n">Para_All</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Test of LO ImCFF and quark GPD evolved to mu =5 GeV</span>
    <span class="n">x</span><span class="o">=</span><span class="mf">0.0001</span>
    <span class="n">_GPD_theo</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_GPD_theo2</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ts</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">CFF</span> <span class="o">=</span> <span class="n">_GPD_theo</span><span class="o">.</span><span class="n">CFF</span><span class="p">(</span><span class="n">Para_spe</span><span class="p">,</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">CFF</span><span class="p">)</span>
    <span class="n">ts</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">gpd1</span> <span class="o">=</span> <span class="p">(</span><span class="n">_GPD_theo</span><span class="o">.</span><span class="n">GPD</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="n">Para_spe</span><span class="p">))</span><span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">gpd2</span> <span class="o">=</span> <span class="p">(</span><span class="n">_GPD_theo2</span><span class="o">.</span><span class="n">GPD</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="n">Para_spe</span><span class="p">))</span><span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">gpd3</span> <span class="o">=</span> <span class="p">(</span><span class="n">_GPD_theo</span><span class="o">.</span><span class="n">GPD</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="n">Para_spe</span><span class="p">))</span><span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">gpd4</span> <span class="o">=</span> <span class="p">(</span><span class="n">_GPD_theo2</span><span class="o">.</span><span class="n">GPD</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="n">Para_spe</span><span class="p">))</span><span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">gpd1</span><span class="o">-</span><span class="n">gpd2</span><span class="o">+</span><span class="n">gpd3</span><span class="o">-</span><span class="n">gpd4</span><span class="p">))</span>

    <span class="c1"># Test of LO ImTFF and gluon GPD evolved to mu = 5 GeV</span>
    <span class="n">x</span><span class="o">=</span><span class="mf">0.0001</span>
    <span class="n">_GPD_theo</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ts</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">TFF</span> <span class="o">=</span> <span class="n">_GPD_theo</span><span class="o">.</span><span class="n">TFF</span><span class="p">(</span><span class="n">Para_spe</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">TFF</span><span class="p">)</span>
    <span class="n">gpd1</span> <span class="o">=</span> <span class="p">(</span><span class="n">_GPD_theo</span><span class="o">.</span><span class="n">GPD</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">Para_spe</span><span class="p">))</span>
    <span class="n">f_jpsi</span><span class="o">=</span> <span class="mf">0.406</span>
    <span class="n">CF</span><span class="o">=</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">NC</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">prefact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">f_jpsi</span> <span class="o">/</span> <span class="n">NC</span> <span class="o">/</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prefact</span><span class="o">*</span><span class="n">gpd1</span><span class="p">)</span>


    <span class="c1"># Test of two methods of calculating TFF evolved to mu =5 GeV</span>
    <span class="n">x</span><span class="o">=</span><span class="mf">0.0001</span>
    <span class="n">_GPD_theo</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">TFF1</span> <span class="o">=</span> <span class="n">_GPD_theo</span><span class="o">.</span><span class="n">TFFNLO</span><span class="p">(</span><span class="n">Para_spe</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">meson</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">flv</span> <span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">TFF1</span><span class="p">)</span>
    <span class="n">TFF2</span> <span class="o">=</span> <span class="n">_GPD_theo</span><span class="o">.</span><span class="n">TFFNLO_evMom</span><span class="p">(</span><span class="n">Para_spe</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">meson</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">flv</span> <span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">TFF2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">TFF2</span><span class="o">-</span><span class="n">TFF1</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Plotting results of the paper</span>
    <span class="c1">#</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    # Comparing PDF with the global extraction of PDF</span>

<span class="sd">    x = np.exp(np.linspace(np.log(0.0001), np.log(0.05), 100, dtype = float))</span>
<span class="sd">    </span>
<span class="sd">    pdflst = np.array([PDF_theo_s(x_i,0.,2.,1,&#39;g&#39;,Para_spe, 2) for x_i in x ])</span>
<span class="sd">    </span>
<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/Smallx_PDF.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([x,pdflst]))</span>
<span class="sd">        </span>
<span class="sd">    # Comparing GPD with the global extraction of PDF</span>

<span class="sd">    ts=time.time()</span>
<span class="sd">    x = np.exp(np.linspace(np.log(0.0014), np.log(0.05), 320, dtype = float))</span>
<span class="sd">    </span>
<span class="sd">    gpdlst = np.array([GPD_theo_s(x_i,0.002,0.,2.,1,&#39;g&#39;,Para_spe, 2) for x_i in x ]).flatten()</span>
<span class="sd">    </span>
<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/Smallx_GPD.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([x,gpdlst]))</span>
<span class="sd">    print(time.time()-ts)</span>

<span class="sd">    # Ploting the R ratio</span>

<span class="sd">    x = np.exp(np.linspace(np.log(0.0001), np.log(0.01), 20, dtype = float))</span>
<span class="sd">    </span>
<span class="sd">    qlst = np.linspace(2,8, 20, dtype = float)</span>
<span class="sd">    </span>
<span class="sd">    xmesh, qmesh = np.meshgrid(x,qlst)</span>
<span class="sd">    </span>
<span class="sd">    xmeshflat = xmesh.flatten()</span>
<span class="sd">    </span>
<span class="sd">    qmeshflat = qmesh.flatten()</span>

<span class="sd">    rrat2dlst = np.array([rratio_theo_s(x_i,0.,q_i,1,&#39;g&#39;,Para_spe, 2) for x_i,q_i in zip(xmeshflat,qmeshflat) ]).flatten()</span>
<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/Rrat2D.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([xmeshflat,qmeshflat,rrat2dlst]))</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    # Comparing the cross-sections</span>
<span class="sd">    </span>
<span class="sd">    DVjpsiPH1_xBtQ_theo = np.array(list(pool.map(partial(DVjpsiPxsec_theo_xBtQ, Para_Unp = Para_Unp, xsec_norm = jpsinorm, p_order = 2, muset = 1, flv = &#39;All&#39;), DVJpsiPH1xsec_group_data))).flatten()</span>

<span class="sd">    DVjpsiPH1_xBtQ_theo_mu_1 = np.array(list(pool.map(partial(DVjpsiPxsec_theo_xBtQ, Para_Unp = Para_Unp, xsec_norm = jpsinorm, p_order = 2, muset = np.sqrt(0.5), flv = &#39;All&#39;), DVJpsiPH1xsec_group_data))).flatten()</span>
<span class="sd">    </span>
<span class="sd">    DVjpsiPH1_xBtQ_theo_mu_2 = np.array(list(pool.map(partial(DVjpsiPxsec_theo_xBtQ, Para_Unp = Para_Unp, xsec_norm = jpsinorm, p_order = 2, muset = np.sqrt(2), flv = &#39;All&#39;), DVJpsiPH1xsec_group_data))).flatten()  </span>
<span class="sd">    </span>
<span class="sd">    DVjpsiPH1_xBtQ_theo_mu_3 = np.array(list(pool.map(partial(DVjpsiPxsec_theo_xBtQ, Para_Unp = Para_Unp, xsec_norm = jpsinorm, p_order = 2, muset = np.sqrt(0.75), flv = &#39;All&#39;), DVJpsiPH1xsec_group_data))).flatten()</span>
<span class="sd">    </span>
<span class="sd">    DVjpsiPH1_xBtQ_theo_mu_4 = np.array(list(pool.map(partial(DVjpsiPxsec_theo_xBtQ, Para_Unp = Para_Unp, xsec_norm = jpsinorm, p_order = 2, muset = np.sqrt(1.5), flv = &#39;All&#39;), DVJpsiPH1xsec_group_data))).flatten()  </span>

<span class="sd">    DVjpsiPH1_xBtQ_theo_mu_5 = np.array(list(pool.map(partial(DVjpsiPxsec_theo_xBtQ, Para_Unp = Para_Unp, xsec_norm = jpsinorm, p_order = 2, muset = np.sqrt(0.9), flv = &#39;All&#39;), DVJpsiPH1xsec_group_data))).flatten()</span>
<span class="sd">    </span>
<span class="sd">    DVjpsiPH1_xBtQ_theo_mu_6 = np.array(list(pool.map(partial(DVjpsiPxsec_theo_xBtQ, Para_Unp = Para_Unp, xsec_norm = jpsinorm, p_order = 2, muset = np.sqrt(1.25), flv = &#39;All&#39;), DVJpsiPH1xsec_group_data))).flatten()  </span>

<span class="sd">    DVJpsiPH1xsec_group_data_shape = np.array(DVJpsiPH1xsec_group_data).shape</span>
<span class="sd">    </span>
<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/dvjpsiph1data.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.array(DVJpsiPH1xsec_group_data).reshape(DVJpsiPH1xsec_group_data_shape[0],-1))</span>
<span class="sd">    </span>
<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/dvjpsiph1theo.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([DVjpsiPH1_xBtQ_theo,DVjpsiPH1_xBtQ_theo_mu_1,DVjpsiPH1_xBtQ_theo_mu_2,DVjpsiPH1_xBtQ_theo_mu_3,DVjpsiPH1_xBtQ_theo_mu_4,DVjpsiPH1_xBtQ_theo_mu_5,DVjpsiPH1_xBtQ_theo_mu_6]))</span>

<span class="sd">    # Decomposing into different orders and flavors</span>
<span class="sd">    # mulst =np.linspace(4,40, 20, dtype = float)</span>
<span class="sd">    qlst = np.linspace(2,20, 60, dtype = float)</span>
<span class="sd">    </span>
<span class="sd">    xb = 0.002</span>
<span class="sd">    </span>
<span class="sd">    TFFq1=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 1, 1, &#39;q&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">    TFFq2=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 2, 1, &#39;q&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">    TFFg1=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 1, 1, &#39;g&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">    TFFg2=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 2, 1, &#39;g&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">    </span>
<span class="sd">    TFFfull=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 2, 1, &#39;All&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">  </span>
<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/TFFqg12xb1.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([qlst,TFFfull,TFFq1,TFFq2,TFFg1,TFFg2]))</span>
<span class="sd">        </span>
<span class="sd">    xb = 0.005</span>
<span class="sd">    </span>
<span class="sd">    TFFq1=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 1, 1, &#39;q&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">    TFFq2=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 2, 1, &#39;q&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">    TFFg1=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 1, 1, &#39;g&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">    TFFg2=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 2, 1, &#39;g&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">    </span>
<span class="sd">    TFFfull=np.array([HTFF_theo_jpsi(xb,-0.05,q_i,Para_spe, 2, 1, &#39;All&#39;) for q_i in qlst ]).flatten()</span>
<span class="sd">  </span>
<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/TFFqg12xb2.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([qlst,TFFfull,TFFq1,TFFq2,TFFg1,TFFg2]))</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    _GPD_theo = GPDobserv(0.1,0.001,-1.0,10.0,1)</span>
<span class="sd">    ts=time.time()</span>
<span class="sd">    _GPD1 = _GPD_theo.TFF(Para_spe, meson = 3, p_order = 2, muset = 1, flv =&#39;All&#39;)</span>
<span class="sd">    print(_GPD1)</span>
<span class="sd">    print(time.time()-ts)</span>
<span class="sd">    ts=time.time()    </span>
<span class="sd">    _GPD2 = _GPD_theo.TFFNLO_evMom(Para_spe, meson = 3, muset = 1, flv =&#39;All&#39;)</span>
<span class="sd">    print(_GPD2)</span>
<span class="sd">    print(time.time()-ts)</span>
<span class="sd">    #ts=time.time()    </span>
<span class="sd">    #_GPD2 = _GPD_theo.TFFNLO_evMom(Para_spe, meson = 3, muset = 1, flv =&#39;All&#39;)</span>
<span class="sd">    #print(_GPD2)</span>
<span class="sd">    #print(time.time()-ts)</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    x = np.exp(np.linspace(np.log(0.005), np.log(0.6), 100, dtype = float))</span>

<span class="sd">    uhPDF = PDF(x,[0.0],[2.0],[&#39;u&#39;],[0])</span>
<span class="sd">    ubarhPDF = -PDF(-x,[0.0],[2.0],[&#39;u&#39;],[0])</span>
<span class="sd">    dhPDF = PDF(x,[0.0],[2.0],[&#39;d&#39;],[0])</span>
<span class="sd">    dbarhPDF = -PDF(-x,[0.0],[2.0],[&#39;d&#39;],[0])</span>

<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/H_PDF.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([x,uhPDF,ubarhPDF,dhPDF,dbarhPDF]))</span>

<span class="sd">    uePDF = PDF(x,[0.0],[2.0],[&#39;u&#39;],[1])</span>
<span class="sd">    ubarePDF = -PDF(-x,[0.0],[2.0],[&#39;u&#39;],[1])</span>
<span class="sd">    dePDF = PDF(x,[0.0],[2.0],[&#39;d&#39;],[1])</span>
<span class="sd">    dbarePDF = -PDF(-x,[0.0],[2.0],[&#39;d&#39;],[1])</span>

<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/E_PDF.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([x,uePDF,ubarePDF,dePDF,dbarePDF]))</span>

<span class="sd">    uhtPDF = PDF(x,[0.0],[2.0],[&#39;u&#39;],[2])</span>
<span class="sd">    ubarhtPDF = PDF(-x,[0.0],[2.0],[&#39;u&#39;],[2])</span>
<span class="sd">    dhtPDF = PDF(x,[0.0],[2.0],[&#39;d&#39;],[2])</span>
<span class="sd">    dbarhtPDF = PDF(-x,[0.0],[2.0],[&#39;d&#39;],[2])</span>

<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/Ht_PDF.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([x,uhtPDF,ubarhtPDF,dhtPDF,dbarhtPDF]))</span>

<span class="sd">    uetPDF = PDF(x,[0.0],[2.0],[&#39;u&#39;],[3])</span>
<span class="sd">    ubaretPDF = PDF(-x,[0.0],[2.0],[&#39;u&#39;],[3])</span>
<span class="sd">    detPDF = PDF(x,[0.0],[2.0],[&#39;d&#39;],[3])</span>
<span class="sd">    dbaretPDF = PDF(-x,[0.0],[2.0],[&#39;d&#39;],[3])</span>
<span class="sd">    </span>
<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/Et_PDF.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([x,uetPDF,ubaretPDF,detPDF,dbaretPDF]))</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    xgpd = np.concatenate((np.linspace(-0.6,-0.33,28,dtype = float),np.linspace(-0.32,0.32,66,dtype = float),np.linspace(0.33,0.6,28,dtype = float)))</span>

<span class="sd">    uhGPD = GPD(xgpd,[0.33],[-0.5],[2.0],[&#39;u&#39;],[0])</span>
<span class="sd">    dhGPD = GPD(xgpd,[0.33],[-0.5],[2.0],[&#39;d&#39;],[0])</span>

<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/H_GPD.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([xgpd,uhGPD,dhGPD]))</span>

<span class="sd">    ueGPD = GPD(xgpd,[0.33],[-0.5],[2.0],[&#39;u&#39;],[1])</span>
<span class="sd">    deGPD = GPD(xgpd,[0.33],[-0.5],[2.0],[&#39;d&#39;],[1])</span>

<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/E_GPD.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([xgpd,ueGPD,deGPD]))</span>

<span class="sd">    uhtGPD = GPD(xgpd,[0.33],[-0.5],[2.0],[&#39;u&#39;],[2])</span>
<span class="sd">    dhtGPD = GPD(xgpd,[0.33],[-0.5],[2.0],[&#39;d&#39;],[2])</span>

<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/Ht_GPD.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([xgpd,uhtGPD,dhtGPD]))</span>

<span class="sd">    uetGPD = GPD(xgpd,[0.33],[-0.5],[2.0],[&#39;u&#39;],[3])</span>
<span class="sd">    detGPD = GPD(xgpd,[0.33],[-0.5],[2.0],[&#39;d&#39;],[3])</span>

<span class="sd">    with open(os.path.join(dir_path,&quot;GUMP_Results/Et_GPD.csv&quot;),&quot;w&quot;,newline=&#39;&#39;) as my_csv:</span>
<span class="sd">        csvWriter = csv.writer(my_csv,delimiter=&#39;,&#39;)</span>
<span class="sd">        csvWriter.writerows(np.transpose([xgpd,uetGPD,detGPD]))</span>
<span class="sd">    &#39;&#39;&#39;</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Yuxun Guo. et. al..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>