<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Minimizer &mdash; GUMP GPD Analysis 0.5.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=1dd76d02"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GUMP GPD Analysis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../QuickStart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ParametersIntro.html">Parameters Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ObservablesIntro.html">Observables Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EvolutionIntro.html">Evolution Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MinimizerIntro.html">Minimizer Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DVCSIntro.html">DVCS Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DVMPIntro.html">DVMP Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">List of all modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GUMP GPD Analysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">Minimizer</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for Minimizer</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">Parameters</span> <span class="kn">import</span> <span class="n">ParaManager_Unp</span><span class="p">,</span> <span class="n">ParaManager_Pol</span>
<span class="kn">from</span> <span class="nn">Observables</span> <span class="kn">import</span> <span class="n">GPDobserv</span>
<span class="kn">from</span> <span class="nn">DVCS_xsec</span> <span class="kn">import</span> <span class="n">dsigma_TOT</span><span class="p">,</span> <span class="n">dsigma_DVCS_HERA</span><span class="p">,</span> <span class="n">M</span>
<span class="kn">from</span> <span class="nn">DVMP_xsec</span> <span class="kn">import</span> <span class="n">dsigma_Jpsi_dt</span><span class="p">,</span><span class="n">dsigma_phi_dt</span><span class="p">,</span><span class="n">dsigma_rho_dt</span><span class="p">,</span> <span class="n">M_jpsi</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">iminuit</span> <span class="kn">import</span> <span class="n">Minuit</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

<span class="n">Minuit_Counter</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">Time_Counter</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">Q_threshold</span> <span class="o">=</span> <span class="mf">1.9</span>

<span class="n">xB_Cut</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">xB_small_Cut</span> <span class="o">=</span> <span class="mf">0.0001</span>

<span class="n">PDF_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/PDFdata.csv&#39;</span><span class="p">),</span>       <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">,</span> <span class="s1">&#39;spe&#39;</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">],</span>        <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span><span class="s1">&#39;spe&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
<span class="n">PDF_data_H</span>  <span class="o">=</span> <span class="n">PDF_data</span><span class="p">[</span><span class="n">PDF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">PDF_data_H_g</span> <span class="o">=</span> <span class="n">PDF_data_H</span><span class="p">[</span><span class="n">PDF_data_H</span><span class="p">[</span><span class="s1">&#39;flv&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">]</span>
<span class="n">PDF_data_H_g</span> <span class="o">=</span> <span class="n">PDF_data_H_g</span><span class="p">[</span><span class="n">PDF_data_H_g</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xB_Cut</span><span class="p">]</span>
<span class="n">PDF_data_E</span>  <span class="o">=</span> <span class="n">PDF_data</span><span class="p">[</span><span class="n">PDF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">PDF_data_Ht</span> <span class="o">=</span> <span class="n">PDF_data</span><span class="p">[</span><span class="n">PDF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">PDF_data_Et</span> <span class="o">=</span> <span class="n">PDF_data</span><span class="p">[</span><span class="n">PDF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">PDF_smallx_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/PDFg_smallx.csv&#39;</span><span class="p">),</span>       <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">,</span> <span class="s1">&#39;spe&#39;</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">],</span>        <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span><span class="s1">&#39;spe&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
<span class="n">PDF_H_smallx_data</span> <span class="o">=</span> <span class="n">PDF_smallx_data</span><span class="p">[</span><span class="n">PDF_smallx_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">PDFg_smallx_data</span> <span class="o">=</span> <span class="n">PDF_H_smallx_data</span><span class="p">[</span><span class="n">PDF_H_smallx_data</span><span class="p">[</span><span class="s1">&#39;flv&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;g&#39;</span><span class="p">]</span>
<span class="n">PDFg_smallx_data</span> <span class="o">=</span> <span class="n">PDF_H_smallx_data</span><span class="p">[</span><span class="n">PDF_H_smallx_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">xB_small_Cut</span><span class="p">]</span>

<span class="n">tPDF_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/tPDFdata.csv&#39;</span><span class="p">),</span>     <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">,</span> <span class="s1">&#39;spe&#39;</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">],</span>        <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span><span class="s1">&#39;spe&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
<span class="n">tPDF_data_H</span>  <span class="o">=</span> <span class="n">tPDF_data</span><span class="p">[</span><span class="n">tPDF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">tPDF_data_H_g</span> <span class="o">=</span> <span class="n">tPDF_data_H</span><span class="p">[</span><span class="n">tPDF_data_H</span><span class="p">[</span><span class="s1">&#39;flv&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">]</span>
<span class="n">tPDF_data_H_g</span> <span class="o">=</span> <span class="n">tPDF_data_H</span><span class="p">[</span><span class="n">tPDF_data_H</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xB_small_Cut</span><span class="p">]</span>
<span class="n">tPDF_data_E</span>  <span class="o">=</span> <span class="n">tPDF_data</span><span class="p">[</span><span class="n">tPDF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">tPDF_data_Ht</span> <span class="o">=</span> <span class="n">tPDF_data</span><span class="p">[</span><span class="n">tPDF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">tPDF_data_Et</span> <span class="o">=</span> <span class="n">tPDF_data</span><span class="p">[</span><span class="n">tPDF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">GFF_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/GFFdata_Quark.csv&#39;</span><span class="p">),</span>       <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">,</span> <span class="s1">&#39;spe&#39;</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">],</span>        <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span><span class="s1">&#39;spe&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
<span class="n">GFF_data_H</span>  <span class="o">=</span> <span class="n">GFF_data</span><span class="p">[</span><span class="n">GFF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">GFF_data_E</span>  <span class="o">=</span> <span class="n">GFF_data</span><span class="p">[</span><span class="n">GFF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">GFF_data_Ht</span> <span class="o">=</span> <span class="n">GFF_data</span><span class="p">[</span><span class="n">GFF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">GFF_data_Et</span> <span class="o">=</span> <span class="n">GFF_data</span><span class="p">[</span><span class="n">GFF_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">GFF_Gluon_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/GFFdata_Gluon.csv&#39;</span><span class="p">),</span>       <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">,</span> <span class="s1">&#39;spe&#39;</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">],</span>        <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span><span class="s1">&#39;spe&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;flv&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
<span class="n">GFF_Gluon_data_H</span>  <span class="o">=</span> <span class="n">GFF_Gluon_data</span><span class="p">[</span><span class="n">GFF_Gluon_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">GFF_Gluon_data_E</span>  <span class="o">=</span> <span class="n">GFF_Gluon_data</span><span class="p">[</span><span class="n">GFF_Gluon_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">GFF_Gluon_data_Ht</span> <span class="o">=</span> <span class="n">GFF_Gluon_data</span><span class="p">[</span><span class="n">GFF_Gluon_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">GFF_Gluon_data_Et</span> <span class="o">=</span> <span class="n">GFF_Gluon_data</span><span class="p">[</span><span class="n">GFF_Gluon_data</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">DVCSxsec_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/DVCSxsec.csv&#39;</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;phi&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">,</span> <span class="s1">&#39;pol&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;phi&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;pol&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
<span class="n">DVCSxsec_data_invalid</span> <span class="o">=</span> <span class="n">DVCSxsec_data</span><span class="p">[</span><span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">M</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">DVCSxsec_data</span> <span class="o">=</span> <span class="n">DVCSxsec_data</span><span class="p">[(</span><span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Q_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xB_Cut</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">M</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">xBtQlst</span> <span class="o">=</span> <span class="n">DVCSxsec_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)[[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">DVCSxsec_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVCSxsec_data</span><span class="p">[(</span><span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVCSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst</span><span class="p">))</span>

<span class="n">DVCSxsec_HERA_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/DVCSxsec_HERA.csv&#39;</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">,</span> <span class="s1">&#39;pol&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;pol&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
<span class="n">DVCSxsec_HERA_data_invalid</span> <span class="o">=</span> <span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">M</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">DVCSxsec_HERA_data</span> <span class="o">=</span> <span class="n">DVCSxsec_HERA_data</span><span class="p">[(</span><span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Q_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">xB_Cut</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">M</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">xBtQlst_HERA</span> <span class="o">=</span> <span class="n">DVCSxsec_HERA_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)[[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">DVCSxsec_HERA_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVCSxsec_HERA_data</span><span class="p">[(</span><span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVCSxsec_HERA_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst_HERA</span><span class="p">))</span>



<span class="c1"># rho and phi data from HERA, R = sigma_L / sigma_T is currently handled on the theory side for these</span>

<span class="n">DVrhoPZEUSxsec_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/DVMP_HERA/DVrhoPZEUSdt.csv&#39;</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">})</span>
<span class="n">DVrhoPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">DVrhoPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">])</span>
<span class="n">DVrhoPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">DVrhoPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="n">DVrhoPZEUSxsec_data</span> <span class="o">=</span> <span class="n">DVrhoPZEUSxsec_data</span><span class="p">[(</span><span class="n">DVrhoPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Q_threshold</span><span class="p">)]</span>
<span class="n">xBtQlst_rhoZ</span> <span class="o">=</span> <span class="n">DVrhoPZEUSxsec_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)[[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">DVrhoPZEUSxsec_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVrhoPZEUSxsec_data</span><span class="p">[(</span><span class="n">DVrhoPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVrhoPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVrhoPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst_rhoZ</span><span class="p">))</span>

<span class="n">DVrhoPH1xsec_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/DVMP_HERA/DVrhoPH1dt.csv&#39;</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">})</span>
<span class="n">DVrhoPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">DVrhoPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">])</span>
<span class="n">DVrhoPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">DVrhoPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="n">DVrhoPH1xsec_data</span> <span class="o">=</span> <span class="n">DVrhoPH1xsec_data</span><span class="p">[(</span><span class="n">DVrhoPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Q_threshold</span><span class="p">)]</span>
<span class="n">xBtQlst_rhoH</span> <span class="o">=</span> <span class="n">DVrhoPH1xsec_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)[[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">DVrhoPH1xsec_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVrhoPH1xsec_data</span><span class="p">[(</span><span class="n">DVrhoPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVrhoPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVrhoPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst_rhoH</span><span class="p">))</span>

<span class="n">DVphiPZEUSxsec_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/DVMP_HERA/DVphiPZEUSdt.csv&#39;</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">})</span>
<span class="n">DVphiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">DVphiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">])</span>
<span class="n">DVphiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">DVphiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="n">DVphiPZEUSxsec_data</span> <span class="o">=</span> <span class="n">DVphiPZEUSxsec_data</span><span class="p">[(</span><span class="n">DVphiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Q_threshold</span><span class="p">)]</span>
<span class="n">xBtQlst_phiZ</span> <span class="o">=</span> <span class="n">DVphiPZEUSxsec_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)[[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">DVphiPZEUSxsec_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVphiPZEUSxsec_data</span><span class="p">[(</span><span class="n">DVphiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVphiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVphiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst_phiZ</span><span class="p">))</span>

<span class="n">DVphiPH1xsec_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/DVMP_HERA/DVphiPH1dt.csv&#39;</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">})</span>
<span class="n">DVphiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">DVphiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">])</span>
<span class="n">DVphiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">DVphiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="n">DVphiPH1xsec_data</span> <span class="o">=</span> <span class="n">DVphiPH1xsec_data</span><span class="p">[(</span><span class="n">DVphiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Q_threshold</span><span class="p">)]</span>
<span class="n">xBtQlst_phiH</span> <span class="o">=</span> <span class="n">DVphiPH1xsec_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)[[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">DVphiPH1xsec_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVphiPH1xsec_data</span><span class="p">[(</span><span class="n">DVphiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVphiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVphiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst_phiH</span><span class="p">))</span>


<span class="c1"># Jpsi data from HERA as well as R = sigma_L / sigma_T values hardcoded and used to convert data xsec simga_tot to sigma_L</span>

<span class="n">DVJpsiPH1xsec_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/DVMP_HERA/DVJpsiPH1dt_w_mass.csv&#39;</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">})</span>
<span class="n">DVJpsiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">DVJpsiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">])</span>
<span class="n">DVJpsiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">DVJpsiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="n">DVJpsiPH1xsec_data</span> <span class="o">=</span> <span class="n">DVJpsiPH1xsec_data</span><span class="p">[(</span><span class="n">DVJpsiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Q_threshold</span><span class="p">)]</span>
<span class="n">xBtQlst_JpsiH</span> <span class="o">=</span> <span class="n">DVJpsiPH1xsec_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)[[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">DVJpsiPH1xsec_L_data</span> <span class="o">=</span> <span class="n">DVJpsiPH1xsec_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">R_H1</span> <span class="o">=</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">R_H1</span><span class="p">[(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.052</span>
<span class="n">R_H1</span><span class="p">[(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.23</span>
<span class="n">R_H1</span><span class="p">[(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.62</span>
<span class="n">R_H1_err</span> <span class="o">=</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">R_H1_err</span><span class="p">[(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.113</span>
<span class="n">R_H1_err</span><span class="p">[(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.27</span>
<span class="n">R_H1_err</span><span class="p">[(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.61</span>
<span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">R_H1</span><span class="p">))</span>
<span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">R_H1</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">R_H1_err</span> <span class="o">*</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">R_H1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">DVJpsiPH1xsec_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVJpsiPH1xsec_data</span><span class="p">[(</span><span class="n">DVJpsiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVJpsiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst_JpsiH</span><span class="p">))</span>
<span class="n">DVJpsiPH1xsec_L_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[(</span><span class="n">DVJpsiPH1xsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVJpsiPH1xsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst_JpsiH</span><span class="p">))</span>

<span class="n">DVJpsiPZEUSxsec_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMPDATA/DVMP_HERA/DVJpsiPZEUSdt_w_mass.csv&#39;</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;xB&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="s1">&#39;delta f&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">})</span>
<span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">])</span>
<span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="n">DVJpsiPZEUSxsec_data</span> <span class="o">=</span> <span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[(</span><span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Q_threshold</span><span class="p">)]</span>
<span class="n">xBtQlst_JpsiZ</span> <span class="o">=</span> <span class="n">DVJpsiPZEUSxsec_data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s1">&#39;first&#39;</span><span class="p">)[[</span><span class="s1">&#39;xB&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">DVJpsiPZEUSxsec_L_data</span> <span class="o">=</span> <span class="n">DVJpsiPZEUSxsec_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">R_ZEUS</span> <span class="o">=</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">R_ZEUS</span><span class="p">[(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.13</span>
<span class="n">R_ZEUS</span><span class="p">[(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.33</span>
<span class="n">R_ZEUS</span><span class="p">[(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.19</span>
<span class="n">R_ZEUS_err</span> <span class="o">=</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">R_ZEUS_err</span><span class="p">[(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.19</span>
<span class="n">R_ZEUS_err</span><span class="p">[(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">R_ZEUS_err</span><span class="p">[(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.58</span>
<span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">R_ZEUS</span><span class="p">))</span>
<span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">R_ZEUS</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">R_ZEUS_err</span> <span class="o">*</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">R_ZEUS</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">DVJpsiPZEUSxsec_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[(</span><span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst_JpsiZ</span><span class="p">))</span>
<span class="n">DVJpsiPZEUSxsec_L_group_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="nb">set</span><span class="p">:</span> <span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[(</span><span class="n">DVJpsiPZEUSxsec_data</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">DVJpsiPZEUSxsec_L_data</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">set</span><span class="p">[</span><span class="mi">2</span><span class="p">]))],</span> <span class="n">xBtQlst_JpsiZ</span><span class="p">))</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">JpsiphotoH1xsec_data = pd.read_csv(os.path.join(dir_path,&#39;GUMPDATA/DVMP_HERA/DVJpsiPZEUSdt_w_mass.csv&#39;), header = None, names = [&#39;y&#39;, &#39;xB&#39;, &#39;t&#39;, &#39;Q&#39;, &#39;f&#39;, &#39;delta f&#39;] , dtype = {&#39;y&#39;: float, &#39;xB&#39;: float, &#39;t&#39;: float, &#39;Q&#39;: float, &#39;f&#39;: float, &#39;delta f&#39;: float})</span>
<span class="sd">JpsiphotoH1xsec_data[&#39;Q&#39;] = np.sqrt(JpsiphotoH1xsec_data[&#39;Q&#39;])</span>
<span class="sd">JpsiphotoH1xsec_data[&#39;t&#39;] = -1 * JpsiphotoH1xsec_data[&#39;t&#39;]</span>
<span class="sd">JpsiphotoH1xsec_data = JpsiphotoH1xsec_data[(JpsiphotoH1xsec_data[&#39;Q&#39;]&gt;Q_threshold)]</span>
<span class="sd">xBtQlst_JpsiphotoH1 = JpsiphotoH1xsec_data.drop_duplicates(subset = [&#39;xB&#39;, &#39;t&#39;, &#39;Q&#39;], keep = &#39;first&#39;)[[&#39;xB&#39;,&#39;t&#39;,&#39;Q&#39;]].values.tolist()</span>
<span class="sd">&#39;&#39;&#39;</span>

<div class="viewcode-block" id="PDF_theo">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.PDF_theo">[docs]</a>
<span class="k">def</span> <span class="nf">PDF_theo</span><span class="p">(</span><span class="n">PDF_input</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Para</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">p_order</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1"># [x, t, Q, f, delta_f, spe, flv] = PDF_input</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">PDF_input</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">PDF_input</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">Qs</span> <span class="o">=</span> <span class="n">PDF_input</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">flvs</span> <span class="o">=</span> <span class="n">PDF_input</span><span class="p">[</span><span class="s1">&#39;flv&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">spes</span> <span class="o">=</span> <span class="n">PDF_input</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
 
    <span class="n">xis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>

    <span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spes</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">spes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spes</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">,</span> <span class="n">spes</span><span class="p">,</span> <span class="n">spes</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">Para_spe</span> <span class="o">=</span> <span class="n">Para</span><span class="p">[</span><span class="n">spes</span><span class="p">]</span> <span class="c1"># fancy indexing. Output (N, 3, 5, 1, 5)</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    if(spe == 0 or spe == 1):</span>
<span class="sd">        spe, p = spe, 1</span>

<span class="sd">    if(spe == 2 or spe == 3):</span>
<span class="sd">        spe, p = spe - 2 , -1</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Para: (4, 2, 5, 1, 4)</span>
    <span class="k">def</span> <span class="nf">PDF_theo_scalar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">flv</span><span class="p">,</span> <span class="n">Para</span><span class="p">):</span>
        <span class="n">_PDF_theo</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_PDF_theo</span><span class="o">.</span><span class="n">tPDF</span><span class="p">(</span><span class="n">flv</span><span class="p">,</span> <span class="n">Para</span><span class="p">,</span> <span class="n">p_order</span><span class="p">)</span>
    
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">PDF_theo_scalar</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="n">xi_i</span><span class="p">,</span> <span class="n">t_i</span><span class="p">,</span> <span class="n">Q_i</span><span class="p">,</span> <span class="n">p_i</span><span class="p">,</span> <span class="n">flv_i</span><span class="p">,</span> <span class="n">Para_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span><span class="p">,</span> <span class="n">xi_i</span><span class="p">,</span> <span class="n">t_i</span><span class="p">,</span> <span class="n">Q_i</span><span class="p">,</span> <span class="n">p_i</span><span class="p">,</span> <span class="n">flv_i</span><span class="p">,</span> <span class="n">Para_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">xis</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">Qs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">flvs</span><span class="p">,</span> <span class="n">Para_spe</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">result</span></div>


<span class="n">tPDF_theo</span> <span class="o">=</span> <span class="n">PDF_theo</span>

<div class="viewcode-block" id="GFF_theo">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.GFF_theo">[docs]</a>
<span class="k">def</span> <span class="nf">GFF_theo</span><span class="p">(</span><span class="n">GFF_input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">Para</span><span class="p">):</span>
    <span class="c1"># [j, t, Q, f, delta_f, spe, flv] = GFF_input</span>
    <span class="n">js</span> <span class="o">=</span> <span class="n">GFF_input</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">GFF_input</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">Qs</span> <span class="o">=</span> <span class="n">GFF_input</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="c1">#fs = GFF_input[&#39;f&#39;].to_numpy()</span>
    <span class="c1">#delta_fs = GFF_input[&#39;delta f&#39;].to_numpy()</span>
    <span class="n">flvs</span> <span class="o">=</span> <span class="n">GFF_input</span><span class="p">[</span><span class="s1">&#39;flv&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">spes</span> <span class="o">=</span> <span class="n">GFF_input</span><span class="p">[</span><span class="s1">&#39;spe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="mi">0</span>   
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    if(spe == 0 or spe == 1):</span>
<span class="sd">        spe, p = spe, 1</span>

<span class="sd">    if(spe == 2 or spe == 3):</span>
<span class="sd">        spe, p = spe - 2 , -1</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spes</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">spes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spes</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">,</span> <span class="n">spes</span><span class="p">,</span> <span class="n">spes</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">Para_spe</span> <span class="o">=</span> <span class="n">Para</span><span class="p">[</span><span class="n">spes</span><span class="p">]</span> <span class="c1"># fancy indexing. Output (N, 3, 5, 1, 5)</span>
    <span class="n">GFF_theo</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">Qs</span><span class="p">,</span> <span class="n">ps</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">GFF_theo</span><span class="o">.</span><span class="n">GFFj0</span><span class="p">(</span><span class="n">js</span><span class="p">,</span> <span class="n">flvs</span><span class="p">,</span> <span class="n">Para_spe</span><span class="p">)</span> <span class="c1"># (N)</span></div>


<div class="viewcode-block" id="CFF_theo">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.CFF_theo">[docs]</a>
<span class="k">def</span> <span class="nf">CFF_theo</span><span class="p">(</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">Para_Pol</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">xB</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xB</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">xB</span>
    <span class="n">H_E</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">Ht_Et</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">HCFF</span> <span class="o">=</span> <span class="n">H_E</span><span class="o">.</span><span class="n">CFF</span><span class="p">(</span><span class="n">Para_Unp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:])</span>
    <span class="n">ECFF</span> <span class="o">=</span> <span class="n">H_E</span><span class="o">.</span><span class="n">CFF</span><span class="p">(</span><span class="n">Para_Unp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:])</span>
    <span class="n">HtCFF</span> <span class="o">=</span> <span class="n">Ht_Et</span><span class="o">.</span><span class="n">CFF</span><span class="p">(</span><span class="n">Para_Pol</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:])</span>
    <span class="n">EtCFF</span> <span class="o">=</span> <span class="n">Ht_Et</span><span class="o">.</span><span class="n">CFF</span><span class="p">(</span><span class="n">Para_Pol</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:])</span>

    <span class="k">return</span> <span class="p">[</span> <span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span> <span class="p">]</span> <span class="c1"># this can be a list of arrays of shape (N)</span></div>

    <span class="c1"># return np.stack([HCFF, ECFF, HtCFF, EtCFF], axis=-1)</span>
    
<div class="viewcode-block" id="CFF_quad_theo">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.CFF_quad_theo">[docs]</a>
<span class="k">def</span> <span class="nf">CFF_quad_theo</span><span class="p">(</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">Para_Pol</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">xB</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xB</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">xB</span>
    <span class="n">H_E</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">Ht_Et</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">HCFF</span> <span class="o">=</span> <span class="n">H_E</span><span class="o">.</span><span class="n">CFF_quad</span><span class="p">(</span><span class="n">Para_Unp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:])</span>
    <span class="n">ECFF</span> <span class="o">=</span> <span class="n">H_E</span><span class="o">.</span><span class="n">CFF_quad</span><span class="p">(</span><span class="n">Para_Unp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:])</span>
    <span class="n">HtCFF</span> <span class="o">=</span> <span class="n">Ht_Et</span><span class="o">.</span><span class="n">CFF_quad</span><span class="p">(</span><span class="n">Para_Pol</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:])</span>
    <span class="n">EtCFF</span> <span class="o">=</span> <span class="n">Ht_Et</span><span class="o">.</span><span class="n">CFF_quad</span><span class="p">(</span><span class="n">Para_Pol</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:])</span>

    <span class="k">return</span> <span class="p">[</span> <span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span> <span class="p">]</span></div>

<span class="sd">&#39;&#39;&#39; </span>
<span class="sd">def TFF_theo_rho(xB, t, Q, Para_Unp):</span>
<span class="sd">    x = 0</span>
<span class="sd">    xi = (1/(2 - xB) - (2*t*(-1 + xB))/(Q**2*(-2 + xB)**2))*xB</span>
<span class="sd">    H_E = GPDobserv(x, xi, t, Q, 1)</span>
<span class="sd">    HTFF_rho = H_E.TFFLO(Para_Unp[..., 0, :, :, :, :],1)</span>
<span class="sd">    ETFF_rho = H_E.TFFLO(Para_Unp[..., 1, :, :, :, :],1)</span>
<span class="sd">    </span>

<span class="sd">    return [ HTFF_rho, ETFF_rho ]</span>

<span class="sd">def TFF_theo_rho_NLO(xB, t, Q, Para_Unp):</span>
<span class="sd">    x = 0</span>
<span class="sd">    xi = (1/(2 - xB) - (2*t*(-1 + xB))/((Q**2 )*(-2 + xB)**2))*xB</span>
<span class="sd">    H_E = GPDobserv(x, xi, t, Q, 1)</span>
<span class="sd">    HTFF_jpsi = H_E.TFF(Para_Unp[..., 0, :, :, :, :],1,2)</span>
<span class="sd">    ETFF_jpsi = H_E.TFF(Para_Unp[..., 1, :, :, :, :],1,2)</span>
<span class="sd">    </span>

<span class="sd">    return  [ HTFF_jpsi, ETFF_jpsi ]</span>

<span class="sd">def TFF_theo_phi(xB, t, Q, Para_Unp):</span>
<span class="sd">    x = 0</span>
<span class="sd">    xi = (1/(2 - xB) - (2*t*(-1 + xB))/(Q**2*(-2 + xB)**2))*xB</span>
<span class="sd">    H_E = GPDobserv(x, xi, t, Q, 1)</span>
<span class="sd">    HTFF_phi = H_E.TFFLO(Para_Unp[..., 0, :, :, :, :],2)</span>
<span class="sd">    ETFF_phi = H_E.TFFLO(Para_Unp[..., 1, :, :, :, :],2)</span>
<span class="sd">    </span>
<span class="sd">    return [ HTFF_phi, ETFF_phi ]</span>
<span class="sd">&#39;&#39;&#39;</span>
<div class="viewcode-block" id="TFF_theo_jpsi">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.TFF_theo_jpsi">[docs]</a>
<span class="k">def</span> <span class="nf">TFF_theo_jpsi</span><span class="p">(</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">p_order</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">muset</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">flv</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">xB</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xB</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">M_jpsi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">xB</span>
    <span class="n">H_E</span> <span class="o">=</span> <span class="n">GPDobserv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">HTFF_jpsi</span> <span class="o">=</span> <span class="n">H_E</span><span class="o">.</span><span class="n">TFF</span><span class="p">(</span><span class="n">Para_Unp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">muset</span> <span class="o">*</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p_order</span><span class="p">,</span> <span class="n">flv</span><span class="p">)</span>
    <span class="n">ETFF_jpsi</span> <span class="o">=</span> <span class="n">H_E</span><span class="o">.</span><span class="n">TFF</span><span class="p">(</span><span class="n">Para_Unp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">muset</span> <span class="o">*</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p_order</span><span class="p">,</span> <span class="n">flv</span><span class="p">)</span>
    
    <span class="k">return</span>  <span class="p">[</span> <span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span> <span class="p">]</span></div>


<div class="viewcode-block" id="DVCSxsec_theo">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.DVCSxsec_theo">[docs]</a>
<span class="k">def</span> <span class="nf">DVCSxsec_theo</span><span class="p">(</span><span class="n">DVCSxsec_input</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">CFF_input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
    <span class="c1"># CFF_input is a list of np.arrays</span>
    <span class="c1"># [y, xB, t, Q, phi, f, delta_f, pol] = DVCSxsec_input    </span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">DVCSxsec_input</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">xB</span> <span class="o">=</span> <span class="n">DVCSxsec_input</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">DVCSxsec_input</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">DVCSxsec_input</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">DVCSxsec_input</span><span class="p">[</span><span class="s1">&#39;phi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="c1">#f = DVCSxsec_input[&#39;f&#39;].to_numpy()</span>
    <span class="n">pol</span> <span class="o">=</span> <span class="n">DVCSxsec_input</span><span class="p">[</span><span class="s1">&#39;pol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

    <span class="p">[</span><span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFF_input</span> <span class="c1"># each of them have shape (N); scalar is also OK if we use </span>
    <span class="k">return</span> <span class="n">dsigma_TOT</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">pol</span><span class="p">,</span> <span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span><span class="p">)</span></div>


<div class="viewcode-block" id="DVCSxsec_cost_xBtQ">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.DVCSxsec_cost_xBtQ">[docs]</a>
<span class="k">def</span> <span class="nf">DVCSxsec_cost_xBtQ</span><span class="p">(</span><span class="n">DVCSxsec_data_xBtQ</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">Para_Pol</span><span class="p">):</span>
    <span class="p">[</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">DVCSxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DVCSxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DVCSxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> 
    <span class="p">[</span><span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFF_theo</span><span class="p">(</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">Para_Pol</span><span class="p">)</span> <span class="c1"># scalar for each of them</span>
    <span class="c1"># DVCS_pred_xBtQ = np.array(list(map(partial(DVCSxsec_theo, CFF_input = [HCFF, ECFF, HtCFF, EtCFF]), np.array(DVCSxsec_data_xBtQ))))</span>
    <span class="n">DVCS_pred_xBtQ</span> <span class="o">=</span> <span class="n">DVCSxsec_theo</span><span class="p">(</span><span class="n">DVCSxsec_data_xBtQ</span><span class="p">,</span> <span class="n">CFF_input</span> <span class="o">=</span> <span class="p">[</span><span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">DVCS_pred_xBtQ</span> <span class="o">-</span> <span class="n">DVCSxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">DVCSxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span></div>


<div class="viewcode-block" id="DVCSxsec_HERA_theo">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.DVCSxsec_HERA_theo">[docs]</a>
<span class="k">def</span> <span class="nf">DVCSxsec_HERA_theo</span><span class="p">(</span><span class="n">DVCSxsec_HERA_input</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">CFF_input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
    <span class="c1">#[y, xB, t, Q, f, delta_f, pol]  = DVCSxsec_data_HERA</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">DVCSxsec_HERA_input</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">xB</span> <span class="o">=</span> <span class="n">DVCSxsec_HERA_input</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">DVCSxsec_HERA_input</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">DVCSxsec_HERA_input</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="c1">#f = DVCSxsec_data_HERA[&#39;f&#39;].to_numpy()</span>
    <span class="c1">#delta_f = DVCSxsec_data_HERA[&#39;delta f&#39;].to_numpy()</span>
    <span class="n">pol</span> <span class="o">=</span> <span class="n">DVCSxsec_HERA_input</span><span class="p">[</span><span class="s1">&#39;pol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

    <span class="p">[</span><span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFF_input</span>
    <span class="k">return</span> <span class="n">dsigma_DVCS_HERA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">pol</span><span class="p">,</span> <span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span><span class="p">)</span></div>


<div class="viewcode-block" id="DVCSxsec_HERA_cost_xBtQ">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.DVCSxsec_HERA_cost_xBtQ">[docs]</a>
<span class="k">def</span> <span class="nf">DVCSxsec_HERA_cost_xBtQ</span><span class="p">(</span><span class="n">DVCSxsec_HERA_data_xBtQ</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">Para_Pol</span><span class="p">):</span>
    <span class="p">[</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">DVCSxsec_HERA_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DVCSxsec_HERA_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DVCSxsec_HERA_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> 
    <span class="p">[</span><span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFF_theo</span><span class="p">(</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">Para_Pol</span><span class="p">)</span> <span class="c1"># scalar for each of them</span>
    <span class="c1"># DVCS_pred_xBtQ = np.array(list(map(partial(DVCSxsec_theo, CFF_input = [HCFF, ECFF, HtCFF, EtCFF]), np.array(DVCSxsec_data_xBtQ))))</span>
    <span class="n">DVCS_HERA_pred_xBtQ</span> <span class="o">=</span> <span class="n">DVCSxsec_HERA_theo</span><span class="p">(</span><span class="n">DVCSxsec_HERA_data_xBtQ</span><span class="p">,</span> <span class="n">CFF_input</span> <span class="o">=</span> <span class="p">[</span><span class="n">HCFF</span><span class="p">,</span> <span class="n">ECFF</span><span class="p">,</span> <span class="n">HtCFF</span><span class="p">,</span> <span class="n">EtCFF</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">DVCS_HERA_pred_xBtQ</span> <span class="o">-</span> <span class="n">DVCSxsec_HERA_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">DVCSxsec_HERA_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span></div>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">def DVrhoPxsec_theo(DVrhoPxsec_input: pd.DataFrame, TFF_rho_input: np.array):</span>
<span class="sd">    y = DVrhoPxsec_input[&#39;y&#39;].to_numpy()</span>
<span class="sd">    xB = DVrhoPxsec_input[&#39;xB&#39;].to_numpy()</span>
<span class="sd">    t = DVrhoPxsec_input[&#39;t&#39;].to_numpy()</span>
<span class="sd">    Q = DVrhoPxsec_input[&#39;Q&#39;].to_numpy()    </span>
<span class="sd">    [HTFF_rho, ETFF_rho] = TFF_rho_input</span>
<span class="sd">    return 2*np.pi*dsigma_rho_dt(y, xB, t, Q, 0, HTFF_rho, ETFF_rho)</span>

<span class="sd">def DVphiPxsec_theo(DVphiPxsec_input: pd.DataFrame, TFF_phi_input: np.array):</span>
<span class="sd">    y = DVphiPxsec_input[&#39;y&#39;].to_numpy()</span>
<span class="sd">    xB = DVphiPxsec_input[&#39;xB&#39;].to_numpy()</span>
<span class="sd">    t = DVphiPxsec_input[&#39;t&#39;].to_numpy()</span>
<span class="sd">    Q = DVphiPxsec_input[&#39;Q&#39;].to_numpy()    </span>
<span class="sd">    [HTFF_phi, ETFF_phi] = TFF_phi_input</span>
<span class="sd">    return 2*np.pi*dsigma_phi_dt(y, xB, t, Q, 0, HTFF_phi, ETFF_phi)</span>
<span class="sd">&#39;&#39;&#39;</span>
<div class="viewcode-block" id="DVjpsiPxsec_theo">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.DVjpsiPxsec_theo">[docs]</a>
<span class="k">def</span> <span class="nf">DVjpsiPxsec_theo</span><span class="p">(</span><span class="n">DVjpsiPxsec_input</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">TFF_jpsi_input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_input</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">xB</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_input</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_input</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_input</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>    
    <span class="p">[</span><span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span><span class="p">]</span> <span class="o">=</span> <span class="n">TFF_jpsi_input</span>
    <span class="k">return</span> <span class="n">dsigma_Jpsi_dt</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span><span class="p">)</span></div>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">def DVrhoPxsec_cost_xBtQ(DVrhoPxsec_data_xBtQ: pd.DataFrame, Para_Unp, xsec_norm):</span>
<span class="sd">    [xB, t, Q] = [DVrhoPxsec_data_xBtQ[&#39;xB&#39;].iat[0], DVrhoPxsec_data_xBtQ[&#39;t&#39;].iat[0], DVrhoPxsec_data_xBtQ[&#39;Q&#39;].iat[0]] </span>
<span class="sd">    [HTFF_rho, ETFF_rho] = TFF_theo_rho(xB, t, Q, Para_Unp) # scalar for each of them</span>
<span class="sd">    DVrhoP_pred_xBtQ = DVrhoPxsec_theo(DVrhoPxsec_data_xBtQ, TFF_rho_input = [HTFF_rho, ETFF_rho]) * xsec_norm</span>
<span class="sd">    return np.sum(((DVrhoP_pred_xBtQ - DVrhoPxsec_data_xBtQ[&#39;f&#39;])/ DVrhoPxsec_data_xBtQ[&#39;delta f&#39;]) ** 2 )</span>

<span class="sd">def DVrhoPxsec_NLO_cost_xBtQ(DVrhoPxsec_data_xBtQ: pd.DataFrame, Para_Unp, xsec_norm):</span>
<span class="sd">    [xB, t, Q] = [DVrhoPxsec_data_xBtQ[&#39;xB&#39;].iat[0], DVrhoPxsec_data_xBtQ[&#39;t&#39;].iat[0], DVrhoPxsec_data_xBtQ[&#39;Q&#39;].iat[0]] </span>
<span class="sd">    [HTFF_rho, ETFF_rho] = TFF_theo_rho_NLO(xB, t, Q, Para_Unp) # scalar for each of them</span>
<span class="sd">    DVrhoP_pred_xBtQ = DVrhoPxsec_theo(DVrhoPxsec_data_xBtQ, TFF_rho_input = [HTFF_rho, ETFF_rho]) * xsec_norm</span>
<span class="sd">    return np.sum(((DVrhoP_pred_xBtQ - DVrhoPxsec_data_xBtQ[&#39;f&#39;])/ DVrhoPxsec_data_xBtQ[&#39;delta f&#39;]) ** 2 )</span>
<span class="sd">&#39;&#39;&#39;</span>
<div class="viewcode-block" id="DVjpsiPxsec_cost_xBtQ">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.DVjpsiPxsec_cost_xBtQ">[docs]</a>
<span class="k">def</span> <span class="nf">DVjpsiPxsec_cost_xBtQ</span><span class="p">(</span><span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">xsec_norm</span><span class="p">,</span> <span class="n">p_order</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
    <span class="p">[</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;xB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> 
    <span class="p">[</span><span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span><span class="p">]</span> <span class="o">=</span> <span class="n">TFF_theo_jpsi</span><span class="p">(</span><span class="n">xB</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Para_Unp</span><span class="p">,</span> <span class="n">p_order</span><span class="p">,</span> <span class="n">muset</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">DVjpsiP_pred_xBtQ</span> <span class="o">=</span> <span class="n">DVjpsiPxsec_theo</span><span class="p">(</span><span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">,</span> <span class="n">TFF_jpsi_input</span> <span class="o">=</span> <span class="p">[</span><span class="n">HTFF_jpsi</span><span class="p">,</span> <span class="n">ETFF_jpsi</span><span class="p">])</span> <span class="o">*</span> <span class="n">xsec_norm</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">DVjpsiP_pred_xBtQ</span> <span class="o">-</span> <span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">DVjpsiPxsec_data_xBtQ</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span></div>


<div class="viewcode-block" id="cost_forward_H">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.cost_forward_H">[docs]</a>
<span class="k">def</span> <span class="nf">cost_forward_H</span><span class="p">(</span><span class="n">Norm_HuV</span><span class="p">,</span>    <span class="n">alpha_HuV</span><span class="p">,</span>    <span class="n">beta_HuV</span><span class="p">,</span>    <span class="n">alphap_HuV</span><span class="p">,</span> 
                   <span class="n">Norm_Hubar</span><span class="p">,</span>  <span class="n">alpha_Hubar</span><span class="p">,</span>  <span class="n">beta_Hubar</span><span class="p">,</span>  <span class="n">alphap_Hqbar</span><span class="p">,</span>
                   <span class="n">Norm_HdV</span><span class="p">,</span>    <span class="n">alpha_HdV</span><span class="p">,</span>    <span class="n">beta_HdV</span><span class="p">,</span>    <span class="n">alphap_HdV</span><span class="p">,</span>
                   <span class="n">Norm_Hdbar</span><span class="p">,</span>  <span class="n">alpha_Hdbar</span><span class="p">,</span>  <span class="n">beta_Hdbar</span><span class="p">,</span> 
                   <span class="n">Norm_Hg</span><span class="p">,</span>     <span class="n">alpha_Hg</span><span class="p">,</span>     <span class="n">beta_Hg</span><span class="p">,</span>     <span class="n">alphap_Hg</span><span class="p">,</span>
                   <span class="n">Norm_EuV</span><span class="p">,</span>    <span class="n">alpha_EuV</span><span class="p">,</span>    <span class="n">beta_EuV</span><span class="p">,</span>    <span class="n">alphap_EuV</span><span class="p">,</span>
                   <span class="n">Norm_EdV</span><span class="p">,</span>    <span class="n">R_E_Sea</span><span class="p">,</span>      <span class="n">R_Hu_xi2</span><span class="p">,</span>    <span class="n">R_Hd_xi2</span><span class="p">,</span>    <span class="n">R_Hg_xi2</span><span class="p">,</span>
                   <span class="n">R_Eu_xi2</span><span class="p">,</span>    <span class="n">R_Ed_xi2</span><span class="p">,</span>     <span class="n">R_Eg_xi2</span><span class="p">,</span>
                   <span class="n">R_Hu_xi4</span><span class="p">,</span>    <span class="n">R_Hd_xi4</span><span class="p">,</span>     <span class="n">R_Hg_xi4</span><span class="p">,</span>
                   <span class="n">R_Eu_xi4</span><span class="p">,</span>    <span class="n">R_Ed_xi4</span><span class="p">,</span>     <span class="n">R_Eg_xi4</span><span class="p">,</span>    <span class="n">bexp_HSea</span><span class="p">):</span>

    <span class="n">Paralst</span> <span class="o">=</span> <span class="p">[</span><span class="n">Norm_HuV</span><span class="p">,</span>    <span class="n">alpha_HuV</span><span class="p">,</span>    <span class="n">beta_HuV</span><span class="p">,</span>    <span class="n">alphap_HuV</span><span class="p">,</span> 
               <span class="n">Norm_Hubar</span><span class="p">,</span>  <span class="n">alpha_Hubar</span><span class="p">,</span>  <span class="n">beta_Hubar</span><span class="p">,</span>  <span class="n">alphap_Hqbar</span><span class="p">,</span>
               <span class="n">Norm_HdV</span><span class="p">,</span>    <span class="n">alpha_HdV</span><span class="p">,</span>    <span class="n">beta_HdV</span><span class="p">,</span>    <span class="n">alphap_HdV</span><span class="p">,</span>
               <span class="n">Norm_Hdbar</span><span class="p">,</span>  <span class="n">alpha_Hdbar</span><span class="p">,</span>  <span class="n">beta_Hdbar</span><span class="p">,</span> 
               <span class="n">Norm_Hg</span><span class="p">,</span>     <span class="n">alpha_Hg</span><span class="p">,</span>     <span class="n">beta_Hg</span><span class="p">,</span>     <span class="n">alphap_Hg</span><span class="p">,</span>
               <span class="n">Norm_EuV</span><span class="p">,</span>    <span class="n">alpha_EuV</span><span class="p">,</span>    <span class="n">beta_EuV</span><span class="p">,</span>    <span class="n">alphap_EuV</span><span class="p">,</span>
               <span class="n">Norm_EdV</span><span class="p">,</span>    <span class="n">R_E_Sea</span><span class="p">,</span>      <span class="n">R_Hu_xi2</span><span class="p">,</span>    <span class="n">R_Hd_xi2</span><span class="p">,</span>    <span class="n">R_Hg_xi2</span><span class="p">,</span>
               <span class="n">R_Eu_xi2</span><span class="p">,</span>    <span class="n">R_Ed_xi2</span><span class="p">,</span>     <span class="n">R_Eg_xi2</span><span class="p">,</span>
               <span class="n">R_Hu_xi4</span><span class="p">,</span>    <span class="n">R_Hd_xi4</span><span class="p">,</span>     <span class="n">R_Hg_xi4</span><span class="p">,</span>
               <span class="n">R_Eu_xi4</span><span class="p">,</span>    <span class="n">R_Ed_xi4</span><span class="p">,</span>     <span class="n">R_Eg_xi4</span><span class="p">,</span>    <span class="n">bexp_HSea</span><span class="p">]</span>
    
    <span class="n">Para_all</span> <span class="o">=</span> <span class="n">ParaManager_Unp</span><span class="p">(</span><span class="n">Paralst</span><span class="p">)</span>
    <span class="c1"># PDF_H_pred = np.array(list(pool.map(partial(PDF_theo, Para = Para_all), np.array(PDF_data_H))))</span>
    <span class="n">PDF_H_pred</span> <span class="o">=</span> <span class="n">PDF_theo</span><span class="p">(</span><span class="n">PDF_data_H</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_PDF_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">PDF_H_pred</span> <span class="o">-</span> <span class="n">PDF_data_H</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">PDF_data_H</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># tPDF_H_pred = np.array(list(pool.map(partial(tPDF_theo, Para = Para_all), np.array(tPDF_data_H))))</span>
    <span class="n">tPDF_H_pred</span> <span class="o">=</span> <span class="n">tPDF_theo</span><span class="p">(</span><span class="n">tPDF_data_H</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_tPDF_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">tPDF_H_pred</span> <span class="o">-</span> <span class="n">tPDF_data_H</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">tPDF_data_H</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># GFF_H_pred = np.array(list(pool.map(partial(GFF_theo, Para = Para_all), np.array(GFF_data_H))))</span>
    <span class="n">GFF_H_pred</span> <span class="o">=</span> <span class="n">GFF_theo</span><span class="p">(</span><span class="n">GFF_data_H</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_GFF_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">GFF_H_pred</span> <span class="o">-</span> <span class="n">GFF_data_H</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">GFF_data_H</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">cost_PDF_H</span> <span class="o">+</span> <span class="n">cost_tPDF_H</span> <span class="o">+</span> <span class="n">cost_GFF_H</span></div>


<div class="viewcode-block" id="cost_forward_E">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.cost_forward_E">[docs]</a>
<span class="k">def</span> <span class="nf">cost_forward_E</span><span class="p">(</span><span class="n">Norm_HuV</span><span class="p">,</span>    <span class="n">alpha_HuV</span><span class="p">,</span>    <span class="n">beta_HuV</span><span class="p">,</span>    <span class="n">alphap_HuV</span><span class="p">,</span> 
                   <span class="n">Norm_Hubar</span><span class="p">,</span>  <span class="n">alpha_Hubar</span><span class="p">,</span>  <span class="n">beta_Hubar</span><span class="p">,</span>  <span class="n">alphap_Hqbar</span><span class="p">,</span>
                   <span class="n">Norm_HdV</span><span class="p">,</span>    <span class="n">alpha_HdV</span><span class="p">,</span>    <span class="n">beta_HdV</span><span class="p">,</span>    <span class="n">alphap_HdV</span><span class="p">,</span>
                   <span class="n">Norm_Hdbar</span><span class="p">,</span>  <span class="n">alpha_Hdbar</span><span class="p">,</span>  <span class="n">beta_Hdbar</span><span class="p">,</span> 
                   <span class="n">Norm_Hg</span><span class="p">,</span>     <span class="n">alpha_Hg</span><span class="p">,</span>     <span class="n">beta_Hg</span><span class="p">,</span>     <span class="n">alphap_Hg</span><span class="p">,</span>
                   <span class="n">Norm_EuV</span><span class="p">,</span>    <span class="n">alpha_EuV</span><span class="p">,</span>    <span class="n">beta_EuV</span><span class="p">,</span>    <span class="n">alphap_EuV</span><span class="p">,</span>
                   <span class="n">Norm_EdV</span><span class="p">,</span>    <span class="n">R_E_Sea</span><span class="p">,</span>      <span class="n">R_Hu_xi2</span><span class="p">,</span>    <span class="n">R_Hd_xi2</span><span class="p">,</span>    <span class="n">R_Hg_xi2</span><span class="p">,</span>
                   <span class="n">R_Eu_xi2</span><span class="p">,</span>    <span class="n">R_Ed_xi2</span><span class="p">,</span>     <span class="n">R_Eg_xi2</span><span class="p">,</span>
                   <span class="n">R_Hu_xi4</span><span class="p">,</span>    <span class="n">R_Hd_xi4</span><span class="p">,</span>     <span class="n">R_Hg_xi4</span><span class="p">,</span>
                   <span class="n">R_Eu_xi4</span><span class="p">,</span>    <span class="n">R_Ed_xi4</span><span class="p">,</span>     <span class="n">R_Eg_xi4</span><span class="p">,</span>    <span class="n">bexp_HSea</span><span class="p">):</span>

    <span class="n">Paralst</span> <span class="o">=</span> <span class="p">[</span><span class="n">Norm_HuV</span><span class="p">,</span>    <span class="n">alpha_HuV</span><span class="p">,</span>    <span class="n">beta_HuV</span><span class="p">,</span>    <span class="n">alphap_HuV</span><span class="p">,</span> 
               <span class="n">Norm_Hubar</span><span class="p">,</span>  <span class="n">alpha_Hubar</span><span class="p">,</span>  <span class="n">beta_Hubar</span><span class="p">,</span>  <span class="n">alphap_Hqbar</span><span class="p">,</span>
               <span class="n">Norm_HdV</span><span class="p">,</span>    <span class="n">alpha_HdV</span><span class="p">,</span>    <span class="n">beta_HdV</span><span class="p">,</span>    <span class="n">alphap_HdV</span><span class="p">,</span>
               <span class="n">Norm_Hdbar</span><span class="p">,</span>  <span class="n">alpha_Hdbar</span><span class="p">,</span>  <span class="n">beta_Hdbar</span><span class="p">,</span> 
               <span class="n">Norm_Hg</span><span class="p">,</span>     <span class="n">alpha_Hg</span><span class="p">,</span>     <span class="n">beta_Hg</span><span class="p">,</span>     <span class="n">alphap_Hg</span><span class="p">,</span>
               <span class="n">Norm_EuV</span><span class="p">,</span>    <span class="n">alpha_EuV</span><span class="p">,</span>    <span class="n">beta_EuV</span><span class="p">,</span>    <span class="n">alphap_EuV</span><span class="p">,</span>
               <span class="n">Norm_EdV</span><span class="p">,</span>    <span class="n">R_E_Sea</span><span class="p">,</span>      <span class="n">R_Hu_xi2</span><span class="p">,</span>    <span class="n">R_Hd_xi2</span><span class="p">,</span>    <span class="n">R_Hg_xi2</span><span class="p">,</span>
               <span class="n">R_Eu_xi2</span><span class="p">,</span>    <span class="n">R_Ed_xi2</span><span class="p">,</span>     <span class="n">R_Eg_xi2</span><span class="p">,</span>
               <span class="n">R_Hu_xi4</span><span class="p">,</span>    <span class="n">R_Hd_xi4</span><span class="p">,</span>     <span class="n">R_Hg_xi4</span><span class="p">,</span>
               <span class="n">R_Eu_xi4</span><span class="p">,</span>    <span class="n">R_Ed_xi4</span><span class="p">,</span>     <span class="n">R_Eg_xi4</span><span class="p">,</span>    <span class="n">bexp_HSea</span><span class="p">]</span>
    
    <span class="n">Para_all</span> <span class="o">=</span> <span class="n">ParaManager_Unp</span><span class="p">(</span><span class="n">Paralst</span><span class="p">)</span>
    <span class="c1"># PDF_E_pred = np.array(list(pool.map(partial(PDF_theo, Para = Para_all), np.array(PDF_data_E))))</span>
    <span class="n">PDF_E_pred</span> <span class="o">=</span> <span class="n">PDF_theo</span><span class="p">(</span><span class="n">PDF_data_E</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_PDF_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">PDF_E_pred</span> <span class="o">-</span> <span class="n">PDF_data_E</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">PDF_data_E</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># tPDF_E_pred = np.array(list(pool.map(partial(tPDF_theo, Para = Para_all), np.array(tPDF_data_E))))</span>
    <span class="n">tPDF_E_pred</span> <span class="o">=</span> <span class="n">tPDF_theo</span><span class="p">(</span><span class="n">tPDF_data_E</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_tPDF_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">tPDF_E_pred</span> <span class="o">-</span> <span class="n">tPDF_data_E</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">tPDF_data_E</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># GFF_E_pred = np.array(list(pool.map(partial(GFF_theo, Para = Para_all), np.array(GFF_data_E))))</span>
    <span class="n">GFF_E_pred</span> <span class="o">=</span> <span class="n">GFF_theo</span><span class="p">(</span><span class="n">GFF_data_E</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_GFF_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">GFF_E_pred</span> <span class="o">-</span> <span class="n">GFF_data_E</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">GFF_data_E</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">cost_PDF_E</span> <span class="o">+</span> <span class="n">cost_tPDF_E</span> <span class="o">+</span> <span class="n">cost_GFF_E</span></div>


<div class="viewcode-block" id="forward_H_fit">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.forward_H_fit">[docs]</a>
<span class="k">def</span> <span class="nf">forward_H_fit</span><span class="p">(</span><span class="n">Paralst_Unp</span><span class="p">):</span>

    <span class="p">[</span><span class="n">Norm_HuV_Init</span><span class="p">,</span>    <span class="n">alpha_HuV_Init</span><span class="p">,</span>    <span class="n">beta_HuV_Init</span><span class="p">,</span>    <span class="n">alphap_HuV_Init</span><span class="p">,</span> 
     <span class="n">Norm_Hubar_Init</span><span class="p">,</span>  <span class="n">alpha_Hubar_Init</span><span class="p">,</span>  <span class="n">beta_Hubar_Init</span><span class="p">,</span>  <span class="n">alphap_Hqbar_Init</span><span class="p">,</span>
     <span class="n">Norm_HdV_Init</span><span class="p">,</span>    <span class="n">alpha_HdV_Init</span><span class="p">,</span>    <span class="n">beta_HdV_Init</span><span class="p">,</span>    <span class="n">alphap_HdV_Init</span><span class="p">,</span>
     <span class="n">Norm_Hdbar_Init</span><span class="p">,</span>  <span class="n">alpha_Hdbar_Init</span><span class="p">,</span>  <span class="n">beta_Hdbar_Init</span><span class="p">,</span> 
     <span class="n">Norm_Hg_Init</span><span class="p">,</span>     <span class="n">alpha_Hg_Init</span><span class="p">,</span>     <span class="n">beta_Hg_Init</span><span class="p">,</span>     <span class="n">alphap_Hg_Init</span><span class="p">,</span>
     <span class="n">Norm_EuV_Init</span><span class="p">,</span>    <span class="n">alpha_EuV_Init</span><span class="p">,</span>    <span class="n">beta_EuV_Init</span><span class="p">,</span>    <span class="n">alphap_EuV_Init</span><span class="p">,</span>
     <span class="n">Norm_EdV_Init</span><span class="p">,</span>    <span class="n">R_E_Sea_Init</span><span class="p">,</span>      <span class="n">R_Hu_xi2_Init</span><span class="p">,</span>    <span class="n">R_Hd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Hg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Eu_xi2_Init</span><span class="p">,</span>    <span class="n">R_Ed_xi2_Init</span><span class="p">,</span>     <span class="n">R_Eg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Hu_xi4_Init</span><span class="p">,</span>    <span class="n">R_Hd_xi4_Init</span><span class="p">,</span>     <span class="n">R_Hg_xi4_Init</span><span class="p">,</span>
     <span class="n">R_Eu_xi4_Init</span><span class="p">,</span>    <span class="n">R_Ed_xi4_Init</span><span class="p">,</span>     <span class="n">R_Eg_xi4_Init</span><span class="p">,</span>    <span class="n">bexp_HSea_Init</span><span class="p">]</span> <span class="o">=</span> <span class="n">Paralst_Unp</span>

    <span class="n">fit_forw_H</span> <span class="o">=</span> <span class="n">Minuit</span><span class="p">(</span><span class="n">cost_forward_H</span><span class="p">,</span> <span class="n">Norm_HuV</span> <span class="o">=</span> <span class="n">Norm_HuV_Init</span><span class="p">,</span>     <span class="n">alpha_HuV</span> <span class="o">=</span> <span class="n">alpha_HuV_Init</span><span class="p">,</span>      <span class="n">beta_HuV</span> <span class="o">=</span> <span class="n">beta_HuV_Init</span><span class="p">,</span>     <span class="n">alphap_HuV</span> <span class="o">=</span> <span class="n">alphap_HuV_Init</span><span class="p">,</span> 
                                        <span class="n">Norm_Hubar</span> <span class="o">=</span> <span class="n">Norm_Hubar_Init</span><span class="p">,</span> <span class="n">alpha_Hubar</span> <span class="o">=</span> <span class="n">alpha_Hubar_Init</span><span class="p">,</span>  <span class="n">beta_Hubar</span> <span class="o">=</span> <span class="n">beta_Hubar_Init</span><span class="p">,</span> <span class="n">alphap_Hqbar</span> <span class="o">=</span> <span class="n">alphap_Hqbar_Init</span><span class="p">,</span>
                                        <span class="n">Norm_HdV</span> <span class="o">=</span> <span class="n">Norm_HdV_Init</span><span class="p">,</span>     <span class="n">alpha_HdV</span> <span class="o">=</span> <span class="n">alpha_HdV_Init</span><span class="p">,</span>      <span class="n">beta_HdV</span> <span class="o">=</span> <span class="n">beta_HdV_Init</span><span class="p">,</span>     <span class="n">alphap_HdV</span> <span class="o">=</span> <span class="n">alphap_HdV_Init</span><span class="p">,</span>
                                        <span class="n">Norm_Hdbar</span> <span class="o">=</span> <span class="n">Norm_Hdbar_Init</span><span class="p">,</span> <span class="n">alpha_Hdbar</span> <span class="o">=</span> <span class="n">alpha_Hdbar_Init</span><span class="p">,</span>  <span class="n">beta_Hdbar</span> <span class="o">=</span> <span class="n">beta_Hdbar_Init</span><span class="p">,</span> 
                                        <span class="n">Norm_Hg</span> <span class="o">=</span> <span class="n">Norm_Hg_Init</span><span class="p">,</span>       <span class="n">alpha_Hg</span> <span class="o">=</span> <span class="n">alpha_Hg_Init</span><span class="p">,</span>        <span class="n">beta_Hg</span> <span class="o">=</span> <span class="n">beta_Hg_Init</span><span class="p">,</span>       <span class="n">alphap_Hg</span> <span class="o">=</span> <span class="n">alphap_Hg_Init</span><span class="p">,</span>
                                        <span class="n">Norm_EuV</span> <span class="o">=</span> <span class="n">Norm_EuV_Init</span><span class="p">,</span>     <span class="n">alpha_EuV</span> <span class="o">=</span> <span class="n">alpha_EuV_Init</span><span class="p">,</span>      <span class="n">beta_EuV</span> <span class="o">=</span> <span class="n">beta_EuV_Init</span><span class="p">,</span>     <span class="n">alphap_EuV</span> <span class="o">=</span> <span class="n">alphap_EuV_Init</span><span class="p">,</span> 
                                        <span class="n">Norm_EdV</span> <span class="o">=</span> <span class="n">Norm_EdV_Init</span><span class="p">,</span>     <span class="n">R_E_Sea</span> <span class="o">=</span> <span class="n">R_E_Sea_Init</span><span class="p">,</span>          <span class="n">R_Hu_xi2</span> <span class="o">=</span> <span class="n">R_Hu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Hd_xi2</span> <span class="o">=</span> <span class="n">R_Hd_xi2_Init</span><span class="p">,</span>     <span class="n">R_Hg_xi2</span> <span class="o">=</span> <span class="n">R_Hg_xi2_Init</span><span class="p">,</span>
                                        <span class="n">R_Eu_xi2</span> <span class="o">=</span> <span class="n">R_Eu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Ed_xi2</span> <span class="o">=</span> <span class="n">R_Ed_xi2_Init</span><span class="p">,</span>        <span class="n">R_Eg_xi2</span> <span class="o">=</span> <span class="n">R_Eg_xi2_Init</span><span class="p">,</span>
                                        <span class="n">R_Hu_xi4</span> <span class="o">=</span> <span class="n">R_Hu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Hd_xi4</span> <span class="o">=</span> <span class="n">R_Hd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Hg_xi4</span> <span class="o">=</span> <span class="n">R_Hg_xi4_Init</span><span class="p">,</span>
                                        <span class="n">R_Eu_xi4</span> <span class="o">=</span> <span class="n">R_Eu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Ed_xi4</span> <span class="o">=</span> <span class="n">R_Ed_xi4_Init</span><span class="p">,</span>        <span class="n">R_Eg_xi4</span> <span class="o">=</span> <span class="n">R_Eg_xi4_Init</span><span class="p">,</span>     <span class="n">bexp_HSea</span> <span class="o">=</span> <span class="n">bexp_HSea_Init</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">errordef</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>

    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>    
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Hqbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_E_Sea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hd_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Ed_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hd_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Ed_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;bexp_HSea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">global</span> <span class="n">time_start</span>
    <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">migrad</span><span class="p">()</span>
    <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">hesse</span><span class="p">()</span>

    <span class="n">ndof_H</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">PDF_data_H</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tPDF_data_H</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">GFF_data_H</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>  <span class="o">-</span> <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">nfit</span> 

    <span class="n">time_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">time_start</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMP_Output/H_forward_fit.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total running time: </span><span class="si">%.1f</span><span class="s1"> minutes. Total call of cost function: </span><span class="si">%3d</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">time_end</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">nfcn</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The chi squared/d.o.f. is: </span><span class="si">%.2f</span><span class="s1"> / </span><span class="si">%3d</span><span class="s1"> ( = </span><span class="si">%.2f</span><span class="s1"> ).</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fval</span><span class="p">,</span> <span class="n">ndof_H</span><span class="p">,</span> <span class="n">fit_forw_H</span><span class="o">.</span><span class="n">fval</span><span class="o">/</span><span class="n">ndof_H</span><span class="p">),</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Below are the final output parameters from iMinuit:&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_forw_H</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_forw_H</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit_forw_H</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s2">&quot;GUMP_Output/H_forward_cov.csv&quot;</span><span class="p">),</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">my_csv</span><span class="p">:</span>
        <span class="n">csvWriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">my_csv</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">csvWriter</span><span class="o">.</span><span class="n">writerows</span><span class="p">([</span><span class="o">*</span><span class="n">fit_forw_H</span><span class="o">.</span><span class="n">covariance</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H fit finished...&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fit_forw_H</span></div>


<div class="viewcode-block" id="forward_E_fit">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.forward_E_fit">[docs]</a>
<span class="k">def</span> <span class="nf">forward_E_fit</span><span class="p">(</span><span class="n">Paralst_Unp</span><span class="p">):</span>

    <span class="p">[</span><span class="n">Norm_HuV_Init</span><span class="p">,</span>    <span class="n">alpha_HuV_Init</span><span class="p">,</span>    <span class="n">beta_HuV_Init</span><span class="p">,</span>    <span class="n">alphap_HuV_Init</span><span class="p">,</span> 
     <span class="n">Norm_Hubar_Init</span><span class="p">,</span>  <span class="n">alpha_Hubar_Init</span><span class="p">,</span>  <span class="n">beta_Hubar_Init</span><span class="p">,</span>  <span class="n">alphap_Hqbar_Init</span><span class="p">,</span>
     <span class="n">Norm_HdV_Init</span><span class="p">,</span>    <span class="n">alpha_HdV_Init</span><span class="p">,</span>    <span class="n">beta_HdV_Init</span><span class="p">,</span>    <span class="n">alphap_HdV_Init</span><span class="p">,</span>
     <span class="n">Norm_Hdbar_Init</span><span class="p">,</span>  <span class="n">alpha_Hdbar_Init</span><span class="p">,</span>  <span class="n">beta_Hdbar_Init</span><span class="p">,</span> 
     <span class="n">Norm_Hg_Init</span><span class="p">,</span>     <span class="n">alpha_Hg_Init</span><span class="p">,</span>     <span class="n">beta_Hg_Init</span><span class="p">,</span>     <span class="n">alphap_Hg_Init</span><span class="p">,</span>
     <span class="n">Norm_EuV_Init</span><span class="p">,</span>    <span class="n">alpha_EuV_Init</span><span class="p">,</span>    <span class="n">beta_EuV_Init</span><span class="p">,</span>    <span class="n">alphap_EuV_Init</span><span class="p">,</span>
     <span class="n">Norm_EdV_Init</span><span class="p">,</span>    <span class="n">R_E_Sea_Init</span><span class="p">,</span>      <span class="n">R_Hu_xi2_Init</span><span class="p">,</span>    <span class="n">R_Hd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Hg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Eu_xi2_Init</span><span class="p">,</span>    <span class="n">R_Ed_xi2_Init</span><span class="p">,</span>     <span class="n">R_Eg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Hu_xi4_Init</span><span class="p">,</span>    <span class="n">R_Hd_xi4_Init</span><span class="p">,</span>     <span class="n">R_Hg_xi4_Init</span><span class="p">,</span>
     <span class="n">R_Eu_xi4_Init</span><span class="p">,</span>    <span class="n">R_Ed_xi4_Init</span><span class="p">,</span>     <span class="n">R_Eg_xi4_Init</span><span class="p">,</span>    <span class="n">bexp_HSea_Init</span><span class="p">]</span> <span class="o">=</span> <span class="n">Paralst_Unp</span>

    <span class="n">fit_forw_E</span> <span class="o">=</span> <span class="n">Minuit</span><span class="p">(</span><span class="n">cost_forward_E</span><span class="p">,</span> <span class="n">Norm_HuV</span> <span class="o">=</span> <span class="n">Norm_HuV_Init</span><span class="p">,</span>     <span class="n">alpha_HuV</span> <span class="o">=</span> <span class="n">alpha_HuV_Init</span><span class="p">,</span>      <span class="n">beta_HuV</span> <span class="o">=</span> <span class="n">beta_HuV_Init</span><span class="p">,</span>     <span class="n">alphap_HuV</span> <span class="o">=</span> <span class="n">alphap_HuV_Init</span><span class="p">,</span> 
                                        <span class="n">Norm_Hubar</span> <span class="o">=</span> <span class="n">Norm_Hubar_Init</span><span class="p">,</span> <span class="n">alpha_Hubar</span> <span class="o">=</span> <span class="n">alpha_Hubar_Init</span><span class="p">,</span>  <span class="n">beta_Hubar</span> <span class="o">=</span> <span class="n">beta_Hubar_Init</span><span class="p">,</span> <span class="n">alphap_Hqbar</span> <span class="o">=</span> <span class="n">alphap_Hqbar_Init</span><span class="p">,</span>
                                        <span class="n">Norm_HdV</span> <span class="o">=</span> <span class="n">Norm_HdV_Init</span><span class="p">,</span>     <span class="n">alpha_HdV</span> <span class="o">=</span> <span class="n">alpha_HdV_Init</span><span class="p">,</span>      <span class="n">beta_HdV</span> <span class="o">=</span> <span class="n">beta_HdV_Init</span><span class="p">,</span>     <span class="n">alphap_HdV</span> <span class="o">=</span> <span class="n">alphap_HdV_Init</span><span class="p">,</span>
                                        <span class="n">Norm_Hdbar</span> <span class="o">=</span> <span class="n">Norm_Hdbar_Init</span><span class="p">,</span> <span class="n">alpha_Hdbar</span> <span class="o">=</span> <span class="n">alpha_Hdbar_Init</span><span class="p">,</span>  <span class="n">beta_Hdbar</span> <span class="o">=</span> <span class="n">beta_Hdbar_Init</span><span class="p">,</span> 
                                        <span class="n">Norm_Hg</span> <span class="o">=</span> <span class="n">Norm_Hg_Init</span><span class="p">,</span>       <span class="n">alpha_Hg</span> <span class="o">=</span> <span class="n">alpha_Hg_Init</span><span class="p">,</span>        <span class="n">beta_Hg</span> <span class="o">=</span> <span class="n">beta_Hg_Init</span><span class="p">,</span>       <span class="n">alphap_Hg</span> <span class="o">=</span> <span class="n">alphap_Hg_Init</span><span class="p">,</span>
                                        <span class="n">Norm_EuV</span> <span class="o">=</span> <span class="n">Norm_EuV_Init</span><span class="p">,</span>     <span class="n">alpha_EuV</span> <span class="o">=</span> <span class="n">alpha_EuV_Init</span><span class="p">,</span>      <span class="n">beta_EuV</span> <span class="o">=</span> <span class="n">beta_EuV_Init</span><span class="p">,</span>     <span class="n">alphap_EuV</span> <span class="o">=</span> <span class="n">alphap_EuV_Init</span><span class="p">,</span> 
                                        <span class="n">Norm_EdV</span> <span class="o">=</span> <span class="n">Norm_EdV_Init</span><span class="p">,</span>     <span class="n">R_E_Sea</span> <span class="o">=</span> <span class="n">R_E_Sea_Init</span><span class="p">,</span>          <span class="n">R_Hu_xi2</span> <span class="o">=</span> <span class="n">R_Hu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Hd_xi2</span> <span class="o">=</span> <span class="n">R_Hd_xi2_Init</span><span class="p">,</span>     <span class="n">R_Hg_xi2</span> <span class="o">=</span> <span class="n">R_Hg_xi2_Init</span><span class="p">,</span>
                                        <span class="n">R_Eu_xi2</span> <span class="o">=</span> <span class="n">R_Eu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Ed_xi2</span> <span class="o">=</span> <span class="n">R_Ed_xi2_Init</span><span class="p">,</span>        <span class="n">R_Eg_xi2</span> <span class="o">=</span> <span class="n">R_Eg_xi2_Init</span><span class="p">,</span>
                                        <span class="n">R_Hu_xi4</span> <span class="o">=</span> <span class="n">R_Hu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Hd_xi4</span> <span class="o">=</span> <span class="n">R_Hd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Hg_xi4</span> <span class="o">=</span> <span class="n">R_Hg_xi4_Init</span><span class="p">,</span>
                                        <span class="n">R_Eu_xi4</span> <span class="o">=</span> <span class="n">R_Eu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Ed_xi4</span> <span class="o">=</span> <span class="n">R_Ed_xi4_Init</span><span class="p">,</span>        <span class="n">R_Eg_xi4</span> <span class="o">=</span> <span class="n">R_Eg_xi4_Init</span><span class="p">,</span>     <span class="n">bexp_HSea</span> <span class="o">=</span> <span class="n">bexp_HSea_Init</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">errordef</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>    
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Hqbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hd_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Ed_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hd_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Ed_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;bexp_HSea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">global</span> <span class="n">time_start</span>
    <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">migrad</span><span class="p">()</span>
    <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">hesse</span><span class="p">()</span>

    <span class="n">ndof_E</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">PDF_data_E</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tPDF_data_E</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">GFF_data_E</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>  <span class="o">-</span> <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">nfit</span> 

    <span class="n">time_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">time_start</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMP_Output/E_forward_fit.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total running time: </span><span class="si">%.1f</span><span class="s1"> minutes. Total call of cost function: </span><span class="si">%3d</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">time_end</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">nfcn</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The chi squared/d.o.f. is: </span><span class="si">%.2f</span><span class="s1"> / </span><span class="si">%3d</span><span class="s1"> ( = </span><span class="si">%.2f</span><span class="s1"> ).</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fval</span><span class="p">,</span> <span class="n">ndof_E</span><span class="p">,</span> <span class="n">fit_forw_E</span><span class="o">.</span><span class="n">fval</span><span class="o">/</span><span class="n">ndof_E</span><span class="p">),</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Below are the final output parameters from iMinuit:&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_forw_E</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_forw_E</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit_forw_E</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s2">&quot;GUMP_Output/E_forward_cov.csv&quot;</span><span class="p">),</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">my_csv</span><span class="p">:</span>
        <span class="n">csvWriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">my_csv</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">csvWriter</span><span class="o">.</span><span class="n">writerows</span><span class="p">([</span><span class="o">*</span><span class="n">fit_forw_E</span><span class="o">.</span><span class="n">covariance</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;E fit finished...&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fit_forw_E</span></div>


<div class="viewcode-block" id="cost_forward_Ht">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.cost_forward_Ht">[docs]</a>
<span class="k">def</span> <span class="nf">cost_forward_Ht</span><span class="p">(</span><span class="n">Norm_HtuV</span><span class="p">,</span>   <span class="n">alpha_HtuV</span><span class="p">,</span>   <span class="n">beta_HtuV</span><span class="p">,</span>   <span class="n">alphap_HtuV</span><span class="p">,</span> 
                    <span class="n">Norm_Htubar</span><span class="p">,</span> <span class="n">alpha_Htubar</span><span class="p">,</span> <span class="n">beta_Htubar</span><span class="p">,</span> <span class="n">alphap_Htqbar</span><span class="p">,</span>
                    <span class="n">Norm_HtdV</span><span class="p">,</span>   <span class="n">alpha_HtdV</span><span class="p">,</span>   <span class="n">beta_HtdV</span><span class="p">,</span>   <span class="n">alphap_HtdV</span><span class="p">,</span>
                    <span class="n">Norm_Htdbar</span><span class="p">,</span> <span class="n">alpha_Htdbar</span><span class="p">,</span> <span class="n">beta_Htdbar</span><span class="p">,</span> 
                    <span class="n">Norm_Htg</span><span class="p">,</span>    <span class="n">alpha_Htg</span><span class="p">,</span>    <span class="n">beta_Htg</span><span class="p">,</span>    <span class="n">alphap_Htg</span><span class="p">,</span>
                    <span class="n">Norm_EtuV</span><span class="p">,</span>   <span class="n">alpha_EtuV</span><span class="p">,</span>   <span class="n">beta_EtuV</span><span class="p">,</span>   <span class="n">alphap_EtuV</span><span class="p">,</span>
                    <span class="n">Norm_EtdV</span><span class="p">,</span>   <span class="n">R_Et_Sea</span><span class="p">,</span>     <span class="n">R_Htu_xi2</span><span class="p">,</span>   <span class="n">R_Htd_xi2</span><span class="p">,</span>    <span class="n">R_Htg_xi2</span><span class="p">,</span>
                    <span class="n">R_Etu_xi2</span><span class="p">,</span>   <span class="n">R_Etd_xi2</span><span class="p">,</span>    <span class="n">R_Etg_xi2</span><span class="p">,</span>
                    <span class="n">R_Htu_xi4</span><span class="p">,</span>   <span class="n">R_Htd_xi4</span><span class="p">,</span>    <span class="n">R_Htg_xi4</span><span class="p">,</span>
                    <span class="n">R_Etu_xi4</span><span class="p">,</span>   <span class="n">R_Etd_xi4</span><span class="p">,</span>    <span class="n">R_Etg_xi4</span><span class="p">,</span>   <span class="n">bexp_HtSea</span><span class="p">):</span>

    <span class="n">Paralst</span> <span class="o">=</span> <span class="p">[</span><span class="n">Norm_HtuV</span><span class="p">,</span>   <span class="n">alpha_HtuV</span><span class="p">,</span>   <span class="n">beta_HtuV</span><span class="p">,</span>   <span class="n">alphap_HtuV</span><span class="p">,</span> 
               <span class="n">Norm_Htubar</span><span class="p">,</span> <span class="n">alpha_Htubar</span><span class="p">,</span> <span class="n">beta_Htubar</span><span class="p">,</span> <span class="n">alphap_Htqbar</span><span class="p">,</span>
               <span class="n">Norm_HtdV</span><span class="p">,</span>   <span class="n">alpha_HtdV</span><span class="p">,</span>   <span class="n">beta_HtdV</span><span class="p">,</span>   <span class="n">alphap_HtdV</span><span class="p">,</span>
               <span class="n">Norm_Htdbar</span><span class="p">,</span> <span class="n">alpha_Htdbar</span><span class="p">,</span> <span class="n">beta_Htdbar</span><span class="p">,</span> 
               <span class="n">Norm_Htg</span><span class="p">,</span>    <span class="n">alpha_Htg</span><span class="p">,</span>    <span class="n">beta_Htg</span><span class="p">,</span>    <span class="n">alphap_Htg</span><span class="p">,</span>
               <span class="n">Norm_EtuV</span><span class="p">,</span>   <span class="n">alpha_EtuV</span><span class="p">,</span>   <span class="n">beta_EtuV</span><span class="p">,</span>   <span class="n">alphap_EtuV</span><span class="p">,</span>
               <span class="n">Norm_EtdV</span><span class="p">,</span>   <span class="n">R_Et_Sea</span><span class="p">,</span>     <span class="n">R_Htu_xi2</span><span class="p">,</span>   <span class="n">R_Htd_xi2</span><span class="p">,</span>    <span class="n">R_Htg_xi2</span><span class="p">,</span>
               <span class="n">R_Etu_xi2</span><span class="p">,</span>   <span class="n">R_Etd_xi2</span><span class="p">,</span>    <span class="n">R_Etg_xi2</span><span class="p">,</span>
               <span class="n">R_Htu_xi4</span><span class="p">,</span>   <span class="n">R_Htd_xi4</span><span class="p">,</span>    <span class="n">R_Htg_xi4</span><span class="p">,</span>
               <span class="n">R_Etu_xi4</span><span class="p">,</span>   <span class="n">R_Etd_xi4</span><span class="p">,</span>    <span class="n">R_Etg_xi4</span><span class="p">,</span>   <span class="n">bexp_HtSea</span><span class="p">]</span>
    
    <span class="n">Para_all</span> <span class="o">=</span> <span class="n">ParaManager_Pol</span><span class="p">(</span><span class="n">Paralst</span><span class="p">)</span>
    <span class="c1"># PDF_Ht_pred = np.array(list(pool.map(partial(PDF_theo, Para = Para_all), np.array(PDF_data_Ht))))</span>
    <span class="n">PDF_Ht_pred</span> <span class="o">=</span> <span class="n">PDF_theo</span><span class="p">(</span><span class="n">PDF_data_Ht</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_PDF_Ht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">PDF_Ht_pred</span> <span class="o">-</span> <span class="n">PDF_data_Ht</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">PDF_data_Ht</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># tPDF_Ht_pred = np.array(list(pool.map(partial(tPDF_theo, Para = Para_all), np.array(tPDF_data_Ht))))</span>
    <span class="n">tPDF_Ht_pred</span> <span class="o">=</span> <span class="n">tPDF_theo</span><span class="p">(</span><span class="n">tPDF_data_Ht</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_tPDF_Ht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">tPDF_Ht_pred</span> <span class="o">-</span> <span class="n">tPDF_data_Ht</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">tPDF_data_Ht</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># GFF_Ht_pred = np.array(list(pool.map(partial(GFF_theo, Para = Para_all), np.array(GFF_data_Ht))))</span>
    <span class="n">GFF_Ht_pred</span> <span class="o">=</span> <span class="n">GFF_theo</span><span class="p">(</span><span class="n">GFF_data_Ht</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_GFF_Ht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">GFF_Ht_pred</span> <span class="o">-</span> <span class="n">GFF_data_Ht</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">GFF_data_Ht</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">cost_PDF_Ht</span> <span class="o">+</span> <span class="n">cost_tPDF_Ht</span> <span class="o">+</span> <span class="n">cost_GFF_Ht</span></div>


<div class="viewcode-block" id="cost_forward_Et">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.cost_forward_Et">[docs]</a>
<span class="k">def</span> <span class="nf">cost_forward_Et</span><span class="p">(</span><span class="n">Norm_HtuV</span><span class="p">,</span>   <span class="n">alpha_HtuV</span><span class="p">,</span>   <span class="n">beta_HtuV</span><span class="p">,</span>   <span class="n">alphap_HtuV</span><span class="p">,</span> 
                    <span class="n">Norm_Htubar</span><span class="p">,</span> <span class="n">alpha_Htubar</span><span class="p">,</span> <span class="n">beta_Htubar</span><span class="p">,</span> <span class="n">alphap_Htqbar</span><span class="p">,</span>
                    <span class="n">Norm_HtdV</span><span class="p">,</span>   <span class="n">alpha_HtdV</span><span class="p">,</span>   <span class="n">beta_HtdV</span><span class="p">,</span>   <span class="n">alphap_HtdV</span><span class="p">,</span>
                    <span class="n">Norm_Htdbar</span><span class="p">,</span> <span class="n">alpha_Htdbar</span><span class="p">,</span> <span class="n">beta_Htdbar</span><span class="p">,</span> 
                    <span class="n">Norm_Htg</span><span class="p">,</span>    <span class="n">alpha_Htg</span><span class="p">,</span>    <span class="n">beta_Htg</span><span class="p">,</span>    <span class="n">alphap_Htg</span><span class="p">,</span>
                    <span class="n">Norm_EtuV</span><span class="p">,</span>   <span class="n">alpha_EtuV</span><span class="p">,</span>   <span class="n">beta_EtuV</span><span class="p">,</span>   <span class="n">alphap_EtuV</span><span class="p">,</span>
                    <span class="n">Norm_EtdV</span><span class="p">,</span>   <span class="n">R_Et_Sea</span><span class="p">,</span>     <span class="n">R_Htu_xi2</span><span class="p">,</span>   <span class="n">R_Htd_xi2</span><span class="p">,</span>    <span class="n">R_Htg_xi2</span><span class="p">,</span>
                    <span class="n">R_Etu_xi2</span><span class="p">,</span>   <span class="n">R_Etd_xi2</span><span class="p">,</span>    <span class="n">R_Etg_xi2</span><span class="p">,</span>
                    <span class="n">R_Htu_xi4</span><span class="p">,</span>   <span class="n">R_Htd_xi4</span><span class="p">,</span>    <span class="n">R_Htg_xi4</span><span class="p">,</span>
                    <span class="n">R_Etu_xi4</span><span class="p">,</span>   <span class="n">R_Etd_xi4</span><span class="p">,</span>    <span class="n">R_Etg_xi4</span><span class="p">,</span>   <span class="n">bexp_HtSea</span><span class="p">):</span>

    <span class="n">Paralst</span> <span class="o">=</span> <span class="p">[</span><span class="n">Norm_HtuV</span><span class="p">,</span>   <span class="n">alpha_HtuV</span><span class="p">,</span>   <span class="n">beta_HtuV</span><span class="p">,</span>   <span class="n">alphap_HtuV</span><span class="p">,</span> 
               <span class="n">Norm_Htubar</span><span class="p">,</span> <span class="n">alpha_Htubar</span><span class="p">,</span> <span class="n">beta_Htubar</span><span class="p">,</span> <span class="n">alphap_Htqbar</span><span class="p">,</span>
               <span class="n">Norm_HtdV</span><span class="p">,</span>   <span class="n">alpha_HtdV</span><span class="p">,</span>   <span class="n">beta_HtdV</span><span class="p">,</span>   <span class="n">alphap_HtdV</span><span class="p">,</span>
               <span class="n">Norm_Htdbar</span><span class="p">,</span> <span class="n">alpha_Htdbar</span><span class="p">,</span> <span class="n">beta_Htdbar</span><span class="p">,</span> 
               <span class="n">Norm_Htg</span><span class="p">,</span>    <span class="n">alpha_Htg</span><span class="p">,</span>    <span class="n">beta_Htg</span><span class="p">,</span>    <span class="n">alphap_Htg</span><span class="p">,</span>
               <span class="n">Norm_EtuV</span><span class="p">,</span>   <span class="n">alpha_EtuV</span><span class="p">,</span>   <span class="n">beta_EtuV</span><span class="p">,</span>   <span class="n">alphap_EtuV</span><span class="p">,</span>
               <span class="n">Norm_EtdV</span><span class="p">,</span>   <span class="n">R_Et_Sea</span><span class="p">,</span>     <span class="n">R_Htu_xi2</span><span class="p">,</span>   <span class="n">R_Htd_xi2</span><span class="p">,</span>    <span class="n">R_Htg_xi2</span><span class="p">,</span>
               <span class="n">R_Etu_xi2</span><span class="p">,</span>   <span class="n">R_Etd_xi2</span><span class="p">,</span>    <span class="n">R_Etg_xi2</span><span class="p">,</span>
               <span class="n">R_Htu_xi4</span><span class="p">,</span>   <span class="n">R_Htd_xi4</span><span class="p">,</span>    <span class="n">R_Htg_xi4</span><span class="p">,</span>
               <span class="n">R_Etu_xi4</span><span class="p">,</span>   <span class="n">R_Etd_xi4</span><span class="p">,</span>    <span class="n">R_Etg_xi4</span><span class="p">,</span>   <span class="n">bexp_HtSea</span><span class="p">]</span>
    
    <span class="n">Para_all</span> <span class="o">=</span> <span class="n">ParaManager_Pol</span><span class="p">(</span><span class="n">Paralst</span><span class="p">)</span>
    <span class="c1"># PDF_Et_pred = np.array(list(pool.map(partial(PDF_theo, Para = Para_all), np.array(PDF_data_Et))))</span>
    <span class="n">PDF_Et_pred</span> <span class="o">=</span> <span class="n">PDF_theo</span><span class="p">(</span><span class="n">PDF_data_Et</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_PDF_Et</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">PDF_Et_pred</span> <span class="o">-</span> <span class="n">PDF_data_Et</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">PDF_data_Et</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># tPDF_Et_pred = np.array(list(pool.map(partial(tPDF_theo, Para = Para_all), np.array(tPDF_data_Et))))</span>
    <span class="n">tPDF_Et_pred</span> <span class="o">=</span> <span class="n">tPDF_theo</span><span class="p">(</span><span class="n">tPDF_data_Et</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_tPDF_Et</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">tPDF_Et_pred</span> <span class="o">-</span> <span class="n">tPDF_data_Et</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">tPDF_data_Et</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># GFF_Et_pred = np.array(list(pool.map(partial(GFF_theo, Para = Para_all), np.array(GFF_data_Et))))</span>
    <span class="n">GFF_Et_pred</span> <span class="o">=</span> <span class="n">GFF_theo</span><span class="p">(</span><span class="n">GFF_data_Et</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_all</span><span class="p">)</span>
    <span class="n">cost_GFF_Et</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">GFF_Et_pred</span> <span class="o">-</span> <span class="n">GFF_data_Et</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">GFF_data_Et</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">cost_PDF_Et</span> <span class="o">+</span> <span class="n">cost_tPDF_Et</span> <span class="o">+</span> <span class="n">cost_GFF_Et</span></div>


<div class="viewcode-block" id="forward_Ht_fit">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.forward_Ht_fit">[docs]</a>
<span class="k">def</span> <span class="nf">forward_Ht_fit</span><span class="p">(</span><span class="n">Paralst_Pol</span><span class="p">):</span>

    <span class="p">[</span><span class="n">Norm_HtuV_Init</span><span class="p">,</span>   <span class="n">alpha_HtuV_Init</span><span class="p">,</span>   <span class="n">beta_HtuV_Init</span><span class="p">,</span>   <span class="n">alphap_HtuV_Init</span><span class="p">,</span> 
     <span class="n">Norm_Htubar_Init</span><span class="p">,</span> <span class="n">alpha_Htubar_Init</span><span class="p">,</span> <span class="n">beta_Htubar_Init</span><span class="p">,</span> <span class="n">alphap_Htqbar_Init</span><span class="p">,</span>
     <span class="n">Norm_HtdV_Init</span><span class="p">,</span>   <span class="n">alpha_HtdV_Init</span><span class="p">,</span>   <span class="n">beta_HtdV_Init</span><span class="p">,</span>   <span class="n">alphap_HtdV_Init</span><span class="p">,</span>
     <span class="n">Norm_Htdbar_Init</span><span class="p">,</span> <span class="n">alpha_Htdbar_Init</span><span class="p">,</span> <span class="n">beta_Htdbar_Init</span><span class="p">,</span> 
     <span class="n">Norm_Htg_Init</span><span class="p">,</span>    <span class="n">alpha_Htg_Init</span><span class="p">,</span>    <span class="n">beta_Htg_Init</span><span class="p">,</span>    <span class="n">alphap_Htg_Init</span><span class="p">,</span>
     <span class="n">Norm_EtuV_Init</span><span class="p">,</span>   <span class="n">alpha_EtuV_Init</span><span class="p">,</span>   <span class="n">beta_EtuV_Init</span><span class="p">,</span>   <span class="n">alphap_EtuV_Init</span><span class="p">,</span>
     <span class="n">Norm_EtdV_Init</span><span class="p">,</span>   <span class="n">R_Et_Sea_Init</span><span class="p">,</span>     <span class="n">R_Htu_xi2_Init</span><span class="p">,</span>   <span class="n">R_Htd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Htg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Etu_xi2_Init</span><span class="p">,</span>   <span class="n">R_Etd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Etg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Htu_xi4_Init</span><span class="p">,</span>   <span class="n">R_Htd_xi4_Init</span><span class="p">,</span>    <span class="n">R_Htg_xi4_Init</span><span class="p">,</span>
     <span class="n">R_Etu_xi4_Init</span><span class="p">,</span>   <span class="n">R_Etd_xi4_Init</span><span class="p">,</span>    <span class="n">R_Etg_xi4_Init</span><span class="p">,</span>   <span class="n">bexp_HtSea_Init</span><span class="p">]</span> <span class="o">=</span> <span class="n">Paralst_Pol</span>

    <span class="n">fit_forw_Ht</span> <span class="o">=</span> <span class="n">Minuit</span><span class="p">(</span><span class="n">cost_forward_Ht</span><span class="p">,</span> <span class="n">Norm_HtuV</span> <span class="o">=</span> <span class="n">Norm_HtuV_Init</span><span class="p">,</span>     <span class="n">alpha_HtuV</span> <span class="o">=</span> <span class="n">alpha_HtuV_Init</span><span class="p">,</span>      <span class="n">beta_HtuV</span> <span class="o">=</span> <span class="n">beta_HtuV_Init</span><span class="p">,</span>     <span class="n">alphap_HtuV</span> <span class="o">=</span> <span class="n">alphap_HtuV_Init</span><span class="p">,</span> 
                                          <span class="n">Norm_Htubar</span> <span class="o">=</span> <span class="n">Norm_Htubar_Init</span><span class="p">,</span> <span class="n">alpha_Htubar</span> <span class="o">=</span> <span class="n">alpha_Htubar_Init</span><span class="p">,</span>  <span class="n">beta_Htubar</span> <span class="o">=</span> <span class="n">beta_Htubar_Init</span><span class="p">,</span> <span class="n">alphap_Htqbar</span> <span class="o">=</span> <span class="n">alphap_Htqbar_Init</span><span class="p">,</span>
                                          <span class="n">Norm_HtdV</span> <span class="o">=</span> <span class="n">Norm_HtdV_Init</span><span class="p">,</span>     <span class="n">alpha_HtdV</span> <span class="o">=</span> <span class="n">alpha_HtdV_Init</span><span class="p">,</span>      <span class="n">beta_HtdV</span> <span class="o">=</span> <span class="n">beta_HtdV_Init</span><span class="p">,</span>     <span class="n">alphap_HtdV</span> <span class="o">=</span> <span class="n">alphap_HtdV_Init</span><span class="p">,</span>
                                          <span class="n">Norm_Htdbar</span> <span class="o">=</span> <span class="n">Norm_Htdbar_Init</span><span class="p">,</span> <span class="n">alpha_Htdbar</span> <span class="o">=</span> <span class="n">alpha_Htdbar_Init</span><span class="p">,</span>  <span class="n">beta_Htdbar</span> <span class="o">=</span> <span class="n">beta_Htdbar_Init</span><span class="p">,</span> 
                                          <span class="n">Norm_Htg</span> <span class="o">=</span> <span class="n">Norm_Htg_Init</span><span class="p">,</span>       <span class="n">alpha_Htg</span> <span class="o">=</span> <span class="n">alpha_Htg_Init</span><span class="p">,</span>        <span class="n">beta_Htg</span> <span class="o">=</span> <span class="n">beta_Htg_Init</span><span class="p">,</span>       <span class="n">alphap_Htg</span> <span class="o">=</span> <span class="n">alphap_Htg_Init</span><span class="p">,</span>
                                          <span class="n">Norm_EtuV</span> <span class="o">=</span> <span class="n">Norm_EtuV_Init</span><span class="p">,</span>     <span class="n">alpha_EtuV</span> <span class="o">=</span> <span class="n">alpha_EtuV_Init</span><span class="p">,</span>      <span class="n">beta_EtuV</span> <span class="o">=</span> <span class="n">beta_EtuV_Init</span><span class="p">,</span>     <span class="n">alphap_EtuV</span> <span class="o">=</span> <span class="n">alphap_EtuV_Init</span><span class="p">,</span>
                                          <span class="n">Norm_EtdV</span> <span class="o">=</span> <span class="n">Norm_EtdV_Init</span><span class="p">,</span>     <span class="n">R_Et_Sea</span> <span class="o">=</span> <span class="n">R_Et_Sea_Init</span><span class="p">,</span>          <span class="n">R_Htu_xi2</span> <span class="o">=</span> <span class="n">R_Htu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Htd_xi2</span> <span class="o">=</span> <span class="n">R_Htd_xi2_Init</span><span class="p">,</span>        <span class="n">R_Htg_xi2</span> <span class="o">=</span> <span class="n">R_Htg_xi2_Init</span><span class="p">,</span>
                                          <span class="n">R_Etu_xi2</span> <span class="o">=</span> <span class="n">R_Etu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Etd_xi2</span> <span class="o">=</span> <span class="n">R_Etd_xi2_Init</span><span class="p">,</span>        <span class="n">R_Etg_xi2</span> <span class="o">=</span> <span class="n">R_Etg_xi2_Init</span><span class="p">,</span>
                                          <span class="n">R_Htu_xi4</span> <span class="o">=</span> <span class="n">R_Htu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Htd_xi4</span> <span class="o">=</span> <span class="n">R_Htd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Htg_xi4</span> <span class="o">=</span> <span class="n">R_Htg_xi4_Init</span><span class="p">,</span>
                                          <span class="n">R_Etu_xi4</span> <span class="o">=</span> <span class="n">R_Etu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Etd_xi4</span> <span class="o">=</span> <span class="n">R_Etd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Etg_xi4</span> <span class="o">=</span> <span class="n">R_Etg_xi4_Init</span><span class="p">,</span>     <span class="n">bexp_HtSea</span> <span class="o">=</span> <span class="n">bexp_HtSea_Init</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">errordef</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>

    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Htqbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Et_Sea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htd_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etd_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htd_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etd_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;bexp_HtSea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">global</span> <span class="n">time_start</span> 
    <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">migrad</span><span class="p">()</span>
    <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">hesse</span><span class="p">()</span>

    <span class="n">ndof_Ht</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">PDF_data_Ht</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tPDF_data_Ht</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">GFF_data_Ht</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>  <span class="o">-</span> <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">nfit</span>

    <span class="n">time_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">time_start</span>    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMP_Output/Ht_forward_fit.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total running time: </span><span class="si">%.1f</span><span class="s1"> minutes. Total call of cost function: </span><span class="si">%3d</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">time_end</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">nfcn</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The chi squared/d.o.f. is: </span><span class="si">%.2f</span><span class="s1"> / </span><span class="si">%3d</span><span class="s1"> ( = </span><span class="si">%.2f</span><span class="s1"> ).</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fval</span><span class="p">,</span> <span class="n">ndof_Ht</span><span class="p">,</span> <span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">fval</span><span class="o">/</span><span class="n">ndof_Ht</span><span class="p">),</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Below are the final output parameters from iMinuit:&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s2">&quot;GUMP_Output/Ht_forward_cov.csv&quot;</span><span class="p">),</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">my_csv</span><span class="p">:</span>
        <span class="n">csvWriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">my_csv</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">csvWriter</span><span class="o">.</span><span class="n">writerows</span><span class="p">([</span><span class="o">*</span><span class="n">fit_forw_Ht</span><span class="o">.</span><span class="n">covariance</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ht fit finished...&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fit_forw_Ht</span></div>


<div class="viewcode-block" id="forward_Et_fit">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.forward_Et_fit">[docs]</a>
<span class="k">def</span> <span class="nf">forward_Et_fit</span><span class="p">(</span><span class="n">Paralst_Pol</span><span class="p">):</span>
    
    <span class="p">[</span><span class="n">Norm_HtuV_Init</span><span class="p">,</span>   <span class="n">alpha_HtuV_Init</span><span class="p">,</span>   <span class="n">beta_HtuV_Init</span><span class="p">,</span>   <span class="n">alphap_HtuV_Init</span><span class="p">,</span> 
     <span class="n">Norm_Htubar_Init</span><span class="p">,</span> <span class="n">alpha_Htubar_Init</span><span class="p">,</span> <span class="n">beta_Htubar_Init</span><span class="p">,</span> <span class="n">alphap_Htqbar_Init</span><span class="p">,</span>
     <span class="n">Norm_HtdV_Init</span><span class="p">,</span>   <span class="n">alpha_HtdV_Init</span><span class="p">,</span>   <span class="n">beta_HtdV_Init</span><span class="p">,</span>   <span class="n">alphap_HtdV_Init</span><span class="p">,</span>
     <span class="n">Norm_Htdbar_Init</span><span class="p">,</span> <span class="n">alpha_Htdbar_Init</span><span class="p">,</span> <span class="n">beta_Htdbar_Init</span><span class="p">,</span> 
     <span class="n">Norm_Htg_Init</span><span class="p">,</span>    <span class="n">alpha_Htg_Init</span><span class="p">,</span>    <span class="n">beta_Htg_Init</span><span class="p">,</span>    <span class="n">alphap_Htg_Init</span><span class="p">,</span>
     <span class="n">Norm_EtuV_Init</span><span class="p">,</span>   <span class="n">alpha_EtuV_Init</span><span class="p">,</span>   <span class="n">beta_EtuV_Init</span><span class="p">,</span>   <span class="n">alphap_EtuV_Init</span><span class="p">,</span>
     <span class="n">Norm_EtdV_Init</span><span class="p">,</span>   <span class="n">R_Et_Sea_Init</span><span class="p">,</span>     <span class="n">R_Htu_xi2_Init</span><span class="p">,</span>   <span class="n">R_Htd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Htg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Etu_xi2_Init</span><span class="p">,</span>   <span class="n">R_Etd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Etg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Htu_xi4_Init</span><span class="p">,</span>   <span class="n">R_Htd_xi4_Init</span><span class="p">,</span>    <span class="n">R_Htg_xi4_Init</span><span class="p">,</span>
     <span class="n">R_Etu_xi4_Init</span><span class="p">,</span>   <span class="n">R_Etd_xi4_Init</span><span class="p">,</span>    <span class="n">R_Etg_xi4_Init</span><span class="p">,</span>   <span class="n">bexp_HtSea_Init</span><span class="p">]</span> <span class="o">=</span> <span class="n">Paralst_Pol</span>

    <span class="n">fit_forw_Et</span> <span class="o">=</span> <span class="n">Minuit</span><span class="p">(</span><span class="n">cost_forward_Et</span><span class="p">,</span> <span class="n">Norm_HtuV</span> <span class="o">=</span> <span class="n">Norm_HtuV_Init</span><span class="p">,</span>     <span class="n">alpha_HtuV</span> <span class="o">=</span> <span class="n">alpha_HtuV_Init</span><span class="p">,</span>      <span class="n">beta_HtuV</span> <span class="o">=</span> <span class="n">beta_HtuV_Init</span><span class="p">,</span>     <span class="n">alphap_HtuV</span> <span class="o">=</span> <span class="n">alphap_HtuV_Init</span><span class="p">,</span> 
                                          <span class="n">Norm_Htubar</span> <span class="o">=</span> <span class="n">Norm_Htubar_Init</span><span class="p">,</span> <span class="n">alpha_Htubar</span> <span class="o">=</span> <span class="n">alpha_Htubar_Init</span><span class="p">,</span>  <span class="n">beta_Htubar</span> <span class="o">=</span> <span class="n">beta_Htubar_Init</span><span class="p">,</span> <span class="n">alphap_Htqbar</span> <span class="o">=</span> <span class="n">alphap_Htqbar_Init</span><span class="p">,</span>
                                          <span class="n">Norm_HtdV</span> <span class="o">=</span> <span class="n">Norm_HtdV_Init</span><span class="p">,</span>     <span class="n">alpha_HtdV</span> <span class="o">=</span> <span class="n">alpha_HtdV_Init</span><span class="p">,</span>      <span class="n">beta_HtdV</span> <span class="o">=</span> <span class="n">beta_HtdV_Init</span><span class="p">,</span>     <span class="n">alphap_HtdV</span> <span class="o">=</span> <span class="n">alphap_HtdV_Init</span><span class="p">,</span>
                                          <span class="n">Norm_Htdbar</span> <span class="o">=</span> <span class="n">Norm_Htdbar_Init</span><span class="p">,</span> <span class="n">alpha_Htdbar</span> <span class="o">=</span> <span class="n">alpha_Htdbar_Init</span><span class="p">,</span>  <span class="n">beta_Htdbar</span> <span class="o">=</span> <span class="n">beta_Htdbar_Init</span><span class="p">,</span> 
                                          <span class="n">Norm_Htg</span> <span class="o">=</span> <span class="n">Norm_Htg_Init</span><span class="p">,</span>       <span class="n">alpha_Htg</span> <span class="o">=</span> <span class="n">alpha_Htg_Init</span><span class="p">,</span>        <span class="n">beta_Htg</span> <span class="o">=</span> <span class="n">beta_Htg_Init</span><span class="p">,</span>       <span class="n">alphap_Htg</span> <span class="o">=</span> <span class="n">alphap_Htg_Init</span><span class="p">,</span>
                                          <span class="n">Norm_EtuV</span> <span class="o">=</span> <span class="n">Norm_EtuV_Init</span><span class="p">,</span>     <span class="n">alpha_EtuV</span> <span class="o">=</span> <span class="n">alpha_EtuV_Init</span><span class="p">,</span>      <span class="n">beta_EtuV</span> <span class="o">=</span> <span class="n">beta_EtuV_Init</span><span class="p">,</span>     <span class="n">alphap_EtuV</span> <span class="o">=</span> <span class="n">alphap_EtuV_Init</span><span class="p">,</span>
                                          <span class="n">Norm_EtdV</span> <span class="o">=</span> <span class="n">Norm_EtdV_Init</span><span class="p">,</span>     <span class="n">R_Et_Sea</span> <span class="o">=</span> <span class="n">R_Et_Sea_Init</span><span class="p">,</span>          <span class="n">R_Htu_xi2</span> <span class="o">=</span> <span class="n">R_Htu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Htd_xi2</span> <span class="o">=</span> <span class="n">R_Htd_xi2_Init</span><span class="p">,</span>     <span class="n">R_Htg_xi2</span> <span class="o">=</span> <span class="n">R_Htg_xi2_Init</span><span class="p">,</span>
                                          <span class="n">R_Etu_xi2</span> <span class="o">=</span> <span class="n">R_Etu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Etd_xi2</span> <span class="o">=</span> <span class="n">R_Etd_xi2_Init</span><span class="p">,</span>        <span class="n">R_Etg_xi2</span> <span class="o">=</span> <span class="n">R_Etg_xi2_Init</span><span class="p">,</span>
                                          <span class="n">R_Htu_xi4</span> <span class="o">=</span> <span class="n">R_Htu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Htd_xi4</span> <span class="o">=</span> <span class="n">R_Htd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Htg_xi4</span> <span class="o">=</span> <span class="n">R_Htg_xi4_Init</span><span class="p">,</span>
                                          <span class="n">R_Etu_xi4</span> <span class="o">=</span> <span class="n">R_Etu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Etd_xi4</span> <span class="o">=</span> <span class="n">R_Etd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Etg_xi4</span> <span class="o">=</span> <span class="n">R_Etg_xi4_Init</span><span class="p">,</span>     <span class="n">bexp_HtSea</span> <span class="o">=</span> <span class="n">bexp_HtSea_Init</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">errordef</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;beta_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Htqbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htd_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etd_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htd_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etd_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;bexp_HtSea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">global</span> <span class="n">time_start</span>
    <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">migrad</span><span class="p">()</span>
    <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">hesse</span><span class="p">()</span>

    <span class="n">ndof_Et</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">PDF_data_Et</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tPDF_data_Et</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">GFF_data_Et</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>  <span class="o">-</span> <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">nfit</span>

    <span class="n">time_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">time_start</span>    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMP_Output/Et_forward_fit.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total running time: </span><span class="si">%.1f</span><span class="s1"> minutes. Total call of cost function: </span><span class="si">%3d</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">time_end</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">nfcn</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The chi squared/d.o.f. is: </span><span class="si">%.2f</span><span class="s1"> / </span><span class="si">%3d</span><span class="s1"> ( = </span><span class="si">%.2f</span><span class="s1"> ).</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fval</span><span class="p">,</span> <span class="n">ndof_Et</span><span class="p">,</span> <span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">fval</span><span class="o">/</span><span class="n">ndof_Et</span><span class="p">),</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Below are the final output parameters from iMinuit:&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s2">&quot;GUMP_Output/Et_forward_cov.csv&quot;</span><span class="p">),</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">my_csv</span><span class="p">:</span>
        <span class="n">csvWriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">my_csv</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">csvWriter</span><span class="o">.</span><span class="n">writerows</span><span class="p">([</span><span class="o">*</span><span class="n">fit_forw_Et</span><span class="o">.</span><span class="n">covariance</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Et fit finished...&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fit_forw_Et</span></div>


<div class="viewcode-block" id="cost_off_forward">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.cost_off_forward">[docs]</a>
<span class="k">def</span> <span class="nf">cost_off_forward</span><span class="p">(</span><span class="n">Norm_HuV</span><span class="p">,</span>    <span class="n">alpha_HuV</span><span class="p">,</span>    <span class="n">beta_HuV</span><span class="p">,</span>    <span class="n">alphap_HuV</span><span class="p">,</span> 
                     <span class="n">Norm_Hubar</span><span class="p">,</span>  <span class="n">alpha_Hubar</span><span class="p">,</span>  <span class="n">beta_Hubar</span><span class="p">,</span>  <span class="n">alphap_Hqbar</span><span class="p">,</span>
                     <span class="n">Norm_HdV</span><span class="p">,</span>    <span class="n">alpha_HdV</span><span class="p">,</span>    <span class="n">beta_HdV</span><span class="p">,</span>    <span class="n">alphap_HdV</span><span class="p">,</span>
                     <span class="n">Norm_Hdbar</span><span class="p">,</span>  <span class="n">alpha_Hdbar</span><span class="p">,</span>  <span class="n">beta_Hdbar</span><span class="p">,</span> 
                     <span class="n">Norm_Hg</span><span class="p">,</span>     <span class="n">alpha_Hg</span><span class="p">,</span>     <span class="n">beta_Hg</span><span class="p">,</span>     <span class="n">alphap_Hg</span><span class="p">,</span>
                     <span class="n">Norm_EuV</span><span class="p">,</span>    <span class="n">alpha_EuV</span><span class="p">,</span>    <span class="n">beta_EuV</span><span class="p">,</span>    <span class="n">alphap_EuV</span><span class="p">,</span>
                     <span class="n">Norm_EdV</span><span class="p">,</span>    <span class="n">R_E_Sea</span><span class="p">,</span>      <span class="n">R_Hu_xi2</span><span class="p">,</span>    <span class="n">R_Hd_xi2</span><span class="p">,</span>    <span class="n">R_Hg_xi2</span><span class="p">,</span>
                     <span class="n">R_Eu_xi2</span><span class="p">,</span>    <span class="n">R_Ed_xi2</span><span class="p">,</span>     <span class="n">R_Eg_xi2</span><span class="p">,</span>
                     <span class="n">R_Hu_xi4</span><span class="p">,</span>    <span class="n">R_Hd_xi4</span><span class="p">,</span>     <span class="n">R_Hg_xi4</span><span class="p">,</span>
                     <span class="n">R_Eu_xi4</span><span class="p">,</span>    <span class="n">R_Ed_xi4</span><span class="p">,</span>     <span class="n">R_Eg_xi4</span><span class="p">,</span>    <span class="n">bexp_HSea</span><span class="p">,</span> <span class="n">bexp_Hg</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span>
                     <span class="n">Norm_HtuV</span><span class="p">,</span>   <span class="n">alpha_HtuV</span><span class="p">,</span>   <span class="n">beta_HtuV</span><span class="p">,</span>   <span class="n">alphap_HtuV</span><span class="p">,</span> 
                     <span class="n">Norm_Htubar</span><span class="p">,</span> <span class="n">alpha_Htubar</span><span class="p">,</span> <span class="n">beta_Htubar</span><span class="p">,</span> <span class="n">alphap_Htqbar</span><span class="p">,</span>
                     <span class="n">Norm_HtdV</span><span class="p">,</span>   <span class="n">alpha_HtdV</span><span class="p">,</span>   <span class="n">beta_HtdV</span><span class="p">,</span>   <span class="n">alphap_HtdV</span><span class="p">,</span>
                     <span class="n">Norm_Htdbar</span><span class="p">,</span> <span class="n">alpha_Htdbar</span><span class="p">,</span> <span class="n">beta_Htdbar</span><span class="p">,</span> 
                     <span class="n">Norm_Htg</span><span class="p">,</span>    <span class="n">alpha_Htg</span><span class="p">,</span>    <span class="n">beta_Htg</span><span class="p">,</span>    <span class="n">alphap_Htg</span><span class="p">,</span>
                     <span class="n">Norm_EtuV</span><span class="p">,</span>   <span class="n">alpha_EtuV</span><span class="p">,</span>   <span class="n">beta_EtuV</span><span class="p">,</span>   <span class="n">alphap_EtuV</span><span class="p">,</span>
                     <span class="n">Norm_EtdV</span><span class="p">,</span>   <span class="n">R_Et_Sea</span><span class="p">,</span>     <span class="n">R_Htu_xi2</span><span class="p">,</span>   <span class="n">R_Htd_xi2</span><span class="p">,</span>    <span class="n">R_Htg_xi2</span><span class="p">,</span>
                     <span class="n">R_Etu_xi2</span><span class="p">,</span>   <span class="n">R_Etd_xi2</span><span class="p">,</span>    <span class="n">R_Etg_xi2</span><span class="p">,</span>
                     <span class="n">R_Htu_xi4</span><span class="p">,</span>   <span class="n">R_Htd_xi4</span><span class="p">,</span>    <span class="n">R_Htg_xi4</span><span class="p">,</span>
                     <span class="n">R_Etu_xi4</span><span class="p">,</span>   <span class="n">R_Etd_xi4</span><span class="p">,</span>    <span class="n">R_Etg_xi4</span><span class="p">,</span>   <span class="n">bexp_HtSea</span><span class="p">):</span>

    <span class="k">global</span> <span class="n">Minuit_Counter</span><span class="p">,</span> <span class="n">Time_Counter</span>

    <span class="n">time_now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_start</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">time_now</span> <span class="o">&gt;</span> <span class="n">Time_Counter</span> <span class="o">*</span> <span class="mi">600</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Runing Time:&#39;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">time_now</span><span class="o">/</span><span class="mi">60</span><span class="p">),</span><span class="s1">&#39;minutes. Cost function called total&#39;</span><span class="p">,</span> <span class="n">Minuit_Counter</span><span class="p">,</span> <span class="s1">&#39;times.&#39;</span><span class="p">)</span>
        <span class="n">Time_Counter</span> <span class="o">=</span> <span class="n">Time_Counter</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="n">Minuit_Counter</span> <span class="o">=</span> <span class="n">Minuit_Counter</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">Para_Unp_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">Norm_HuV</span><span class="p">,</span>    <span class="n">alpha_HuV</span><span class="p">,</span>    <span class="n">beta_HuV</span><span class="p">,</span>    <span class="n">alphap_HuV</span><span class="p">,</span> 
                    <span class="n">Norm_Hubar</span><span class="p">,</span>  <span class="n">alpha_Hubar</span><span class="p">,</span>  <span class="n">beta_Hubar</span><span class="p">,</span>  <span class="n">alphap_Hqbar</span><span class="p">,</span>
                    <span class="n">Norm_HdV</span><span class="p">,</span>    <span class="n">alpha_HdV</span><span class="p">,</span>    <span class="n">beta_HdV</span><span class="p">,</span>    <span class="n">alphap_HdV</span><span class="p">,</span>
                    <span class="n">Norm_Hdbar</span><span class="p">,</span>  <span class="n">alpha_Hdbar</span><span class="p">,</span>  <span class="n">beta_Hdbar</span><span class="p">,</span> 
                    <span class="n">Norm_Hg</span><span class="p">,</span>     <span class="n">alpha_Hg</span><span class="p">,</span>     <span class="n">beta_Hg</span><span class="p">,</span>     <span class="n">alphap_Hg</span><span class="p">,</span>
                    <span class="n">Norm_EuV</span><span class="p">,</span>    <span class="n">alpha_EuV</span><span class="p">,</span>    <span class="n">beta_EuV</span><span class="p">,</span>    <span class="n">alphap_EuV</span><span class="p">,</span>
                    <span class="n">Norm_EdV</span><span class="p">,</span>    <span class="n">R_E_Sea</span><span class="p">,</span>      <span class="n">R_Hu_xi2</span><span class="p">,</span>    <span class="n">R_Hd_xi2</span><span class="p">,</span>    <span class="n">R_Hg_xi2</span><span class="p">,</span>
                    <span class="n">R_Eu_xi2</span><span class="p">,</span>    <span class="n">R_Ed_xi2</span><span class="p">,</span>     <span class="n">R_Eg_xi2</span><span class="p">,</span>
                    <span class="n">R_Hu_xi4</span><span class="p">,</span>    <span class="n">R_Hd_xi4</span><span class="p">,</span>     <span class="n">R_Hg_xi4</span><span class="p">,</span>
                    <span class="n">R_Eu_xi4</span><span class="p">,</span>    <span class="n">R_Ed_xi4</span><span class="p">,</span>     <span class="n">R_Eg_xi4</span><span class="p">,</span>    <span class="n">bexp_HSea</span><span class="p">,</span> <span class="n">bexp_Hg</span><span class="p">,</span> <span class="n">norm</span><span class="p">]</span>

    <span class="n">Para_Pol_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">Norm_HtuV</span><span class="p">,</span>   <span class="n">alpha_HtuV</span><span class="p">,</span>   <span class="n">beta_HtuV</span><span class="p">,</span>   <span class="n">alphap_HtuV</span><span class="p">,</span> 
                    <span class="n">Norm_Htubar</span><span class="p">,</span> <span class="n">alpha_Htubar</span><span class="p">,</span> <span class="n">beta_Htubar</span><span class="p">,</span> <span class="n">alphap_Htqbar</span><span class="p">,</span>
                    <span class="n">Norm_HtdV</span><span class="p">,</span>   <span class="n">alpha_HtdV</span><span class="p">,</span>   <span class="n">beta_HtdV</span><span class="p">,</span>   <span class="n">alphap_HtdV</span><span class="p">,</span>
                    <span class="n">Norm_Htdbar</span><span class="p">,</span> <span class="n">alpha_Htdbar</span><span class="p">,</span> <span class="n">beta_Htdbar</span><span class="p">,</span> 
                    <span class="n">Norm_Htg</span><span class="p">,</span>    <span class="n">alpha_Htg</span><span class="p">,</span>    <span class="n">beta_Htg</span><span class="p">,</span>    <span class="n">alphap_Htg</span><span class="p">,</span>
                    <span class="n">Norm_EtuV</span><span class="p">,</span>   <span class="n">alpha_EtuV</span><span class="p">,</span>   <span class="n">beta_EtuV</span><span class="p">,</span>   <span class="n">alphap_EtuV</span><span class="p">,</span>
                    <span class="n">Norm_EtdV</span><span class="p">,</span>   <span class="n">R_Et_Sea</span><span class="p">,</span>     <span class="n">R_Htu_xi2</span><span class="p">,</span>   <span class="n">R_Htd_xi2</span><span class="p">,</span>    <span class="n">R_Htg_xi2</span><span class="p">,</span>
                    <span class="n">R_Etu_xi2</span><span class="p">,</span>   <span class="n">R_Etd_xi2</span><span class="p">,</span>    <span class="n">R_Etg_xi2</span><span class="p">,</span>
                    <span class="n">R_Htu_xi4</span><span class="p">,</span>   <span class="n">R_Htd_xi4</span><span class="p">,</span>    <span class="n">R_Htg_xi4</span><span class="p">,</span>
                    <span class="n">R_Etu_xi4</span><span class="p">,</span>   <span class="n">R_Etd_xi4</span><span class="p">,</span>    <span class="n">R_Etg_xi4</span><span class="p">,</span>   <span class="n">bexp_HtSea</span><span class="p">]</span>
        
    <span class="n">Para_Unp_all</span> <span class="o">=</span> <span class="n">ParaManager_Unp</span><span class="p">(</span><span class="n">Para_Unp_lst</span><span class="p">)</span>
    <span class="n">Para_Pol_all</span> <span class="o">=</span> <span class="n">ParaManager_Pol</span><span class="p">(</span><span class="n">Para_Pol_lst</span><span class="p">)</span>

    <span class="n">cost_DVCS_xBtQ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">DVCSxsec_cost_xBtQ</span><span class="p">,</span> <span class="n">Para_Unp</span> <span class="o">=</span> <span class="n">Para_Unp_all</span><span class="p">,</span> <span class="n">Para_Pol</span> <span class="o">=</span> <span class="n">Para_Pol_all</span><span class="p">),</span> <span class="n">DVCSxsec_group_data</span><span class="p">)))</span>
    <span class="n">cost_DVCSxsec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cost_DVCS_xBtQ</span><span class="p">)</span>
    
    <span class="n">cost_DVCS_HERA_xBtQ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">DVCSxsec_HERA_cost_xBtQ</span><span class="p">,</span> <span class="n">Para_Unp</span> <span class="o">=</span> <span class="n">Para_Unp_all</span><span class="p">,</span> <span class="n">Para_Pol</span> <span class="o">=</span> <span class="n">Para_Pol_all</span><span class="p">),</span> <span class="n">DVCSxsec_HERA_group_data</span><span class="p">)))</span>
    <span class="n">cost_DVCSxsec_HERA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cost_DVCS_HERA_xBtQ</span><span class="p">)</span>

    <span class="c1"># DVCS_HERA_pred = np.array(list(pool.map(partial(DVCSxsec_HERA_theo, Para_Unp = Para_Unp_all, Para_Pol = Para_Pol_all), np.array(DVCS_HERA_data))))</span>
    <span class="c1">#DVCS_HERA_pred = DVCSxsec_HERA_theo(DVCS_HERA_data, Para_Unp=Para_Unp_all, Para_Pol=Para_Pol_all)</span>
    <span class="c1">#cost_DVCS_HERA = np.sum(((DVCS_HERA_pred - DVCS_HERA_data[&#39;f&#39;])/ DVCS_HERA_data[&#39;delta f&#39;]) ** 2 )</span>

    <span class="k">return</span>  <span class="n">cost_DVCSxsec</span> <span class="o">+</span> <span class="n">cost_DVCSxsec_HERA</span></div>




<div class="viewcode-block" id="off_forward_fit">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.off_forward_fit">[docs]</a>
<span class="k">def</span> <span class="nf">off_forward_fit</span><span class="p">(</span><span class="n">Paralst_Unp</span><span class="p">,</span> <span class="n">Paralst_Pol</span><span class="p">):</span>

    <span class="p">[</span><span class="n">Norm_HuV_Init</span><span class="p">,</span>    <span class="n">alpha_HuV_Init</span><span class="p">,</span>    <span class="n">beta_HuV_Init</span><span class="p">,</span>    <span class="n">alphap_HuV_Init</span><span class="p">,</span> 
     <span class="n">Norm_Hubar_Init</span><span class="p">,</span>  <span class="n">alpha_Hubar_Init</span><span class="p">,</span>  <span class="n">beta_Hubar_Init</span><span class="p">,</span>  <span class="n">alphap_Hqbar_Init</span><span class="p">,</span>
     <span class="n">Norm_HdV_Init</span><span class="p">,</span>    <span class="n">alpha_HdV_Init</span><span class="p">,</span>    <span class="n">beta_HdV_Init</span><span class="p">,</span>    <span class="n">alphap_HdV_Init</span><span class="p">,</span>
     <span class="n">Norm_Hdbar_Init</span><span class="p">,</span>  <span class="n">alpha_Hdbar_Init</span><span class="p">,</span>  <span class="n">beta_Hdbar_Init</span><span class="p">,</span> 
     <span class="n">Norm_Hg_Init</span><span class="p">,</span>     <span class="n">alpha_Hg_Init</span><span class="p">,</span>     <span class="n">beta_Hg_Init</span><span class="p">,</span>     <span class="n">alphap_Hg_Init</span><span class="p">,</span>
     <span class="n">Norm_EuV_Init</span><span class="p">,</span>    <span class="n">alpha_EuV_Init</span><span class="p">,</span>    <span class="n">beta_EuV_Init</span><span class="p">,</span>    <span class="n">alphap_EuV_Init</span><span class="p">,</span>
     <span class="n">Norm_EdV_Init</span><span class="p">,</span>    <span class="n">R_E_Sea_Init</span><span class="p">,</span>      <span class="n">R_Hu_xi2_Init</span><span class="p">,</span>    <span class="n">R_Hd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Hg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Eu_xi2_Init</span><span class="p">,</span>    <span class="n">R_Ed_xi2_Init</span><span class="p">,</span>     <span class="n">R_Eg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Hu_xi4_Init</span><span class="p">,</span>    <span class="n">R_Hd_xi4_Init</span><span class="p">,</span>     <span class="n">R_Hg_xi4_Init</span><span class="p">,</span>
     <span class="n">R_Eu_xi4_Init</span><span class="p">,</span>    <span class="n">R_Ed_xi4_Init</span><span class="p">,</span>     <span class="n">R_Eg_xi4_Init</span><span class="p">,</span>    <span class="n">bexp_HSea_Init</span><span class="p">,</span> <span class="n">bexp_Hg_Init</span><span class="p">,</span> <span class="n">norm_Init</span><span class="p">]</span> <span class="o">=</span> <span class="n">Paralst_Unp</span>

    <span class="p">[</span><span class="n">Norm_HtuV_Init</span><span class="p">,</span>   <span class="n">alpha_HtuV_Init</span><span class="p">,</span>   <span class="n">beta_HtuV_Init</span><span class="p">,</span>   <span class="n">alphap_HtuV_Init</span><span class="p">,</span> 
     <span class="n">Norm_Htubar_Init</span><span class="p">,</span> <span class="n">alpha_Htubar_Init</span><span class="p">,</span> <span class="n">beta_Htubar_Init</span><span class="p">,</span> <span class="n">alphap_Htqbar_Init</span><span class="p">,</span>
     <span class="n">Norm_HtdV_Init</span><span class="p">,</span>   <span class="n">alpha_HtdV_Init</span><span class="p">,</span>   <span class="n">beta_HtdV_Init</span><span class="p">,</span>   <span class="n">alphap_HtdV_Init</span><span class="p">,</span>
     <span class="n">Norm_Htdbar_Init</span><span class="p">,</span> <span class="n">alpha_Htdbar_Init</span><span class="p">,</span> <span class="n">beta_Htdbar_Init</span><span class="p">,</span> 
     <span class="n">Norm_Htg_Init</span><span class="p">,</span>    <span class="n">alpha_Htg_Init</span><span class="p">,</span>    <span class="n">beta_Htg_Init</span><span class="p">,</span>    <span class="n">alphap_Htg_Init</span><span class="p">,</span>
     <span class="n">Norm_EtuV_Init</span><span class="p">,</span>   <span class="n">alpha_EtuV_Init</span><span class="p">,</span>   <span class="n">beta_EtuV_Init</span><span class="p">,</span>   <span class="n">alphap_EtuV_Init</span><span class="p">,</span>
     <span class="n">Norm_EtdV_Init</span><span class="p">,</span>   <span class="n">R_Et_Sea_Init</span><span class="p">,</span>     <span class="n">R_Htu_xi2_Init</span><span class="p">,</span>   <span class="n">R_Htd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Htg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Etu_xi2_Init</span><span class="p">,</span>   <span class="n">R_Etd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Etg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Htu_xi4_Init</span><span class="p">,</span>   <span class="n">R_Htd_xi4_Init</span><span class="p">,</span>    <span class="n">R_Htg_xi4_Init</span><span class="p">,</span>
     <span class="n">R_Etu_xi4_Init</span><span class="p">,</span>   <span class="n">R_Etd_xi4_Init</span><span class="p">,</span>    <span class="n">R_Etg_xi4_Init</span><span class="p">,</span>   <span class="n">bexp_HtSea_Init</span><span class="p">]</span> <span class="o">=</span> <span class="n">Paralst_Pol</span>

    <span class="n">fit_off_forward</span> <span class="o">=</span> <span class="n">Minuit</span><span class="p">(</span><span class="n">cost_off_forward</span><span class="p">,</span> <span class="n">Norm_HuV</span> <span class="o">=</span> <span class="n">Norm_HuV_Init</span><span class="p">,</span>     <span class="n">alpha_HuV</span> <span class="o">=</span> <span class="n">alpha_HuV_Init</span><span class="p">,</span>      <span class="n">beta_HuV</span> <span class="o">=</span> <span class="n">beta_HuV_Init</span><span class="p">,</span>     <span class="n">alphap_HuV</span> <span class="o">=</span> <span class="n">alphap_HuV_Init</span><span class="p">,</span> 
                                               <span class="n">Norm_Hubar</span> <span class="o">=</span> <span class="n">Norm_Hubar_Init</span><span class="p">,</span> <span class="n">alpha_Hubar</span> <span class="o">=</span> <span class="n">alpha_Hubar_Init</span><span class="p">,</span>  <span class="n">beta_Hubar</span> <span class="o">=</span> <span class="n">beta_Hubar_Init</span><span class="p">,</span> <span class="n">alphap_Hqbar</span> <span class="o">=</span> <span class="n">alphap_Hqbar_Init</span><span class="p">,</span>
                                               <span class="n">Norm_HdV</span> <span class="o">=</span> <span class="n">Norm_HdV_Init</span><span class="p">,</span>     <span class="n">alpha_HdV</span> <span class="o">=</span> <span class="n">alpha_HdV_Init</span><span class="p">,</span>      <span class="n">beta_HdV</span> <span class="o">=</span> <span class="n">beta_HdV_Init</span><span class="p">,</span>     <span class="n">alphap_HdV</span> <span class="o">=</span> <span class="n">alphap_HdV_Init</span><span class="p">,</span>
                                               <span class="n">Norm_Hdbar</span> <span class="o">=</span> <span class="n">Norm_Hdbar_Init</span><span class="p">,</span> <span class="n">alpha_Hdbar</span> <span class="o">=</span> <span class="n">alpha_Hdbar_Init</span><span class="p">,</span>  <span class="n">beta_Hdbar</span> <span class="o">=</span> <span class="n">beta_Hdbar_Init</span><span class="p">,</span> 
                                               <span class="n">Norm_Hg</span> <span class="o">=</span> <span class="n">Norm_Hg_Init</span><span class="p">,</span>       <span class="n">alpha_Hg</span> <span class="o">=</span> <span class="n">alpha_Hg_Init</span><span class="p">,</span>        <span class="n">beta_Hg</span> <span class="o">=</span> <span class="n">beta_Hg_Init</span><span class="p">,</span>       <span class="n">alphap_Hg</span> <span class="o">=</span> <span class="n">alphap_Hg_Init</span><span class="p">,</span>
                                               <span class="n">Norm_EuV</span> <span class="o">=</span> <span class="n">Norm_EuV_Init</span><span class="p">,</span>     <span class="n">alpha_EuV</span> <span class="o">=</span> <span class="n">alpha_EuV_Init</span><span class="p">,</span>      <span class="n">beta_EuV</span> <span class="o">=</span> <span class="n">beta_EuV_Init</span><span class="p">,</span>     <span class="n">alphap_EuV</span> <span class="o">=</span> <span class="n">alphap_EuV_Init</span><span class="p">,</span> 
                                               <span class="n">Norm_EdV</span> <span class="o">=</span> <span class="n">Norm_EdV_Init</span><span class="p">,</span>     <span class="n">R_E_Sea</span> <span class="o">=</span> <span class="n">R_E_Sea_Init</span><span class="p">,</span>          <span class="n">R_Hu_xi2</span> <span class="o">=</span> <span class="n">R_Hu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Hd_xi2</span> <span class="o">=</span> <span class="n">R_Hd_xi2_Init</span><span class="p">,</span>     <span class="n">R_Hg_xi2</span> <span class="o">=</span> <span class="n">R_Hg_xi2_Init</span><span class="p">,</span>
                                               <span class="n">R_Eu_xi2</span> <span class="o">=</span> <span class="n">R_Eu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Ed_xi2</span> <span class="o">=</span> <span class="n">R_Ed_xi2_Init</span><span class="p">,</span>        <span class="n">R_Eg_xi2</span> <span class="o">=</span> <span class="n">R_Eg_xi2_Init</span><span class="p">,</span>
                                               <span class="n">R_Hu_xi4</span> <span class="o">=</span> <span class="n">R_Hu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Hd_xi4</span> <span class="o">=</span> <span class="n">R_Hd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Hg_xi4</span> <span class="o">=</span> <span class="n">R_Hg_xi4_Init</span><span class="p">,</span>
                                               <span class="n">R_Eu_xi4</span> <span class="o">=</span> <span class="n">R_Eu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Ed_xi4</span> <span class="o">=</span> <span class="n">R_Ed_xi4_Init</span><span class="p">,</span>        <span class="n">R_Eg_xi4</span> <span class="o">=</span> <span class="n">R_Eg_xi4_Init</span><span class="p">,</span>     <span class="n">bexp_HSea</span> <span class="o">=</span> <span class="n">bexp_HSea_Init</span><span class="p">,</span> <span class="n">bexp_Hg</span> <span class="o">=</span> <span class="n">bexp_Hg_Init</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">norm_Init</span><span class="p">,</span>
                                               <span class="n">Norm_HtuV</span> <span class="o">=</span> <span class="n">Norm_HtuV_Init</span><span class="p">,</span>     <span class="n">alpha_HtuV</span> <span class="o">=</span> <span class="n">alpha_HtuV_Init</span><span class="p">,</span>      <span class="n">beta_HtuV</span> <span class="o">=</span> <span class="n">beta_HtuV_Init</span><span class="p">,</span>     <span class="n">alphap_HtuV</span> <span class="o">=</span> <span class="n">alphap_HtuV_Init</span><span class="p">,</span> 
                                               <span class="n">Norm_Htubar</span> <span class="o">=</span> <span class="n">Norm_Htubar_Init</span><span class="p">,</span> <span class="n">alpha_Htubar</span> <span class="o">=</span> <span class="n">alpha_Htubar_Init</span><span class="p">,</span>  <span class="n">beta_Htubar</span> <span class="o">=</span> <span class="n">beta_Htubar_Init</span><span class="p">,</span> <span class="n">alphap_Htqbar</span> <span class="o">=</span> <span class="n">alphap_Htqbar_Init</span><span class="p">,</span>
                                               <span class="n">Norm_HtdV</span> <span class="o">=</span> <span class="n">Norm_HtdV_Init</span><span class="p">,</span>     <span class="n">alpha_HtdV</span> <span class="o">=</span> <span class="n">alpha_HtdV_Init</span><span class="p">,</span>      <span class="n">beta_HtdV</span> <span class="o">=</span> <span class="n">beta_HtdV_Init</span><span class="p">,</span>     <span class="n">alphap_HtdV</span> <span class="o">=</span> <span class="n">alphap_HtdV_Init</span><span class="p">,</span>
                                               <span class="n">Norm_Htdbar</span> <span class="o">=</span> <span class="n">Norm_Htdbar_Init</span><span class="p">,</span> <span class="n">alpha_Htdbar</span> <span class="o">=</span> <span class="n">alpha_Htdbar_Init</span><span class="p">,</span>  <span class="n">beta_Htdbar</span> <span class="o">=</span> <span class="n">beta_Htdbar_Init</span><span class="p">,</span> 
                                               <span class="n">Norm_Htg</span> <span class="o">=</span> <span class="n">Norm_Htg_Init</span><span class="p">,</span>       <span class="n">alpha_Htg</span> <span class="o">=</span> <span class="n">alpha_Htg_Init</span><span class="p">,</span>        <span class="n">beta_Htg</span> <span class="o">=</span> <span class="n">beta_Htg_Init</span><span class="p">,</span>       <span class="n">alphap_Htg</span> <span class="o">=</span> <span class="n">alphap_Htg_Init</span><span class="p">,</span>
                                               <span class="n">Norm_EtuV</span> <span class="o">=</span> <span class="n">Norm_EtuV_Init</span><span class="p">,</span>     <span class="n">alpha_EtuV</span> <span class="o">=</span> <span class="n">alpha_EtuV_Init</span><span class="p">,</span>      <span class="n">beta_EtuV</span> <span class="o">=</span> <span class="n">beta_EtuV_Init</span><span class="p">,</span>     <span class="n">alphap_EtuV</span> <span class="o">=</span> <span class="n">alphap_EtuV_Init</span><span class="p">,</span>
                                               <span class="n">Norm_EtdV</span> <span class="o">=</span> <span class="n">Norm_EtdV_Init</span><span class="p">,</span>     <span class="n">R_Et_Sea</span> <span class="o">=</span> <span class="n">R_Et_Sea_Init</span><span class="p">,</span>          <span class="n">R_Htu_xi2</span> <span class="o">=</span> <span class="n">R_Htu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Htd_xi2</span> <span class="o">=</span> <span class="n">R_Htd_xi2_Init</span><span class="p">,</span>     <span class="n">R_Htg_xi2</span> <span class="o">=</span> <span class="n">R_Htg_xi2_Init</span><span class="p">,</span>
                                               <span class="n">R_Etu_xi2</span> <span class="o">=</span> <span class="n">R_Etu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Etd_xi2</span> <span class="o">=</span> <span class="n">R_Etd_xi2_Init</span><span class="p">,</span>        <span class="n">R_Etg_xi2</span> <span class="o">=</span> <span class="n">R_Etg_xi2_Init</span><span class="p">,</span>
                                               <span class="n">R_Htu_xi4</span> <span class="o">=</span> <span class="n">R_Htu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Htd_xi4</span> <span class="o">=</span> <span class="n">R_Htd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Htg_xi4</span> <span class="o">=</span> <span class="n">R_Htg_xi4_Init</span><span class="p">,</span>
                                               <span class="n">R_Etu_xi4</span> <span class="o">=</span> <span class="n">R_Etu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Etd_xi4</span> <span class="o">=</span> <span class="n">R_Etd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Etg_xi4</span> <span class="o">=</span> <span class="n">R_Etg_xi4_Init</span><span class="p">,</span>     <span class="n">bexp_HtSea</span> <span class="o">=</span> <span class="n">bexp_HtSea_Init</span><span class="p">)</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">errordef</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;bexp_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;bexp_HSea&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_E_Sea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1">#fit_off_forward.fixed[&#39;R_Hu_xi2&#39;] = True</span>
    <span class="c1">#fit_off_forward.fixed[&#39;R_Hd_xi2&#39;] = True</span>
    <span class="c1">#fit_off_forward.fixed[&#39;R_Eu_xi2&#39;] = True</span>
    <span class="c1">#fit_off_forward.fixed[&#39;R_Ed_xi2&#39;] = True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Et_Sea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htd_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etd_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;bexp_HtSea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    
    
    <span class="c1">#fit_off_forward.limits[&#39;bexp_HtSea&#39;] = (0, 10)</span>
    

    <span class="c1">#fit_off_forward.limits[&#39;R_Et_Sea&#39;]   = (-50, 50)</span>
    

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Hqbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Htubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Htqbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Htdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_EtuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EtdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Htg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hu_xi4&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eu_xi4&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etu_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hd_xi4&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Ed_xi4&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Htd_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Etd_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    fit_off_forward.fixed[&#39;R_Hu_xi4&#39;] = True</span>
<span class="sd">    fit_off_forward.fixed[&#39;R_Hd_xi4&#39;] = True </span>
<span class="sd">    fit_off_forward.fixed[&#39;R_Eu_xi4&#39;] = True</span>
<span class="sd">    fit_off_forward.fixed[&#39;R_Ed_xi4&#39;] = True</span>
<span class="sd">    fit_off_forward.fixed[&#39;R_Htu_xi4&#39;] = True</span>
<span class="sd">    fit_off_forward.fixed[&#39;R_Htd_xi4&#39;] = True </span>
<span class="sd">    fit_off_forward.fixed[&#39;R_Etu_xi4&#39;] = True</span>
<span class="sd">    fit_off_forward.fixed[&#39;R_Etd_xi4&#39;] = True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">Minuit_Counter</span><span class="p">,</span> <span class="n">Time_Counter</span><span class="p">,</span> <span class="n">time_start</span>
    <span class="n">Minuit_Counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Time_Counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">migrad</span><span class="p">()</span>
    <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">hesse</span><span class="p">()</span>

    <span class="n">ndof_off_forward</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">DVCSxsec_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">DVCSxsec_HERA_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">nfit</span> 
    
    <span class="c1">#len(DVCSxsec_data.index) + </span>

    <span class="n">time_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">time_start</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMP_Output/off_forward_fit.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total running time: </span><span class="si">%.1f</span><span class="s1"> minutes. Total call of cost function: </span><span class="si">%3d</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">time_end</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">nfcn</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The chi squared/d.o.f. is: </span><span class="si">%.2f</span><span class="s1"> / </span><span class="si">%3d</span><span class="s1"> ( = </span><span class="si">%.2f</span><span class="s1"> ).</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fval</span><span class="p">,</span> <span class="n">ndof_off_forward</span><span class="p">,</span> <span class="n">fit_off_forward</span><span class="o">.</span><span class="n">fval</span><span class="o">/</span><span class="n">ndof_off_forward</span><span class="p">),</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Below are the final output parameters from iMinuit:&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_off_forward</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_off_forward</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit_off_forward</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s2">&quot;GUMP_Output/Off_forward_cov.csv&quot;</span><span class="p">),</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">my_csv</span><span class="p">:</span>
        <span class="n">csvWriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">my_csv</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">csvWriter</span><span class="o">.</span><span class="n">writerows</span><span class="p">([</span><span class="o">*</span><span class="n">fit_off_forward</span><span class="o">.</span><span class="n">covariance</span><span class="p">])</span>
          
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;off forward fit finished...&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fit_off_forward</span></div>


<div class="viewcode-block" id="cost_dvmp">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.cost_dvmp">[docs]</a>
<span class="k">def</span> <span class="nf">cost_dvmp</span><span class="p">(</span><span class="n">Norm_HuV</span><span class="p">,</span>    <span class="n">alpha_HuV</span><span class="p">,</span>    <span class="n">beta_HuV</span><span class="p">,</span>    <span class="n">alphap_HuV</span><span class="p">,</span> 
                     <span class="n">Norm_Hubar</span><span class="p">,</span>  <span class="n">alpha_Hubar</span><span class="p">,</span>  <span class="n">beta_Hubar</span><span class="p">,</span>  <span class="n">alphap_Hqbar</span><span class="p">,</span>
                     <span class="n">Norm_HdV</span><span class="p">,</span>    <span class="n">alpha_HdV</span><span class="p">,</span>    <span class="n">beta_HdV</span><span class="p">,</span>    <span class="n">alphap_HdV</span><span class="p">,</span>
                     <span class="n">Norm_Hdbar</span><span class="p">,</span>  <span class="n">alpha_Hdbar</span><span class="p">,</span>  <span class="n">beta_Hdbar</span><span class="p">,</span> 
                     <span class="n">Norm_Hg</span><span class="p">,</span>     <span class="n">alpha_Hg</span><span class="p">,</span>     <span class="n">beta_Hg</span><span class="p">,</span>     <span class="n">alphap_Hg</span><span class="p">,</span>
                     <span class="n">Norm_EuV</span><span class="p">,</span>    <span class="n">alpha_EuV</span><span class="p">,</span>    <span class="n">beta_EuV</span><span class="p">,</span>    <span class="n">alphap_EuV</span><span class="p">,</span>
                     <span class="n">Norm_EdV</span><span class="p">,</span>    <span class="n">R_E_Sea</span><span class="p">,</span>      <span class="n">R_Hu_xi2</span><span class="p">,</span>    <span class="n">R_Hd_xi2</span><span class="p">,</span>    <span class="n">R_Hg_xi2</span><span class="p">,</span>
                     <span class="n">R_Eu_xi2</span><span class="p">,</span>    <span class="n">R_Ed_xi2</span><span class="p">,</span>     <span class="n">R_Eg_xi2</span><span class="p">,</span>
                     <span class="n">R_Hu_xi4</span><span class="p">,</span>    <span class="n">R_Hd_xi4</span><span class="p">,</span>     <span class="n">R_Hg_xi4</span><span class="p">,</span>
                     <span class="n">R_Eu_xi4</span><span class="p">,</span>    <span class="n">R_Ed_xi4</span><span class="p">,</span>     <span class="n">R_Eg_xi4</span><span class="p">,</span>    <span class="n">bexp_HSea</span><span class="p">,</span> <span class="n">bexp_Hg</span><span class="p">,</span> <span class="n">Invm2_Hg</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">norm2</span><span class="p">):</span>

    <span class="k">global</span> <span class="n">Minuit_Counter</span><span class="p">,</span> <span class="n">Time_Counter</span>

    <span class="n">time_now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_start</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">time_now</span> <span class="o">&gt;</span> <span class="n">Time_Counter</span> <span class="o">*</span> <span class="mi">600</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Runing Time:&#39;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">time_now</span><span class="o">/</span><span class="mi">60</span><span class="p">),</span><span class="s1">&#39;minutes. Cost function called total&#39;</span><span class="p">,</span> <span class="n">Minuit_Counter</span><span class="p">,</span> <span class="s1">&#39;times.&#39;</span><span class="p">)</span>
        <span class="n">Time_Counter</span> <span class="o">=</span> <span class="n">Time_Counter</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="n">Minuit_Counter</span> <span class="o">=</span> <span class="n">Minuit_Counter</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">Para_Unp_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">Norm_HuV</span><span class="p">,</span>    <span class="n">alpha_HuV</span><span class="p">,</span>    <span class="n">beta_HuV</span><span class="p">,</span>    <span class="n">alphap_HuV</span><span class="p">,</span> 
                    <span class="n">Norm_Hubar</span><span class="p">,</span>  <span class="n">alpha_Hubar</span><span class="p">,</span>  <span class="n">beta_Hubar</span><span class="p">,</span>  <span class="n">alphap_Hqbar</span><span class="p">,</span>
                    <span class="n">Norm_HdV</span><span class="p">,</span>    <span class="n">alpha_HdV</span><span class="p">,</span>    <span class="n">beta_HdV</span><span class="p">,</span>    <span class="n">alphap_HdV</span><span class="p">,</span>
                    <span class="n">Norm_Hdbar</span><span class="p">,</span>  <span class="n">alpha_Hdbar</span><span class="p">,</span>  <span class="n">beta_Hdbar</span><span class="p">,</span> 
                    <span class="n">Norm_Hg</span><span class="p">,</span>     <span class="n">alpha_Hg</span><span class="p">,</span>     <span class="n">beta_Hg</span><span class="p">,</span>     <span class="n">alphap_Hg</span><span class="p">,</span>
                    <span class="n">Norm_EuV</span><span class="p">,</span>    <span class="n">alpha_EuV</span><span class="p">,</span>    <span class="n">beta_EuV</span><span class="p">,</span>    <span class="n">alphap_EuV</span><span class="p">,</span>
                    <span class="n">Norm_EdV</span><span class="p">,</span>    <span class="n">R_E_Sea</span><span class="p">,</span>      <span class="n">R_Hu_xi2</span><span class="p">,</span>    <span class="n">R_Hd_xi2</span><span class="p">,</span>    <span class="n">R_Hg_xi2</span><span class="p">,</span>
                    <span class="n">R_Eu_xi2</span><span class="p">,</span>    <span class="n">R_Ed_xi2</span><span class="p">,</span>     <span class="n">R_Eg_xi2</span><span class="p">,</span>
                    <span class="n">R_Hu_xi4</span><span class="p">,</span>    <span class="n">R_Hd_xi4</span><span class="p">,</span>     <span class="n">R_Hg_xi4</span><span class="p">,</span>
                    <span class="n">R_Eu_xi4</span><span class="p">,</span>    <span class="n">R_Ed_xi4</span><span class="p">,</span>     <span class="n">R_Eg_xi4</span><span class="p">,</span>    <span class="n">bexp_HSea</span><span class="p">,</span> <span class="n">bexp_Hg</span><span class="p">,</span> <span class="n">Invm2_Hg</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">norm2</span><span class="p">]</span>

    <span class="n">jpsinorm</span> <span class="o">=</span> <span class="n">Para_Unp_lst</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">jpsinormzeus</span> <span class="o">=</span> <span class="n">Para_Unp_lst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">Para_Unp_all</span> <span class="o">=</span> <span class="n">ParaManager_Unp</span><span class="p">(</span><span class="n">Para_Unp_lst</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    
   <span class="c1"># cost_DVrhoPZEUS_xBtQ = np.array(list(pool.map(partial(DVrhoPxsec_cost_xBtQ, Para_Unp = Para_Unp_all, xsec_norm = xsecnorm), DVrhoPZEUSxsec_group_data)))</span>
   <span class="c1"># cost_DVrhoPZEUSxsec = np.sum(cost_DVrhoPZEUS_xBtQ)</span>
    
   <span class="c1"># cost_DVrhoPH1_xBtQ = np.array(list(pool.map(partial(DVrhoPxsec_cost_xBtQ, Para_Unp = Para_Unp_all, xsec_norm = 1), DVrhoPH1xsec_group_data)))</span>
   <span class="c1"># cost_DVrhoPH1xsec = np.sum(cost_DVrhoPH1_xBtQ)</span>
   
   <span class="c1"># cost_DVrhoPH1_NLO_xBtQ = np.array(list(pool.map(partial(DVrhoPxsec_NLO_cost_xBtQ, Para_Unp = Para_Unp_all, xsec_norm = xsecnorm), DVrhoPH1xsec_group_data)))</span>
   <span class="c1"># cost_DVrhoPH1xsec_NLO = np.sum(cost_DVrhoPH1_NLO_xBtQ)</span>
    
   <span class="c1"># cost_DVphiPZEUS_xBtQ = np.array(list(pool.map(partial(DVphiPxsec_cost_xBtQ, Para_Unp = Para_Unp_all), DVphiPZEUSxsec_group_data)))</span>
   <span class="c1"># cost_DVphiPZEUSxsec = np.sum(cost_DVphiPZEUS_xBtQ)</span>
    
   <span class="c1"># cost_DVphiPH1_xBtQ = np.array(list(pool.map(partial(DVphiPxsec_cost_xBtQ, Para_Unp = Para_Unp_all), DVphiPH1xsec_group_data)))</span>
   <span class="c1"># cost_DVphiPH1xsec = np.sum(cost_DVphiPH1_xBtQ)</span>
   
    <span class="n">PDF_H_g_smallx_pred</span> <span class="o">=</span> <span class="n">PDF_theo</span><span class="p">(</span><span class="n">PDFg_smallx_data</span><span class="p">,</span> <span class="n">Para</span><span class="o">=</span><span class="n">Para_Unp_all</span><span class="p">,</span> <span class="n">p_order</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">cost_PDF_H_g_smallx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">PDF_H_g_smallx_pred</span> <span class="o">-</span> <span class="n">PDFg_smallx_data</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span><span class="o">/</span> <span class="n">PDFg_smallx_data</span><span class="p">[</span><span class="s1">&#39;delta f&#39;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>

   <span class="c1"># cost_DVjpsiPZEUS_xBtQ = np.array(list(pool.map(partial(DVjpsiPxsec_cost_xBtQ, Para_Unp = Para_Unp_all), DVJpsiPZEUSxsec_group_data)))</span>
   <span class="c1"># cost_DVjpsiPZEUSxsec = np.sum(cost_DVjpsiPZEUS_xBtQ)</span>
    
    <span class="c1">#cost_DVjpsiPZEUS_xBtQ = np.array(list(pool.map(partial(DVjpsiPxsec_cost_xBtQ, Para_Unp = Para_Unp_all, xsec_norm = jpsinormzeus, p_order = 2), DVJpsiPZEUSxsec_group_data)))</span>
    <span class="c1">#cost_DVjpsiPZEUSxsec = np.sum(cost_DVjpsiPZEUS_xBtQ)</span>
    
    <span class="n">cost_DVjpsiPH1_xBtQ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">DVjpsiPxsec_cost_xBtQ</span><span class="p">,</span> <span class="n">Para_Unp</span> <span class="o">=</span> <span class="n">Para_Unp_all</span><span class="p">,</span> <span class="n">xsec_norm</span> <span class="o">=</span> <span class="n">jpsinorm</span><span class="p">,</span> <span class="n">p_order</span> <span class="o">=</span> <span class="mi">2</span><span class="p">),</span> <span class="n">DVJpsiPH1xsec_group_data</span><span class="p">)))</span>
    <span class="n">cost_DVjpsiPH1xsec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cost_DVjpsiPH1_xBtQ</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cost_PDF_H_g_smallx</span> <span class="o">+</span> <span class="n">cost_DVjpsiPH1xsec</span> <span class="c1">#+ cost_DVjpsiPZEUSxsec</span></div>


<div class="viewcode-block" id="dvmp_fit">
<a class="viewcode-back" href="../Minimizer.html#Minimizer.dvmp_fit">[docs]</a>
<span class="k">def</span> <span class="nf">dvmp_fit</span><span class="p">(</span><span class="n">Paralst_Unp</span><span class="p">):</span>

    <span class="p">[</span><span class="n">Norm_HuV_Init</span><span class="p">,</span>    <span class="n">alpha_HuV_Init</span><span class="p">,</span>    <span class="n">beta_HuV_Init</span><span class="p">,</span>    <span class="n">alphap_HuV_Init</span><span class="p">,</span> 
     <span class="n">Norm_Hubar_Init</span><span class="p">,</span>  <span class="n">alpha_Hubar_Init</span><span class="p">,</span>  <span class="n">beta_Hubar_Init</span><span class="p">,</span>  <span class="n">alphap_Hqbar_Init</span><span class="p">,</span>
     <span class="n">Norm_HdV_Init</span><span class="p">,</span>    <span class="n">alpha_HdV_Init</span><span class="p">,</span>    <span class="n">beta_HdV_Init</span><span class="p">,</span>    <span class="n">alphap_HdV_Init</span><span class="p">,</span>
     <span class="n">Norm_Hdbar_Init</span><span class="p">,</span>  <span class="n">alpha_Hdbar_Init</span><span class="p">,</span>  <span class="n">beta_Hdbar_Init</span><span class="p">,</span> 
     <span class="n">Norm_Hg_Init</span><span class="p">,</span>     <span class="n">alpha_Hg_Init</span><span class="p">,</span>     <span class="n">beta_Hg_Init</span><span class="p">,</span>     <span class="n">alphap_Hg_Init</span><span class="p">,</span>
     <span class="n">Norm_EuV_Init</span><span class="p">,</span>    <span class="n">alpha_EuV_Init</span><span class="p">,</span>    <span class="n">beta_EuV_Init</span><span class="p">,</span>    <span class="n">alphap_EuV_Init</span><span class="p">,</span>
     <span class="n">Norm_EdV_Init</span><span class="p">,</span>    <span class="n">R_E_Sea_Init</span><span class="p">,</span>      <span class="n">R_Hu_xi2_Init</span><span class="p">,</span>    <span class="n">R_Hd_xi2_Init</span><span class="p">,</span>    <span class="n">R_Hg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Eu_xi2_Init</span><span class="p">,</span>    <span class="n">R_Ed_xi2_Init</span><span class="p">,</span>     <span class="n">R_Eg_xi2_Init</span><span class="p">,</span>
     <span class="n">R_Hu_xi4_Init</span><span class="p">,</span>    <span class="n">R_Hd_xi4_Init</span><span class="p">,</span>     <span class="n">R_Hg_xi4_Init</span><span class="p">,</span>
     <span class="n">R_Eu_xi4_Init</span><span class="p">,</span>    <span class="n">R_Ed_xi4_Init</span><span class="p">,</span>     <span class="n">R_Eg_xi4_Init</span><span class="p">,</span>    <span class="n">bexp_HSea_Init</span><span class="p">,</span> <span class="n">bexp_Hg_Init</span><span class="p">,</span> <span class="n">Invm2_Hg_Init</span><span class="p">,</span> <span class="n">norm_Init</span><span class="p">,</span> <span class="n">norm2_Init</span><span class="p">]</span> <span class="o">=</span> <span class="n">Paralst_Unp</span>

    <span class="n">Invm2_Hg_Init</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#bexp_Hg_Init = 0</span>
    <span class="n">fit_dvmp</span> <span class="o">=</span> <span class="n">Minuit</span><span class="p">(</span><span class="n">cost_dvmp</span><span class="p">,</span> <span class="n">Norm_HuV</span> <span class="o">=</span> <span class="n">Norm_HuV_Init</span><span class="p">,</span>     <span class="n">alpha_HuV</span> <span class="o">=</span> <span class="n">alpha_HuV_Init</span><span class="p">,</span>      <span class="n">beta_HuV</span> <span class="o">=</span> <span class="n">beta_HuV_Init</span><span class="p">,</span>     <span class="n">alphap_HuV</span> <span class="o">=</span> <span class="n">alphap_HuV_Init</span><span class="p">,</span> 
                                            <span class="n">Norm_Hubar</span> <span class="o">=</span> <span class="n">Norm_Hubar_Init</span><span class="p">,</span> <span class="n">alpha_Hubar</span> <span class="o">=</span> <span class="n">alpha_Hubar_Init</span><span class="p">,</span>  <span class="n">beta_Hubar</span> <span class="o">=</span> <span class="n">beta_Hubar_Init</span><span class="p">,</span> <span class="n">alphap_Hqbar</span> <span class="o">=</span> <span class="n">alphap_Hqbar_Init</span><span class="p">,</span>
                                            <span class="n">Norm_HdV</span> <span class="o">=</span> <span class="n">Norm_HdV_Init</span><span class="p">,</span>     <span class="n">alpha_HdV</span> <span class="o">=</span> <span class="n">alpha_HdV_Init</span><span class="p">,</span>      <span class="n">beta_HdV</span> <span class="o">=</span> <span class="n">beta_HdV_Init</span><span class="p">,</span>     <span class="n">alphap_HdV</span> <span class="o">=</span> <span class="n">alphap_HdV_Init</span><span class="p">,</span>
                                            <span class="n">Norm_Hdbar</span> <span class="o">=</span> <span class="n">Norm_Hdbar_Init</span><span class="p">,</span> <span class="n">alpha_Hdbar</span> <span class="o">=</span> <span class="n">alpha_Hdbar_Init</span><span class="p">,</span>  <span class="n">beta_Hdbar</span> <span class="o">=</span> <span class="n">beta_Hdbar_Init</span><span class="p">,</span> 
                                            <span class="n">Norm_Hg</span> <span class="o">=</span> <span class="n">Norm_Hg_Init</span><span class="p">,</span>       <span class="n">alpha_Hg</span> <span class="o">=</span> <span class="n">alpha_Hg_Init</span><span class="p">,</span>        <span class="n">beta_Hg</span> <span class="o">=</span> <span class="n">beta_Hg_Init</span><span class="p">,</span>       <span class="n">alphap_Hg</span> <span class="o">=</span> <span class="n">alphap_Hg_Init</span><span class="p">,</span>
                                            <span class="n">Norm_EuV</span> <span class="o">=</span> <span class="n">Norm_EuV_Init</span><span class="p">,</span>     <span class="n">alpha_EuV</span> <span class="o">=</span> <span class="n">alpha_EuV_Init</span><span class="p">,</span>      <span class="n">beta_EuV</span> <span class="o">=</span> <span class="n">beta_EuV_Init</span><span class="p">,</span>     <span class="n">alphap_EuV</span> <span class="o">=</span> <span class="n">alphap_EuV_Init</span><span class="p">,</span> 
                                            <span class="n">Norm_EdV</span> <span class="o">=</span> <span class="n">Norm_EdV_Init</span><span class="p">,</span>     <span class="n">R_E_Sea</span> <span class="o">=</span> <span class="n">R_E_Sea_Init</span><span class="p">,</span>          <span class="n">R_Hu_xi2</span> <span class="o">=</span> <span class="n">R_Hu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Hd_xi2</span> <span class="o">=</span> <span class="n">R_Hd_xi2_Init</span><span class="p">,</span>     <span class="n">R_Hg_xi2</span> <span class="o">=</span> <span class="n">R_Hg_xi2_Init</span><span class="p">,</span>
                                            <span class="n">R_Eu_xi2</span> <span class="o">=</span> <span class="n">R_Eu_xi2_Init</span><span class="p">,</span>     <span class="n">R_Ed_xi2</span> <span class="o">=</span> <span class="n">R_Ed_xi2_Init</span><span class="p">,</span>        <span class="n">R_Eg_xi2</span> <span class="o">=</span> <span class="n">R_Eg_xi2_Init</span><span class="p">,</span>
                                            <span class="n">R_Hu_xi4</span> <span class="o">=</span> <span class="n">R_Hu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Hd_xi4</span> <span class="o">=</span> <span class="n">R_Hd_xi4_Init</span><span class="p">,</span>        <span class="n">R_Hg_xi4</span> <span class="o">=</span> <span class="n">R_Hg_xi4_Init</span><span class="p">,</span>
                                            <span class="n">R_Eu_xi4</span> <span class="o">=</span> <span class="n">R_Eu_xi4_Init</span><span class="p">,</span>     <span class="n">R_Ed_xi4</span> <span class="o">=</span> <span class="n">R_Ed_xi4_Init</span><span class="p">,</span>        <span class="n">R_Eg_xi4</span> <span class="o">=</span> <span class="n">R_Eg_xi4_Init</span><span class="p">,</span>     <span class="n">bexp_HSea</span> <span class="o">=</span> <span class="n">bexp_HSea_Init</span><span class="p">,</span> <span class="n">bexp_Hg</span> <span class="o">=</span> <span class="n">bexp_Hg_Init</span><span class="p">,</span> <span class="n">Invm2_Hg</span> <span class="o">=</span> <span class="n">Invm2_Hg_Init</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">norm_Init</span><span class="p">,</span> <span class="n">norm2</span> <span class="o">=</span> <span class="n">norm2_Init</span><span class="p">)</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">errordef</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;bexp_HSea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="c1">#fit_dvmp.fixed[&#39;bexp_Hg&#39;] = True</span>
    <span class="c1">#fit_dvmp.limits[&#39;Invm2_Hg&#39;] = (0.1,10)</span>
    
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Invm2_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;bexp_Hg&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#fit_dvmp.fixed[&#39;norm&#39;] = True</span>
    
    <span class="c1">#fit_dvmp.limits[&#39;norm2&#39;] = (0.1,10)</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;norm2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="c1">#fit_dvmp.limits[&#39;Norm_Hubar&#39;]  = (0.2, 3)</span>
    <span class="c1">#fit_dvmp.limits[&#39;alpha_Hubar&#39;]  = (1.02, 1.5)</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Hubar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_Hqbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_HdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="c1">#fit_dvmp.limits[&#39;Norm_Hdbar&#39;]  = (0, 10)</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Hdbar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;Norm_Hg&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alpha_Hg&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1">#fit_dvmp.limits[&#39;beta_Hg&#39;]=(1,10)</span>

   <span class="c1"># fit_dvmp.fixed[&#39;Norm_Hg&#39;] = True</span>
   <span class="c1"># fit_dvmp.fixed[&#39;alpha_Hg&#39;] = True</span>
   <span class="c1"># fit_dvmp.fixed[&#39;beta_Hg&#39;] = True</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alpha_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;beta_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;alphap_EuV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;Norm_EdV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1">#fit_dvmp.fixed[&#39;alphap_Hg&#39;] = True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="s1">&#39;alphap_Hg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
    
    <span class="c1">#fit_dvmp.limits[&#39;R_E_Sea&#39;]=(0,10)    </span>

    <span class="c1">#fit_dvmp.limits[&#39;R_Hg_xi2&#39;] = (-20,20)</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_E_Sea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>    
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hd_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>     
   <span class="c1"># fit_dvmp.fixed[&#39;R_Hg_xi2&#39;] = True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eu_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Ed_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eg_xi2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    

    <span class="c1">#fit_dvmp.fixed[&#39;R_Hg_xi4&#39;] = True</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eg_xi4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hu_xi4&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Eu_xi4&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Hd_xi4&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fixed</span><span class="p">[</span><span class="s1">&#39;R_Ed_xi4&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">True</span>
    
    
    <span class="k">global</span> <span class="n">Minuit_Counter</span><span class="p">,</span> <span class="n">Time_Counter</span><span class="p">,</span> <span class="n">time_start</span>
    <span class="n">Minuit_Counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Time_Counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">migrad</span><span class="p">()</span>
    <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">hesse</span><span class="p">()</span>

    <span class="n">ndof_dvmp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">DVJpsiPH1xsec_data</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">PDFg_smallx_data</span><span class="p">)</span> <span class="o">-</span> <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">nfit</span> 

    <span class="n">time_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">time_start</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s1">&#39;GUMP_Output/dvmp_fit_NLOPDF.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total running time: </span><span class="si">%.1f</span><span class="s1"> minutes. Total call of cost function: </span><span class="si">%3d</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">time_end</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">nfcn</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The chi squared/d.o.f. is: </span><span class="si">%.2f</span><span class="s1"> / </span><span class="si">%3d</span><span class="s1"> ( = </span><span class="si">%.2f</span><span class="s1"> ).</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fval</span><span class="p">,</span> <span class="n">ndof_dvmp</span><span class="p">,</span> <span class="n">fit_dvmp</span><span class="o">.</span><span class="n">fval</span><span class="o">/</span><span class="n">ndof_dvmp</span><span class="p">),</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Below are the final output parameters from iMinuit:&#39;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_dvmp</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">fit_dvmp</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fit_dvmp</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s2">&quot;GUMP_Output/dvmp_cov.csv&quot;</span><span class="p">),</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">my_csv</span><span class="p">:</span>
        <span class="n">csvWriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">my_csv</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">csvWriter</span><span class="o">.</span><span class="n">writerows</span><span class="p">([</span><span class="o">*</span><span class="n">fit_dvmp</span><span class="o">.</span><span class="n">covariance</span><span class="p">])</span>
        
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s2">&quot;GUMP_Params/Para_Unp.csv&quot;</span><span class="p">),</span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">my_csv</span><span class="p">:</span>
        <span class="n">csvWriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">my_csv</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">csvWriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">list</span><span class="p">([</span><span class="o">*</span><span class="n">fit_dvmp</span><span class="o">.</span><span class="n">values</span><span class="p">]))</span>
        <span class="n">csvWriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">list</span><span class="p">([</span><span class="o">*</span><span class="n">fit_dvmp</span><span class="o">.</span><span class="n">errors</span><span class="p">]))</span>
  
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dvmp fit finished...&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fit_dvmp</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>
    <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
       
   <span class="c1"># Paralst_Unp     = [0*4.92252245341075, 0.21632833928300776, 3.228525762889928, 2.347470994624827, 0.16344460105600744, 1.135739437288775, 6.893895640954224, 0.15, 0*3.358767931921898, 0.1842893653407356, 4.417802345266761, 3.4816671934041685, 0.2491737223289409, 1.0519258916411531, 6.553873836594824, 2.8642810381756982, 1.0523058580968585, 7.412779706371915, 0.15, 0*0.1813228421702434, 0.9068471909677753, 1.1018931174030364, 0.4607676086634599, -0*0.22341404954304522, 0*0.7683213780361391, 0.22948701913308733, -2.638627981453611, 0.0, 0.7985103392773935, 3.404262017724412, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.86/2, 3.86/2, 1.0]</span>
   
    <span class="c1"># from everything through DVCS</span>
   <span class="c1"># Paralst_Unp     = [4.92252245341075, 0.21632833928300776, 3.228525762889928, 2.347470994624827, 0.16344460105600744, 1.135739437288775, 6.893895640954224, 0.15, 3.358767931921898, 0.1842893653407356, 4.417802345266761, 3.4816671934041685, 0.2491737223289409, 1.0519258916411531, 6.553873836594824, 2.8642810381756982, 1.0523058580968585, 7.412779706371915, 0.15, 0.1813228421702434, 0.9068471909677753, 1.1018931174030364, 0.4607676086634599, -0.22341404954304522, 0.7683213780361391, 0.22948701913308733, -2.638627981453611, -0.2, 0.7985103392773935, 3.404262017724412, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.44764738950069, 3.86/2, 1.0]</span>
    <span class="n">Paralst_Pol</span>     <span class="o">=</span> <span class="p">[</span><span class="mf">4.833430384423373</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26355746727810136</span><span class="p">,</span> <span class="mf">3.1855567245326317</span><span class="p">,</span> <span class="mf">2.1817250267982997</span><span class="p">,</span> <span class="mf">0.06994083000560514</span><span class="p">,</span> <span class="mf">0.5376473088622284</span><span class="p">,</span> <span class="mf">4.22898219488582</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.663583721889865</span><span class="p">,</span> <span class="mf">0.24767388786943867</span><span class="p">,</span> <span class="mf">3.5722668493718626</span><span class="p">,</span> <span class="mf">0.5420415127277624</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08640413690298866</span><span class="p">,</span> <span class="mf">0.4946733452347538</span><span class="p">,</span> <span class="mf">2.553713733867575</span><span class="p">,</span> <span class="mf">0.24307061469378405</span><span class="p">,</span> <span class="mf">0.6309890923077655</span><span class="p">,</span> <span class="mf">2.716624295877619</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">7.99299605623125</span><span class="p">,</span> <span class="mf">0.799997370438831</span><span class="p">,</span> <span class="mf">6.415448025778247</span><span class="p">,</span> <span class="mf">2.0758963463111515</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.407059919688728</span><span class="p">,</span> <span class="mf">37.65971219196447</span><span class="p">,</span> <span class="mf">0.24589373380232807</span><span class="p">,</span> <span class="mf">1.6561364171210822</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.6840962695831894</span><span class="p">,</span> <span class="mf">37.58453653636456</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">9.852441955678458</span><span class="p">]</span>
    
     <span class="c1">#from J/psi and gluon PDF using everything through DVCS as input except gluon PDF</span>
    <span class="n">Paralst_Unp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.92252245341075</span><span class="p">,</span> <span class="mf">0.21632833928300776</span><span class="p">,</span> <span class="mf">3.228525762889928</span><span class="p">,</span> <span class="mf">2.347470994624827</span><span class="p">,</span> <span class="mf">0.16344460105600744</span><span class="p">,</span> <span class="mf">1.135739437288775</span><span class="p">,</span> <span class="mf">6.893895640954224</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">3.358767931921898</span><span class="p">,</span> <span class="mf">0.1842893653407356</span><span class="p">,</span> <span class="mf">4.417802345266761</span><span class="p">,</span> <span class="mf">3.4816671934041685</span><span class="p">,</span> <span class="mf">0.2491737223289409</span><span class="p">,</span> <span class="mf">1.0519258916411531</span><span class="p">,</span> <span class="mf">6.553873836594824</span><span class="p">,</span> <span class="mf">1.8318696701278339</span><span class="p">,</span> <span class="mf">1.0965234601821583</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.1813228421702434</span><span class="p">,</span> <span class="mf">0.9068471909677753</span><span class="p">,</span> <span class="mf">1.1018931174030364</span><span class="p">,</span> <span class="mf">0.4607676086634599</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22341404954304522</span><span class="p">,</span> <span class="mf">0.7683213780361391</span><span class="p">,</span> <span class="mf">0.22948701913308733</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.638627981453611</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13980648369003512</span><span class="p">,</span> <span class="mf">0.7985103392773935</span><span class="p">,</span> <span class="mf">3.404262017724412</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.44764738950069</span><span class="p">,</span> <span class="mf">1.7955307337138424</span><span class="p">,</span><span class="mi">1</span> <span class="p">,</span> <span class="mf">1.0849192935931364</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>

    <span class="n">fit_dvmp</span> <span class="o">=</span> <span class="n">dvmp_fit</span><span class="p">(</span><span class="n">Paralst_Unp</span><span class="p">)</span>
    
   <span class="c1"># fit_off_forward = off_forward_fit(Paralst_Unp, Paralst_Pol)</span>
   
    <span class="c1">#print(cost_dvmp(4.922551238,0.21635596,3.228702555,2.349193947,0.163440601,1.135738688,6.896742038,0.15,3.358541913,0.184196049,4.41726899,3.475742056,0.249183402,1.051922382,6.548676693,2.864281106,1.052305853,7.412779844,0.15,0.161159704,0.916012032,1.02239598,0.41423421,-0.198595321,0.0,0.18394307,-2.260952723,0,1.159322377,2.569800357,0,0,0,0,0,0,0,3.296968216))</span>

    <span class="c1"># 0*4.922551238,0.21635596,3.228702555,2.349193947,0.414,1.022,7.737,0.15,0*3.358541913,0.184196049,4.41726899,3.475742056,0.414,1.022,7.737,2.690, 0.469, 3.148, 0.15</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    Paralst_Unp     = [4.922551238,0.21635596,3.228702555,2.349193947,0.163440601,1.135738688,6.896742038,0.15,3.358541913,0.184196049,4.41726899,3.475742056,0.249183402,1.051922382,6.548676693,2.864281106,1.052305853,7.412779844,0.15,0.161159704,0.916012032,1.02239598,0.41423421,-0.198595321,0.0,0.18394307,-2.260952723,0,1.159322377,2.569800357,0,0,0,0,0,0,0,3.296968216]</span>
<span class="sd">    Paralst_Pol     = [4.529773253,-0.246812532,3.037043159,2.607360484,0.076575866,0.516192897,4.369657188,0.15,-0.711694724,0.210181857,3.243538578,4.319727451,-0.057100694,0.612255908,2.099180441,0.243247279,0.630824175,2.71840147,0.15,9.065736349,0.79999977,7.357005187,2.083472023,-3.562901039,0.0,-0.634095327,-7.058667382,0,2.861662204,23.1231347,0,0,0,0,0,0,0,5.379752095]</span>

<span class="sd">    fit_forward_H   = forward_H_fit(Paralst_Unp)</span>
<span class="sd">    Paralst_Unp     = np.array(fit_forward_H.values)</span>

<span class="sd">    fit_forward_Ht  = forward_Ht_fit(Paralst_Pol)</span>
<span class="sd">    Paralst_Pol     = np.array(fit_forward_Ht.values)</span>

<span class="sd">    fit_forward_E   = forward_E_fit(Paralst_Unp)</span>
<span class="sd">    Paralst_Unp     = np.array(fit_forward_E.values)</span>

<span class="sd">    fit_forward_Et  = forward_Et_fit(Paralst_Pol)</span>
<span class="sd">    Paralst_Pol     = np.array(fit_forward_Et.values)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

   <span class="c1"># fit_off_forward = off_forward_fit(Paralst_Unp, Paralst_Pol)</span>

    
    <span class="c1">#print(cost_off_forward_test(4.92252245341075, 0.21632833928300776, 3.228525762889928, 2.347470994624827, 0.16344460105600744, 1.135739437288775, 6.893895640954224, 0.15, 3.358767931921898, 0.1842893653407356, 4.417802345266761, 3.4816671934041685, 0.2491737223289409, 1.0519258916411531, 6.553873836594824, 2.8642810381756982, 1.0523058580968585, 7.412779706371915, 0.15, 0.1813228421702434, 0.9068471909677753, 1.1018931174030364, 0.4607676086634599, -0.22341404954304522, 0.7683213780361391, 0.22948701913308733, -2.638627981453611, 0.0, 0.7985103392773935, 3.404262017724412, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.44764738950069, 4.833430384423373, -0.26355746727810136, 3.1855567245326317, 2.1817250267982997, 0.06994083000560514, 0.5376473088622284, 4.22898219488582, 0.15, -0.663583721889865, 0.24767388786943867, 3.5722668493718626, 0.5420415127277624, -0.08640413690298866, 0.4946733452347538, 2.553713733867575, 0.24307061469378405, 0.6309890923077655, 2.716624295877619, 0.15, 7.99299605623125, 0.799997370438831, 6.415448025778247, 2.0758963463111515, -2.407059919688728, 37.65971219196447, 0.24589373380232807, 1.6561364171210822, 0.0, 2.6840962695831894, 37.58453653636456, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.852441955678458))</span>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Yuxun Guo. et. al..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>